(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.AchingbrainLibp2pGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
var AchingbrainLibp2pGossipsub=(()=>{var ku=Object.defineProperty;var nb=t=>ku(t,"__esModule",{value:!0});var Nu=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var re=(t,e)=>()=>(t&&(e=t(t=0)),e);var m=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ke=(t,e)=>{nb(t);for(var r in e)ku(t,r,{get:e[r],enumerable:!0})};var Mu=m((AA,Lu)=>{var Ai=1e3,Bi=Ai*60,Ri=Bi*60,ti=Ri*24,sb=ti*7,ob=ti*365.25;Lu.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return ab(t);if(r==="number"&&isFinite(t))return e.long?ub(t):cb(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function ab(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*ob;case"weeks":case"week":case"w":return r*sb;case"days":case"day":case"d":return r*ti;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ri;case"minutes":case"minute":case"mins":case"min":case"m":return r*Bi;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ai;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function cb(t){var e=Math.abs(t);return e>=ti?Math.round(t/ti)+"d":e>=Ri?Math.round(t/Ri)+"h":e>=Bi?Math.round(t/Bi)+"m":e>=Ai?Math.round(t/Ai)+"s":t+"ms"}function ub(t){var e=Math.abs(t);return e>=ti?vs(t,e,ti,"day"):e>=Ri?vs(t,e,Ri,"hour"):e>=Bi?vs(t,e,Bi,"minute"):e>=Ai?vs(t,e,Ai,"second"):t+" ms"}function vs(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var Fu=m((BA,Ku)=>{function fb(t){r.debug=r,r.default=r,r.coerce=f,r.disable=s,r.enable=n,r.enabled=o,r.humanize=Mu(),r.destroy=u,Object.keys(t).forEach(a=>{r[a]=t[a]}),r.names=[],r.skips=[],r.formatters={};function e(a){let h=0;for(let l=0;l<a.length;l++)h=(h<<5)-h+a.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(a){let h,l=null,d,p;function y(...v){if(!y.enabled)return;let b=y,x=Number(new Date),I=x-(h||x);b.diff=I,b.prev=h,b.curr=x,h=x,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let D=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(T,U)=>{if(T==="%%")return"%";D++;let H=r.formatters[U];if(typeof H=="function"){let Ae=v[D];T=H.call(b,Ae),v.splice(D,1),D--}return T}),r.formatArgs.call(b,v),(b.log||r.log).apply(b,v)}return y.namespace=a,y.useColors=r.useColors(),y.color=r.selectColor(a),y.extend=i,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(a)),p),set:v=>{l=v}}),typeof r.init=="function"&&r.init(y),y}function i(a,h){let l=r(this.namespace+(typeof h=="undefined"?":":h)+a);return l.log=this.log,l}function n(a){r.save(a),r.namespaces=a,r.names=[],r.skips=[];let h,l=(typeof a=="string"?a:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)!l[h]||(a=l[h].replace(/\*/g,".*?"),a[0]==="-"?r.skips.push(new RegExp("^"+a.substr(1)+"$")):r.names.push(new RegExp("^"+a+"$")))}function s(){let a=[...r.names.map(c),...r.skips.map(c).map(h=>"-"+h)].join(",");return r.enable(""),a}function o(a){if(a[a.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(a))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(a))return!0;return!1}function c(a){return a.toString().substring(2,a.toString().length-2).replace(/\.\*\?$/,"*")}function f(a){return a instanceof Error?a.stack||a.message:a}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Ku.exports=fb});var mn=m((ft,ms)=>{ft.formatArgs=lb;ft.save=pb;ft.load=db;ft.useColors=hb;ft.storage=yb();ft.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ft.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function hb(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function lb(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+ms.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}ft.log=console.debug||console.log||(()=>{});function pb(t){try{t?ft.storage.setItem("debug",t):ft.storage.removeItem("debug")}catch(e){}}function db(){let t;try{t=ft.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function yb(){try{return localStorage}catch(t){}}ms.exports=Fu()(ft);var{formatters:gb}=ms.exports;gb.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var ia=m((RA,ra)=>{"use strict";var Ci=typeof Reflect=="object"?Reflect:null,Uu=Ci&&typeof Ci.apply=="function"?Ci.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},ws;Ci&&typeof Ci.ownKeys=="function"?ws=Ci.ownKeys:Object.getOwnPropertySymbols?ws=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ws=function(e){return Object.getOwnPropertyNames(e)};function bb(t){console&&console.warn&&console.warn(t)}var qu=Number.isNaN||function(e){return e!==e};function ie(){ie.init.call(this)}ra.exports=ie;ra.exports.once=xb;ie.EventEmitter=ie;ie.prototype._events=void 0;ie.prototype._eventsCount=0;ie.prototype._maxListeners=void 0;var Gu=10;function xs(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ie,"defaultMaxListeners",{enumerable:!0,get:function(){return Gu},set:function(t){if(typeof t!="number"||t<0||qu(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Gu=t}});ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ie.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||qu(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Vu(t){return t._maxListeners===void 0?ie.defaultMaxListeners:t._maxListeners}ie.prototype.getMaxListeners=function(){return Vu(this)};ie.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Uu(f,this,r);else for(var u=f.length,a=$u(f,u),i=0;i<u;++i)Uu(a[i],this,r);return!0};function ju(t,e,r,i){var n,s,o;if(xs(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=Vu(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,bb(c)}return t}ie.prototype.addListener=function(e,r){return ju(this,e,r,!1)};ie.prototype.on=ie.prototype.addListener;ie.prototype.prependListener=function(e,r){return ju(this,e,r,!0)};function vb(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Hu(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=vb.bind(i);return n.listener=r,i.wrapFn=n,n}ie.prototype.once=function(e,r){return xs(r),this.on(e,Hu(this,e,r)),this};ie.prototype.prependOnceListener=function(e,r){return xs(r),this.prependListener(e,Hu(this,e,r)),this};ie.prototype.removeListener=function(e,r){var i,n,s,o,c;if(xs(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){c=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():mb(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this};ie.prototype.off=ie.prototype.removeListener;ie.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function zu(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?wb(n):$u(n,n.length)}ie.prototype.listeners=function(e){return zu(this,e,!0)};ie.prototype.rawListeners=function(e){return zu(this,e,!1)};ie.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Wu.call(t,e)};ie.prototype.listenerCount=Wu;function Wu(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ie.prototype.eventNames=function(){return this._eventsCount>0?ws(this._events):[]};function $u(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function mb(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function wb(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function xb(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Yu(t,e,s,{once:!0}),e!=="error"&&Eb(t,n,{once:!0})})}function Eb(t,e,r){typeof t.on=="function"&&Yu(t,"error",e,r)}function Yu(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var le=m((CA,Xu)=>{"use strict";function Qu(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function _b(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Qu(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),Qu(new n,r)}}Xu.exports=_b});var sa=m((TA,Ti)=>{var Ju=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},na=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),Es=t=>t&&typeof t.sink=="function"&&na(t.source),Sb=t=>e=>(t.sink(e),t.source),Zu=(...t)=>{if(Es(t[0])){let e=t[0];t[0]=()=>e.source}else if(na(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&Es(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)Es(t[e])&&(t[e]=Sb(t[e]));return Ju(...t)};Ti.exports=Zu;Ti.exports.pipe=Zu;Ti.exports.rawPipe=Ju;Ti.exports.isIterable=na;Ti.exports.isDuplex=Es});var tf=m((PA,oa)=>{"use strict";var Ib=Object.prototype.hasOwnProperty,Qe="~";function wn(){}Object.create&&(wn.prototype=Object.create(null),new wn().__proto__||(Qe=!1));function Ab(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function ef(t,e,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new Ab(r,i||t,n),o=Qe?Qe+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function _s(t,e){--t._eventsCount==0?t._events=new wn:delete t._events[e]}function Fe(){this._events=new wn,this._eventsCount=0}Fe.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)Ib.call(r,i)&&e.push(Qe?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Fe.prototype.listeners=function(e){var r=Qe?Qe+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};Fe.prototype.listenerCount=function(e){var r=Qe?Qe+e:e,i=this._events[r];return i?i.fn?1:i.length:0};Fe.prototype.emit=function(e,r,i,n,s,o){var c=Qe?Qe+e:e;if(!this._events[c])return!1;var f=this._events[c],u=arguments.length,a,h;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),u){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,r),!0;case 3:return f.fn.call(f.context,r,i),!0;case 4:return f.fn.call(f.context,r,i,n),!0;case 5:return f.fn.call(f.context,r,i,n,s),!0;case 6:return f.fn.call(f.context,r,i,n,s,o),!0}for(h=1,a=new Array(u-1);h<u;h++)a[h-1]=arguments[h];f.fn.apply(f.context,a)}else{var l=f.length,d;for(h=0;h<l;h++)switch(f[h].once&&this.removeListener(e,f[h].fn,void 0,!0),u){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,r);break;case 3:f[h].fn.call(f[h].context,r,i);break;case 4:f[h].fn.call(f[h].context,r,i,n);break;default:if(!a)for(d=1,a=new Array(u-1);d<u;d++)a[d-1]=arguments[d];f[h].fn.apply(f[h].context,a)}}return!0};Fe.prototype.on=function(e,r,i){return ef(this,e,r,i,!1)};Fe.prototype.once=function(e,r,i){return ef(this,e,r,i,!0)};Fe.prototype.removeListener=function(e,r,i,n){var s=Qe?Qe+e:e;if(!this._events[s])return this;if(!r)return _s(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!n||o.once)&&(!i||o.context===i)&&_s(this,s);else{for(var c=0,f=[],u=o.length;c<u;c++)(o[c].fn!==r||n&&!o[c].once||i&&o[c].context!==i)&&f.push(o[c]);f.length?this._events[s]=f.length===1?f[0]:f:_s(this,s)}return this};Fe.prototype.removeAllListeners=function(e){var r;return e?(r=Qe?Qe+e:e,this._events[r]&&_s(this,r)):(this._events=new wn,this._eventsCount=0),this};Fe.prototype.off=Fe.prototype.removeListener;Fe.prototype.addListener=Fe.prototype.on;Fe.prefixed=Qe;Fe.EventEmitter=Fe;typeof oa!="undefined"&&(oa.exports=Fe)});var nf=m((DA,rf)=>{"use strict";rf.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(i=>{i(e())}).then(()=>r),r=>new Promise(i=>{i(e())}).then(()=>{throw r})))});var of=m((OA,Ss)=>{"use strict";var Bb=nf(),aa=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},sf=(t,e,r)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{i(r())}catch(f){n(f)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,c=r instanceof Error?r:new aa(o);typeof t.cancel=="function"&&t.cancel(),n(c)},e);Bb(t.then(i,n),()=>{clearTimeout(s)})});Ss.exports=sf;Ss.exports.default=sf;Ss.exports.TimeoutError=aa});var af=m(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});function Rb(t,e,r){let i=0,n=t.length;for(;n>0;){let s=n/2|0,o=i+s;r(t[o],e)<=0?(i=++o,n-=s+1):n=s}return i}ca.default=Rb});var uf=m(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});var Cb=af(),cf=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let i={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(i);return}let n=Cb.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};ua.default=cf});var lf=m(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});var Tb=tf(),ff=of(),Pb=uf(),Is=()=>{},Db=new ff.TimeoutError,hf=class extends Tb{constructor(e){var r,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Is,this._resolveIdle=Is,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Pb.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Is,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Is,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():ff.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&n(Db)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async i=>this.add(i,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};fa.default=hf});var bf=m((MA,gf)=>{"use strict";var pf=()=>{},df=Symbol.for("@libp2p/js-interfaces/topology"),yf=class{constructor({min:e=0,max:r=1/0,handlers:i={}}){this.min=e,this.max=r,this._onConnect=i.onConnect||pf,this._onDisconnect=i.onDisconnect||pf,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[df](){return!0}static isTopology(e){return Boolean(e&&e[df])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};gf.exports=yf});var _f=m((KA,Ef)=>{"use strict";var Ob=bf(),vf=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),mf=mn(),wf=Object.assign(mf("libp2p:topology:multicodec-topology"),{error:mf("libp2p:topology:multicodec-topology:error")}),xf=class extends Ob{constructor({min:e,max:r,multicodecs:i,handlers:n}){super({min:e,max:r,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[vf](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[vf])}async setRegistrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),await this._updatePeers(this._registrar.peerStore.getPeers())}async _updatePeers(e){for await(let{id:r,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(r.toB58String());let n=this._registrar.getConnection(r);n&&this._onConnect(r,n)}else this.peers.delete(r.toB58String())}async _onProtocolChange({peerId:e,protocols:r}){try{let i=this.peers.has(e.toB58String()),n=r.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let o=await this._registrar.peerStore.get(e);await this._updatePeers([o]);return}}catch(i){wf.error(i)}}async _onPeerConnect(e){try{let r=e.remotePeer,i=await this._registrar.peerStore.protoBook.get(r);if(!i)return;this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}catch(r){wf.error(r)}}};Ef.exports=xf});var As=m(Sf=>{"use strict";Sf.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var Af=m((UA,If)=>{"use strict";If.exports=kb;function kb(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(c,f){r[i]=function(a){if(s)if(s=!1,a)f(a);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];c.apply(null,h)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,f(u))}})}});var Tf=m(Cf=>{"use strict";var Bs=Cf;Bs.length=function(e){var r=e.length;if(!r)return 0;for(var i=0;--r%4>1&&e.charAt(r)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Pi=new Array(64),Bf=new Array(123);for(It=0;It<64;)Bf[Pi[It]=It<26?It+65:It<52?It+71:It<62?It-4:It-59|43]=It++;var It;Bs.encode=function(e,r,i){for(var n=null,s=[],o=0,c=0,f;r<i;){var u=e[r++];switch(c){case 0:s[o++]=Pi[u>>2],f=(u&3)<<4,c=1;break;case 1:s[o++]=Pi[f|u>>4],f=(u&15)<<2,c=2;break;case 2:s[o++]=Pi[f|u>>6],s[o++]=Pi[u&63],c=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return c&&(s[o++]=Pi[f],s[o++]=61,c===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Rf="invalid encoding";Bs.decode=function(e,r,i){for(var n=i,s=0,o,c=0;c<e.length;){var f=e.charCodeAt(c++);if(f===61&&s>1)break;if((f=Bf[f])===void 0)throw Error(Rf);switch(s){case 0:o=f,s=1;break;case 1:r[i++]=o<<2|(f&48)>>4,o=f,s=2;break;case 2:r[i++]=(o&15)<<4|(f&60)>>2,o=f,s=3;break;case 3:r[i++]=(o&3)<<6|f,s=0;break}}if(s===1)throw Error(Rf);return i-n};Bs.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Df=m((GA,Pf)=>{"use strict";Pf.exports=Rs;function Rs(){this._listeners={}}Rs.prototype.on=function(e,r,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:i||this}),this};Rs.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===r?i.splice(n,1):++n;return this};Rs.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}});var Ff=m((VA,Kf)=>{"use strict";Kf.exports=Of(Of);function Of(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),i=r[3]===128;function n(f,u,a){e[0]=f,u[a]=r[0],u[a+1]=r[1],u[a+2]=r[2],u[a+3]=r[3]}function s(f,u,a){e[0]=f,u[a]=r[3],u[a+1]=r[2],u[a+2]=r[1],u[a+3]=r[0]}t.writeFloatLE=i?n:s,t.writeFloatBE=i?s:n;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],e[0]}function c(f,u){return r[3]=f[u],r[2]=f[u+1],r[1]=f[u+2],r[0]=f[u+3],e[0]}t.readFloatLE=i?o:c,t.readFloatBE=i?c:o}():function(){function e(i,n,s,o){var c=n<0?1:0;if(c&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((c<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((c<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var f=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-f)*8388608)&8388607;i((c<<31|f+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,kf),t.writeFloatBE=e.bind(null,Nf);function r(i,n,s){var o=i(n,s),c=(o>>31)*2+1,f=o>>>23&255,u=o&8388607;return f===255?u?NaN:c*(1/0):f===0?c*1401298464324817e-60*u:c*Math.pow(2,f-150)*(u+8388608)}t.readFloatLE=r.bind(null,Lf),t.readFloatBE=r.bind(null,Mf)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),i=r[7]===128;function n(f,u,a){e[0]=f,u[a]=r[0],u[a+1]=r[1],u[a+2]=r[2],u[a+3]=r[3],u[a+4]=r[4],u[a+5]=r[5],u[a+6]=r[6],u[a+7]=r[7]}function s(f,u,a){e[0]=f,u[a]=r[7],u[a+1]=r[6],u[a+2]=r[5],u[a+3]=r[4],u[a+4]=r[3],u[a+5]=r[2],u[a+6]=r[1],u[a+7]=r[0]}t.writeDoubleLE=i?n:s,t.writeDoubleBE=i?s:n;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],r[4]=f[u+4],r[5]=f[u+5],r[6]=f[u+6],r[7]=f[u+7],e[0]}function c(f,u){return r[7]=f[u],r[6]=f[u+1],r[5]=f[u+2],r[4]=f[u+3],r[3]=f[u+4],r[2]=f[u+5],r[1]=f[u+6],r[0]=f[u+7],e[0]}t.readDoubleLE=i?o:c,t.readDoubleBE=i?c:o}():function(){function e(i,n,s,o,c,f){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,c,f+n),i(1/o>0?0:2147483648,c,f+s);else if(isNaN(o))i(0,c,f+n),i(2146959360,c,f+s);else if(o>17976931348623157e292)i(0,c,f+n),i((u<<31|2146435072)>>>0,c,f+s);else{var a;if(o<22250738585072014e-324)a=o/5e-324,i(a>>>0,c,f+n),i((u<<31|a/4294967296)>>>0,c,f+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),a=o*Math.pow(2,-h),i(a*4503599627370496>>>0,c,f+n),i((u<<31|h+1023<<20|a*1048576&1048575)>>>0,c,f+s)}}}t.writeDoubleLE=e.bind(null,kf,0,4),t.writeDoubleBE=e.bind(null,Nf,4,0);function r(i,n,s,o,c){var f=i(o,c+n),u=i(o,c+s),a=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+f;return h===2047?l?NaN:a*(1/0):h===0?a*5e-324*l:a*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,Lf,0,4),t.readDoubleBE=r.bind(null,Mf,4,0)}(),t}function kf(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Nf(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Lf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Mf(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Uf=m((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Gf=m(qf=>{"use strict";var ha=qf;ha.length=function(e){for(var r=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?r+=1:i<2048?r+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,r+=4):r+=3;return r};ha.read=function(e,r,i){var n=i-r;if(n<1)return"";for(var s=null,o=[],c=0,f;r<i;)f=e[r++],f<128?o[c++]=f:f>191&&f<224?o[c++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[c++]=55296+(f>>10),o[c++]=56320+(f&1023)):o[c++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,c>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),c=0);return s?(c&&s.push(String.fromCharCode.apply(String,o.slice(0,c))),s.join("")):String.fromCharCode.apply(String,o.slice(0,c))};ha.write=function(e,r,i){for(var n=i,s,o,c=0;c<e.length;++c)s=e.charCodeAt(c),s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(c+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++c,r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128);return i-n}});var jf=m((HA,Vf)=>{"use strict";Vf.exports=Nb;function Nb(t,e,r){var i=r||8192,n=i>>>1,s=null,o=i;return function(f){if(f<1||f>n)return t(f);o+f>i&&(s=t(i),o=0);var u=e.call(s,o,o+=f);return o&7&&(o=(o|7)+1),u}}});var zf=m((zA,Hf)=>{"use strict";Hf.exports=Te;var xn=Sr();function Te(t,e){this.lo=t>>>0,this.hi=e>>>0}var ri=Te.zero=new Te(0,0);ri.toNumber=function(){return 0};ri.zzEncode=ri.zzDecode=function(){return this};ri.length=function(){return 1};var Lb=Te.zeroHash="\0\0\0\0\0\0\0\0";Te.fromNumber=function(e){if(e===0)return ri;var r=e<0;r&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return r&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Te(i,n)};Te.from=function(e){if(typeof e=="number")return Te.fromNumber(e);if(xn.isString(e))if(xn.Long)e=xn.Long.fromString(e);else return Te.fromNumber(parseInt(e,10));return e.low||e.high?new Te(e.low>>>0,e.high>>>0):ri};Te.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;return r||(i=i+1>>>0),-(r+i*4294967296)}return this.lo+this.hi*4294967296};Te.prototype.toLong=function(e){return xn.Long?new xn.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var _r=String.prototype.charCodeAt;Te.fromHash=function(e){return e===Lb?ri:new Te((_r.call(e,0)|_r.call(e,1)<<8|_r.call(e,2)<<16|_r.call(e,3)<<24)>>>0,(_r.call(e,4)|_r.call(e,5)<<8|_r.call(e,6)<<16|_r.call(e,7)<<24)>>>0)};Te.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Te.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Te.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Te.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}});var Sr=m(la=>{"use strict";var L=la;L.asPromise=Af();L.base64=Tf();L.EventEmitter=Df();L.float=Ff();L.inquire=Uf();L.utf8=Gf();L.pool=jf();L.LongBits=zf();L.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);L.global=L.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||la;L.emptyArray=Object.freeze?Object.freeze([]):[];L.emptyObject=Object.freeze?Object.freeze({}):{};L.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};L.isString=function(e){return typeof e=="string"||e instanceof String};L.isObject=function(e){return e&&typeof e=="object"};L.isset=L.isSet=function(e,r){var i=e[r];return i!=null&&e.hasOwnProperty(r)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};L.Buffer=function(){try{var t=L.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();L._Buffer_from=null;L._Buffer_allocUnsafe=null;L.newBuffer=function(e){return typeof e=="number"?L.Buffer?L._Buffer_allocUnsafe(e):new L.Array(e):L.Buffer?L._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};L.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;L.Long=L.global.dcodeIO&&L.global.dcodeIO.Long||L.global.Long||L.inquire("long");L.key2Re=/^true|false|0|1$/;L.key32Re=/^-?(?:0|[1-9][0-9]*)$/;L.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;L.longToHash=function(e){return e?L.LongBits.from(e).toHash():L.LongBits.zeroHash};L.longFromHash=function(e,r){var i=L.LongBits.fromHash(e);return L.Long?L.Long.fromBits(i.lo,i.hi,r):i.toNumber(Boolean(r))};function Wf(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)(t[i[n]]===void 0||!r)&&(t[i[n]]=e[i[n]]);return t}L.merge=Wf;L.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function $f(t){function e(r,i){if(!(this instanceof e))return new e(r,i);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&Wf(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}L.newError=$f;L.ProtocolError=$f("ProtocolError");L.oneOfGetter=function(e){for(var r={},i=0;i<e.length;++i)r[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(r[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};L.oneOfSetter=function(e){return function(r){for(var i=0;i<e.length;++i)e[i]!==r&&delete this[e[i]]}};L.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};L._configure=function(){var t=L.Buffer;if(!t){L._Buffer_from=L._Buffer_allocUnsafe=null;return}L._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,i){return new t(r,i)},L._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var ma=m(($A,Jf)=>{"use strict";Jf.exports=Y;var lt=Sr(),pa,Cs=lt.LongBits,Yf=lt.base64,Qf=lt.utf8;function En(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function da(){}function Mb(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Y(){this.len=0,this.head=new En(da,0,0),this.tail=this.head,this.states=null}var Xf=function(){return lt.Buffer?function(){return(Y.create=function(){return new pa})()}:function(){return new Y}};Y.create=Xf();Y.alloc=function(e){return new lt.Array(e)};lt.Array!==Array&&(Y.alloc=lt.pool(Y.alloc,lt.Array.prototype.subarray));Y.prototype._push=function(e,r,i){return this.tail=this.tail.next=new En(e,r,i),this.len+=r,this};function ya(t,e,r){e[r]=t&255}function Kb(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function ga(t,e){this.len=t,this.next=void 0,this.val=e}ga.prototype=Object.create(En.prototype);ga.prototype.fn=Kb;Y.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ga((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Y.prototype.int32=function(e){return e<0?this._push(ba,10,Cs.fromNumber(e)):this.uint32(e)};Y.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function ba(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Y.prototype.uint64=function(e){var r=Cs.from(e);return this._push(ba,r.length(),r)};Y.prototype.int64=Y.prototype.uint64;Y.prototype.sint64=function(e){var r=Cs.from(e).zzEncode();return this._push(ba,r.length(),r)};Y.prototype.bool=function(e){return this._push(ya,1,e?1:0)};function va(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Y.prototype.fixed32=function(e){return this._push(va,4,e>>>0)};Y.prototype.sfixed32=Y.prototype.fixed32;Y.prototype.fixed64=function(e){var r=Cs.from(e);return this._push(va,4,r.lo)._push(va,4,r.hi)};Y.prototype.sfixed64=Y.prototype.fixed64;Y.prototype.float=function(e){return this._push(lt.float.writeFloatLE,4,e)};Y.prototype.double=function(e){return this._push(lt.float.writeDoubleLE,8,e)};var Fb=lt.Array.prototype.set?function(e,r,i){r.set(e,i)}:function(e,r,i){for(var n=0;n<e.length;++n)r[i+n]=e[n]};Y.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(ya,1,0);if(lt.isString(e)){var i=Y.alloc(r=Yf.length(e));Yf.decode(e,i,0),e=i}return this.uint32(r)._push(Fb,r,e)};Y.prototype.string=function(e){var r=Qf.length(e);return r?this.uint32(r)._push(Qf.write,r,e):this._push(ya,1,0)};Y.prototype.fork=function(){return this.states=new Mb(this),this.head=this.tail=new En(da,0,0),this.len=0,this};Y.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new En(da,0,0),this.len=0),this};Y.prototype.ldelim=function(){var e=this.head,r=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=r,this.len+=i),this};Y.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,r,i),i+=e.len,e=e.next;return r};Y._configure=function(t){pa=t,Y.create=Xf(),pa._configure()}});var t0=m((YA,e0)=>{"use strict";e0.exports=Mt;var Zf=ma();(Mt.prototype=Object.create(Zf.prototype)).constructor=Mt;var Ir=Sr();function Mt(){Zf.call(this)}Mt._configure=function(){Mt.alloc=Ir._Buffer_allocUnsafe,Mt.writeBytesBuffer=Ir.Buffer&&Ir.Buffer.prototype instanceof Uint8Array&&Ir.Buffer.prototype.set.name==="set"?function(e,r,i){r.set(e,i)}:function(e,r,i){if(e.copy)e.copy(r,i,0,e.length);else for(var n=0;n<e.length;)r[i++]=e[n++]}};Mt.prototype.bytes=function(e){Ir.isString(e)&&(e=Ir._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Mt.writeBytesBuffer,r,e),this};function Ub(t,e,r){t.length<40?Ir.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Mt.prototype.string=function(e){var r=Ir.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Ub,r,e),this};Mt._configure()});var Ea=m((QA,o0)=>{"use strict";o0.exports=we;var Kt=Sr(),wa,r0=Kt.LongBits,qb=Kt.utf8;function At(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function we(t){this.buf=t,this.pos=0,this.len=t.length}var i0=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new we(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new we(e);throw Error("illegal buffer")},n0=function(){return Kt.Buffer?function(r){return(we.create=function(n){return Kt.Buffer.isBuffer(n)?new wa(n):i0(n)})(r)}:i0};we.create=n0();we.prototype._slice=Kt.Array.prototype.subarray||Kt.Array.prototype.slice;we.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,At(this,10);return e}}();we.prototype.int32=function(){return this.uint32()|0};we.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function xa(){var t=new r0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw At(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw At(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}we.prototype.bool=function(){return this.uint32()!==0};function Ts(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}we.prototype.fixed32=function(){if(this.pos+4>this.len)throw At(this,4);return Ts(this.buf,this.pos+=4)};we.prototype.sfixed32=function(){if(this.pos+4>this.len)throw At(this,4);return Ts(this.buf,this.pos+=4)|0};function s0(){if(this.pos+8>this.len)throw At(this,8);return new r0(Ts(this.buf,this.pos+=4),Ts(this.buf,this.pos+=4))}we.prototype.float=function(){if(this.pos+4>this.len)throw At(this,4);var e=Kt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};we.prototype.double=function(){if(this.pos+8>this.len)throw At(this,4);var e=Kt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};we.prototype.bytes=function(){var e=this.uint32(),r=this.pos,i=this.pos+e;if(i>this.len)throw At(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,i):r===i?new this.buf.constructor(0):this._slice.call(this.buf,r,i)};we.prototype.string=function(){var e=this.bytes();return qb.read(e,0,e.length)};we.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw At(this,e);this.pos+=e}else do if(this.pos>=this.len)throw At(this);while(this.buf[this.pos++]&128);return this};we.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};we._configure=function(t){wa=t,we.create=n0(),wa._configure();var e=Kt.Long?"toLong":"toNumber";Kt.merge(we.prototype,{int64:function(){return xa.call(this)[e](!1)},uint64:function(){return xa.call(this)[e](!0)},sint64:function(){return xa.call(this).zzDecode()[e](!1)},fixed64:function(){return s0.call(this)[e](!0)},sfixed64:function(){return s0.call(this)[e](!1)}})}});var f0=m((XA,u0)=>{"use strict";u0.exports=ii;var a0=Ea();(ii.prototype=Object.create(a0.prototype)).constructor=ii;var c0=Sr();function ii(t){a0.call(this,t)}ii._configure=function(){c0.Buffer&&(ii.prototype._slice=c0.Buffer.prototype.slice)};ii.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};ii._configure()});var l0=m((JA,h0)=>{"use strict";h0.exports=_n;var _a=Sr();(_n.prototype=Object.create(_a.EventEmitter.prototype)).constructor=_n;function _n(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");_a.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}_n.prototype.rpcCall=function t(e,r,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return _a.asPromise(t,o,e,r,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(f,u){if(f)return o.emit("error",f,e),s(f);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(a){return o.emit("error",a,e),s(a)}return o.emit("data",u,e),s(null,u)})}catch(c){o.emit("error",c,e),setTimeout(function(){s(c)},0);return}};_n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var d0=m(p0=>{"use strict";var Gb=p0;Gb.Service=l0()});var g0=m((e8,y0)=>{"use strict";y0.exports={}});var m0=m(v0=>{"use strict";var tt=v0;tt.build="minimal";tt.Writer=ma();tt.BufferWriter=t0();tt.Reader=Ea();tt.BufferReader=f0();tt.util=Sr();tt.rpc=d0();tt.roots=g0();tt.configure=b0;function b0(){tt.util._configure(),tt.Writer._configure(tt.BufferWriter),tt.Reader._configure(tt.BufferReader)}b0()});var ni=m((r8,w0)=>{"use strict";w0.exports=m0()});var Ia=m((i8,x0)=>{"use strict";var Ar=ni(),Di=Ar.Reader,Sa=Ar.Writer,G=Ar.util,Be=Ar.roots["libp2p-pubsub-rpc"]||(Ar.roots["libp2p-pubsub-rpc"]={});Be.RPC=function(){function t(e){if(this.subscriptions=[],this.msgs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.subscriptions=G.emptyArray,t.prototype.msgs=G.emptyArray,t.encode=function(r,i){if(i||(i=Sa.create()),r.subscriptions!=null&&r.subscriptions.length)for(var n=0;n<r.subscriptions.length;++n)Be.RPC.SubOpts.encode(r.subscriptions[n],i.uint32(10).fork()).ldelim();if(r.msgs!=null&&r.msgs.length)for(var n=0;n<r.msgs.length;++n)Be.RPC.Message.encode(r.msgs[n],i.uint32(18).fork()).ldelim();return i},t.decode=function(r,i){r instanceof Di||(r=Di.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Be.RPC;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(Be.RPC.SubOpts.decode(r,r.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(Be.RPC.Message.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Be.RPC)return r;var i=new Be.RPC;if(r.subscriptions){if(!Array.isArray(r.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<r.subscriptions.length;++n){if(typeof r.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=Be.RPC.SubOpts.fromObject(r.subscriptions[n])}}if(r.msgs){if(!Array.isArray(r.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<r.msgs.length;++n){if(typeof r.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=Be.RPC.Message.fromObject(r.msgs[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),r.subscriptions&&r.subscriptions.length){n.subscriptions=[];for(var s=0;s<r.subscriptions.length;++s)n.subscriptions[s]=Be.RPC.SubOpts.toObject(r.subscriptions[s],i)}if(r.msgs&&r.msgs.length){n.msgs=[];for(var s=0;s<r.msgs.length;++s)n.msgs[s]=Be.RPC.Message.toObject(r.msgs[s],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ar.util.toJSONOptions)},t.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var r;return Object.defineProperty(e.prototype,"_subscribe",{get:G.oneOfGetter(r=["subscribe"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_topicID",{get:G.oneOfGetter(r=["topicID"]),set:G.oneOfSetter(r)}),e.encode=function(n,s){return s||(s=Sa.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof Di||(n=Di.create(n));for(var o=s===void 0?n.len:n.pos+s,c=new Be.RPC.SubOpts;n.pos<o;){var f=n.uint32();switch(f>>>3){case 1:c.subscribe=n.bool();break;case 2:c.topicID=n.string();break;default:n.skipType(f&7);break}}return c},e.fromObject=function(n){if(n instanceof Be.RPC.SubOpts)return n;var s=new Be.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ar.util.toJSONOptions)},e}(),t.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=G.emptyArray,e.prototype.signature=null,e.prototype.key=null;var r;return Object.defineProperty(e.prototype,"_from",{get:G.oneOfGetter(r=["from"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_data",{get:G.oneOfGetter(r=["data"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_seqno",{get:G.oneOfGetter(r=["seqno"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_signature",{get:G.oneOfGetter(r=["signature"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_key",{get:G.oneOfGetter(r=["key"]),set:G.oneOfSetter(r)}),e.encode=function(n,s){if(s||(s=Sa.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof Di||(n=Di.create(n));for(var o=s===void 0?n.len:n.pos+s,c=new Be.RPC.Message;n.pos<o;){var f=n.uint32();switch(f>>>3){case 1:c.from=n.bytes();break;case 2:c.data=n.bytes();break;case 3:c.seqno=n.bytes();break;case 4:c.topicIDs&&c.topicIDs.length||(c.topicIDs=[]),c.topicIDs.push(n.string());break;case 5:c.signature=n.bytes();break;case 6:c.key=n.bytes();break;default:n.skipType(f&7);break}}return c},e.fromObject=function(n){if(n instanceof Be.RPC.Message)return n;var s=new Be.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?G.base64.decode(n.from,s.from=G.newBuffer(G.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?G.base64.decode(n.data,s.data=G.newBuffer(G.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?G.base64.decode(n.seqno,s.seqno=G.newBuffer(G.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?G.base64.decode(n.signature,s.signature=G.newBuffer(G.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?G.base64.decode(n.key,s.key=G.newBuffer(G.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?G.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?G.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?G.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var c=0;c<n.topicIDs.length;++c)o.topicIDs[c]=n.topicIDs[c]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?G.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?G.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ar.util.toJSONOptions)},e}(),t}();x0.exports=Be});var Ba=m(Ps=>{"use strict";Ps.byteLength=jb;Ps.toByteArray=zb;Ps.fromByteArray=Yb;var Ft=[],pt=[],Vb=typeof Uint8Array!="undefined"?Uint8Array:Array,Aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(si=0,E0=Aa.length;si<E0;++si)Ft[si]=Aa[si],pt[Aa.charCodeAt(si)]=si;var si,E0;pt["-".charCodeAt(0)]=62;pt["_".charCodeAt(0)]=63;function _0(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function jb(t){var e=_0(t),r=e[0],i=e[1];return(r+i)*3/4-i}function Hb(t,e,r){return(e+r)*3/4-r}function zb(t){var e,r=_0(t),i=r[0],n=r[1],s=new Vb(Hb(t,i,n)),o=0,c=n>0?i-4:i,f;for(f=0;f<c;f+=4)e=pt[t.charCodeAt(f)]<<18|pt[t.charCodeAt(f+1)]<<12|pt[t.charCodeAt(f+2)]<<6|pt[t.charCodeAt(f+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=pt[t.charCodeAt(f)]<<2|pt[t.charCodeAt(f+1)]>>4,s[o++]=e&255),n===1&&(e=pt[t.charCodeAt(f)]<<10|pt[t.charCodeAt(f+1)]<<4|pt[t.charCodeAt(f+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function Wb(t){return Ft[t>>18&63]+Ft[t>>12&63]+Ft[t>>6&63]+Ft[t&63]}function $b(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),n.push(Wb(i));return n.join("")}function Yb(t){for(var e,r=t.length,i=r%3,n=[],s=16383,o=0,c=r-i;o<c;o+=s)n.push($b(t,o,o+s>c?c:o+s));return i===1?(e=t[r-1],n.push(Ft[e>>2]+Ft[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(Ft[e>>10]+Ft[e>>4&63]+Ft[e<<2&63]+"=")),n.join("")}});var S0=m(Ra=>{Ra.read=function(t,e,r,i,n){var s,o,c=n*8-i-1,f=(1<<c)-1,u=f>>1,a=-7,h=r?n-1:0,l=r?-1:1,d=t[e+h];for(h+=l,s=d&(1<<-a)-1,d>>=-a,a+=c;a>0;s=s*256+t[e+h],h+=l,a-=8);for(o=s&(1<<-a)-1,s>>=-a,a+=i;a>0;o=o*256+t[e+h],h+=l,a-=8);if(s===0)s=1-u;else{if(s===f)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(d?-1:1)*o*Math.pow(2,s-i)};Ra.write=function(t,e,r,i,n,s){var o,c,f,u=s*8-n-1,a=(1<<u)-1,h=a>>1,l=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,o=a):(o=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+h>=1?e+=l/f:e+=l*Math.pow(2,1-h),e*f>=2&&(o++,f/=2),o+h>=a?(c=0,o=a):o+h>=1?(c=(e*f-1)*Math.pow(2,n),o=o+h):(c=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;t[r+d]=c&255,d+=p,c/=256,n-=8);for(o=o<<n|c,u+=n;u>0;t[r+d]=o&255,d+=p,o/=256,u-=8);t[r+d-p]|=y*128}});var Mi=m(Li=>{"use strict";var Ca=Ba(),Oi=S0(),I0=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Li.Buffer=E;Li.SlowBuffer=t2;Li.INSPECT_MAX_BYTES=50;var Ds=2147483647;Li.kMaxLength=Ds;E.TYPED_ARRAY_SUPPORT=Qb();!E.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Qb(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(E.prototype,"parent",{enumerable:!0,get:function(){if(!!E.isBuffer(this))return this.buffer}});Object.defineProperty(E.prototype,"offset",{enumerable:!0,get:function(){if(!!E.isBuffer(this))return this.byteOffset}});function cr(t){if(t>Ds)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,E.prototype),e}function E(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Ta(t)}return A0(t,e,r)}E.poolSize=8192;function A0(t,e,r){if(typeof t=="string")return Jb(t,e);if(ArrayBuffer.isView(t))return Zb(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Ut(t,ArrayBuffer)||t&&Ut(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ut(t,SharedArrayBuffer)||t&&Ut(t.buffer,SharedArrayBuffer)))return Da(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(i!=null&&i!==t)return E.from(i,e,r);let n=e2(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return E.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}E.from=function(t,e,r){return A0(t,e,r)};Object.setPrototypeOf(E.prototype,Uint8Array.prototype);Object.setPrototypeOf(E,Uint8Array);function B0(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function Xb(t,e,r){return B0(t),t<=0?cr(t):e!==void 0?typeof r=="string"?cr(t).fill(e,r):cr(t).fill(e):cr(t)}E.alloc=function(t,e,r){return Xb(t,e,r)};function Ta(t){return B0(t),cr(t<0?0:Oa(t)|0)}E.allocUnsafe=function(t){return Ta(t)};E.allocUnsafeSlow=function(t){return Ta(t)};function Jb(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!E.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=R0(t,e)|0,i=cr(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function Pa(t){let e=t.length<0?0:Oa(t.length)|0,r=cr(e);for(let i=0;i<e;i+=1)r[i]=t[i]&255;return r}function Zb(t){if(Ut(t,Uint8Array)){let e=new Uint8Array(t);return Da(e.buffer,e.byteOffset,e.byteLength)}return Pa(t)}function Da(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&r===void 0?i=new Uint8Array(t):r===void 0?i=new Uint8Array(t,e):i=new Uint8Array(t,e,r),Object.setPrototypeOf(i,E.prototype),i}function e2(t){if(E.isBuffer(t)){let e=Oa(t.length)|0,r=cr(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||La(t.length)?cr(0):Pa(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Pa(t.data)}function Oa(t){if(t>=Ds)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ds.toString(16)+" bytes");return t|0}function t2(t){return+t!=t&&(t=0),E.alloc(+t)}E.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==E.prototype};E.compare=function(e,r){if(Ut(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),Ut(r,Uint8Array)&&(r=E.from(r,r.offset,r.byteLength)),!E.isBuffer(e)||!E.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let i=e.length,n=r.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};E.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};E.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return E.alloc(0);let i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;let n=E.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){let o=e[i];if(Ut(o,Uint8Array))s+o.length>n.length?(E.isBuffer(o)||(o=E.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(E.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function R0(t,e){if(E.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Ut(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&r===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Na(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return U0(t).length;default:if(n)return i?-1:Na(t).length;e=(""+e).toLowerCase(),n=!0}}E.byteLength=R0;function r2(t,e,r){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return l2(this,e,r);case"utf8":case"utf-8":return P0(this,e,r);case"ascii":return f2(this,e,r);case"latin1":case"binary":return h2(this,e,r);case"base64":return c2(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p2(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}E.prototype._isBuffer=!0;function oi(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}E.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)oi(this,r,r+1);return this};E.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)oi(this,r,r+3),oi(this,r+1,r+2);return this};E.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)oi(this,r,r+7),oi(this,r+1,r+6),oi(this,r+2,r+5),oi(this,r+3,r+4);return this};E.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?P0(this,0,e):r2.apply(this,arguments)};E.prototype.toLocaleString=E.prototype.toString;E.prototype.equals=function(e){if(!E.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:E.compare(this,e)===0};E.prototype.inspect=function(){let e="",r=Li.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};I0&&(E.prototype[I0]=E.prototype.inspect);E.prototype.compare=function(e,r,i,n,s){if(Ut(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),!E.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,c=i-r,f=Math.min(o,c),u=this.slice(n,s),a=e.slice(r,i);for(let h=0;h<f;++h)if(u[h]!==a[h]){o=u[h],c=a[h];break}return o<c?-1:c<o?1:0};function C0(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,La(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=E.from(e,i)),E.isBuffer(e))return e.length===0?-1:T0(t,e,r,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):T0(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function T0(t,e,r,i,n){let s=1,o=t.length,c=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,c/=2,r/=2}function f(a,h){return s===1?a[h]:a.readUInt16BE(h*s)}let u;if(n){let a=-1;for(u=r;u<o;u++)if(f(t,u)===f(e,a===-1?0:u-a)){if(a===-1&&(a=u),u-a+1===c)return a*s}else a!==-1&&(u-=u-a),a=-1}else for(r+c>o&&(r=o-c),u=r;u>=0;u--){let a=!0;for(let h=0;h<c;h++)if(f(t,u+h)!==f(e,h)){a=!1;break}if(a)return u}return-1}E.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};E.prototype.indexOf=function(e,r,i){return C0(this,e,r,i,!0)};E.prototype.lastIndexOf=function(e,r,i){return C0(this,e,r,i,!1)};function i2(t,e,r,i){r=Number(r)||0;let n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let c=parseInt(e.substr(o*2,2),16);if(La(c))return o;t[r+o]=c}return o}function n2(t,e,r,i){return Os(Na(e,t.length-r),t,r,i)}function s2(t,e,r,i){return Os(b2(e),t,r,i)}function o2(t,e,r,i){return Os(U0(e),t,r,i)}function a2(t,e,r,i){return Os(v2(e,t.length-r),t,r,i)}E.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return i2(this,e,r,i);case"utf8":case"utf-8":return n2(this,e,r,i);case"ascii":case"latin1":case"binary":return s2(this,e,r,i);case"base64":return o2(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a2(this,e,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};E.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function c2(t,e,r){return e===0&&r===t.length?Ca.fromByteArray(t):Ca.fromByteArray(t.slice(e,r))}function P0(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let s=t[n],o=null,c=s>239?4:s>223?3:s>191?2:1;if(n+c<=r){let f,u,a,h;switch(c){case 1:s<128&&(o=s);break;case 2:f=t[n+1],(f&192)==128&&(h=(s&31)<<6|f&63,h>127&&(o=h));break;case 3:f=t[n+1],u=t[n+2],(f&192)==128&&(u&192)==128&&(h=(s&15)<<12|(f&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:f=t[n+1],u=t[n+2],a=t[n+3],(f&192)==128&&(u&192)==128&&(a&192)==128&&(h=(s&15)<<18|(f&63)<<12|(u&63)<<6|a&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,c=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=c}return u2(i)}var D0=4096;function u2(t){let e=t.length;if(e<=D0)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=D0));return r}function f2(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function h2(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function l2(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let s=e;s<r;++s)n+=m2[t[s]];return n}function p2(t,e,r){let i=t.slice(e,r),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}E.prototype.slice=function(e,r){let i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);let n=this.subarray(e,r);return Object.setPrototypeOf(n,E.prototype),n};function Pe(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}E.prototype.readUintLE=E.prototype.readUIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||Pe(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return n};E.prototype.readUintBE=E.prototype.readUIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||Pe(e,r,this.length);let n=this[e+--r],s=1;for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n};E.prototype.readUint8=E.prototype.readUInt8=function(e,r){return e=e>>>0,r||Pe(e,1,this.length),this[e]};E.prototype.readUint16LE=E.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Pe(e,2,this.length),this[e]|this[e+1]<<8};E.prototype.readUint16BE=E.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Pe(e,2,this.length),this[e]<<8|this[e+1]};E.prototype.readUint32LE=E.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Pe(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};E.prototype.readUint32BE=E.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Pe(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};E.prototype.readBigUInt64LE=Br(function(e){e=e>>>0,Ni(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Sn(e,this.length-8);let n=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});E.prototype.readBigUInt64BE=Br(function(e){e=e>>>0,Ni(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Sn(e,this.length-8);let n=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});E.prototype.readIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||Pe(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};E.prototype.readIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||Pe(e,r,this.length);let n=r,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};E.prototype.readInt8=function(e,r){return e=e>>>0,r||Pe(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};E.prototype.readInt16LE=function(e,r){e=e>>>0,r||Pe(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};E.prototype.readInt16BE=function(e,r){e=e>>>0,r||Pe(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};E.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Pe(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};E.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Pe(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};E.prototype.readBigInt64LE=Br(function(e){e=e>>>0,Ni(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Sn(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});E.prototype.readBigInt64BE=Br(function(e){e=e>>>0,Ni(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Sn(e,this.length-8);let n=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});E.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Pe(e,4,this.length),Oi.read(this,e,!0,23,4)};E.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Pe(e,4,this.length),Oi.read(this,e,!1,23,4)};E.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Pe(e,8,this.length),Oi.read(this,e,!0,52,8)};E.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Pe(e,8,this.length),Oi.read(this,e,!1,52,8)};function rt(t,e,r,i,n,s){if(!E.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}E.prototype.writeUintLE=E.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let c=Math.pow(2,8*i)-1;rt(this,e,r,i,c,0)}let s=1,o=0;for(this[r]=e&255;++o<i&&(s*=256);)this[r+o]=e/s&255;return r+i};E.prototype.writeUintBE=E.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let c=Math.pow(2,8*i)-1;rt(this,e,r,i,c,0)}let s=i-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+i};E.prototype.writeUint8=E.prototype.writeUInt8=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,1,255,0),this[r]=e&255,r+1};E.prototype.writeUint16LE=E.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};E.prototype.writeUint16BE=E.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};E.prototype.writeUint32LE=E.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};E.prototype.writeUint32BE=E.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function O0(t,e,r,i,n){F0(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function k0(t,e,r,i,n){F0(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}E.prototype.writeBigUInt64LE=Br(function(e,r=0){return O0(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});E.prototype.writeBigUInt64BE=Br(function(e,r=0){return k0(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});E.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let f=Math.pow(2,8*i-1);rt(this,e,r,i,f-1,-f)}let s=0,o=1,c=0;for(this[r]=e&255;++s<i&&(o*=256);)e<0&&c===0&&this[r+s-1]!==0&&(c=1),this[r+s]=(e/o>>0)-c&255;return r+i};E.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let f=Math.pow(2,8*i-1);rt(this,e,r,i,f-1,-f)}let s=i-1,o=1,c=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&c===0&&this[r+s+1]!==0&&(c=1),this[r+s]=(e/o>>0)-c&255;return r+i};E.prototype.writeInt8=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};E.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};E.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};E.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};E.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||rt(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};E.prototype.writeBigInt64LE=Br(function(e,r=0){return O0(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});E.prototype.writeBigInt64BE=Br(function(e,r=0){return k0(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function N0(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L0(t,e,r,i,n){return e=+e,r=r>>>0,n||N0(t,e,r,4,34028234663852886e22,-34028234663852886e22),Oi.write(t,e,r,i,23,4),r+4}E.prototype.writeFloatLE=function(e,r,i){return L0(this,e,r,!0,i)};E.prototype.writeFloatBE=function(e,r,i){return L0(this,e,r,!1,i)};function M0(t,e,r,i,n){return e=+e,r=r>>>0,n||N0(t,e,r,8,17976931348623157e292,-17976931348623157e292),Oi.write(t,e,r,i,52,8),r+8}E.prototype.writeDoubleLE=function(e,r,i){return M0(this,e,r,!0,i)};E.prototype.writeDoubleBE=function(e,r,i){return M0(this,e,r,!1,i)};E.prototype.copy=function(e,r,i,n){if(!E.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),r),s};E.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!E.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{let o=E.isBuffer(e)?e:E.from(e,n),c=o.length;if(c===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=o[s%c]}return this};var ki={};function ka(t,e,r){ki[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}ka("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);ka("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);ka("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=K0(String(r)):typeof r=="bigint"&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=K0(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function K0(t){let e="",r=t.length,i=t[0]==="-"?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function d2(t,e,r){Ni(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Sn(e,t.length-(r+1))}function F0(t,e,r,i,n,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",c;throw s>3?e===0||e===BigInt(0)?c=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:c=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:c=`>= ${e}${o} and <= ${r}${o}`,new ki.ERR_OUT_OF_RANGE("value",c,t)}d2(i,n,s)}function Ni(t,e){if(typeof t!="number")throw new ki.ERR_INVALID_ARG_TYPE(e,"number",t)}function Sn(t,e,r){throw Math.floor(t)!==t?(Ni(t,r),new ki.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new ki.ERR_BUFFER_OUT_OF_BOUNDS:new ki.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var y2=/[^+/0-9A-Za-z-_]/g;function g2(t){if(t=t.split("=")[0],t=t.trim().replace(y2,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function Na(t,e){e=e||1/0;let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function b2(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function v2(t,e){let r,i,n,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function U0(t){return Ca.toByteArray(g2(t))}function Os(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function Ut(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function La(t){return t!==t}var m2=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let i=r*16;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function Br(t){return typeof BigInt=="undefined"?w2:t}function w2(){throw new Error("BigInt not supported")}});var q0=m(Ma=>{Ma.read=function(t,e,r,i,n){var s,o,c=n*8-i-1,f=(1<<c)-1,u=f>>1,a=-7,h=r?n-1:0,l=r?-1:1,d=t[e+h];for(h+=l,s=d&(1<<-a)-1,d>>=-a,a+=c;a>0;s=s*256+t[e+h],h+=l,a-=8);for(o=s&(1<<-a)-1,s>>=-a,a+=i;a>0;o=o*256+t[e+h],h+=l,a-=8);if(s===0)s=1-u;else{if(s===f)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(d?-1:1)*o*Math.pow(2,s-i)};Ma.write=function(t,e,r,i,n,s){var o,c,f,u=s*8-n-1,a=(1<<u)-1,h=a>>1,l=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,o=a):(o=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+h>=1?e+=l/f:e+=l*Math.pow(2,1-h),e*f>=2&&(o++,f/=2),o+h>=a?(c=0,o=a):o+h>=1?(c=(e*f-1)*Math.pow(2,n),o=o+h):(c=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;t[r+d]=c&255,d+=p,c/=256,n-=8);for(o=o<<n|c,u+=n;u>0;t[r+d]=o&255,d+=p,o/=256,u-=8);t[r+d-p]|=y*128}});var nh=m(qi=>{"use strict";var Ka=Ba(),Ki=q0(),G0=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;qi.Buffer=_;qi.SlowBuffer=A2;qi.INSPECT_MAX_BYTES=50;var ks=2147483647;qi.kMaxLength=ks;_.TYPED_ARRAY_SUPPORT=x2();!_.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function x2(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(_.prototype,"parent",{enumerable:!0,get:function(){if(!!_.isBuffer(this))return this.buffer}});Object.defineProperty(_.prototype,"offset",{enumerable:!0,get:function(){if(!!_.isBuffer(this))return this.byteOffset}});function ur(t){if(t>ks)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,_.prototype),e}function _(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Fa(t)}return V0(t,e,r)}_.poolSize=8192;function V0(t,e,r){if(typeof t=="string")return _2(t,e);if(ArrayBuffer.isView(t))return S2(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(qt(t,ArrayBuffer)||t&&qt(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(qt(t,SharedArrayBuffer)||t&&qt(t.buffer,SharedArrayBuffer)))return qa(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(i!=null&&i!==t)return _.from(i,e,r);let n=I2(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return _.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}_.from=function(t,e,r){return V0(t,e,r)};Object.setPrototypeOf(_.prototype,Uint8Array.prototype);Object.setPrototypeOf(_,Uint8Array);function j0(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function E2(t,e,r){return j0(t),t<=0?ur(t):e!==void 0?typeof r=="string"?ur(t).fill(e,r):ur(t).fill(e):ur(t)}_.alloc=function(t,e,r){return E2(t,e,r)};function Fa(t){return j0(t),ur(t<0?0:Ga(t)|0)}_.allocUnsafe=function(t){return Fa(t)};_.allocUnsafeSlow=function(t){return Fa(t)};function _2(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!_.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=H0(t,e)|0,i=ur(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function Ua(t){let e=t.length<0?0:Ga(t.length)|0,r=ur(e);for(let i=0;i<e;i+=1)r[i]=t[i]&255;return r}function S2(t){if(qt(t,Uint8Array)){let e=new Uint8Array(t);return qa(e.buffer,e.byteOffset,e.byteLength)}return Ua(t)}function qa(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&r===void 0?i=new Uint8Array(t):r===void 0?i=new Uint8Array(t,e):i=new Uint8Array(t,e,r),Object.setPrototypeOf(i,_.prototype),i}function I2(t){if(_.isBuffer(t)){let e=Ga(t.length)|0,r=ur(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||Ha(t.length)?ur(0):Ua(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Ua(t.data)}function Ga(t){if(t>=ks)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ks.toString(16)+" bytes");return t|0}function A2(t){return+t!=t&&(t=0),_.alloc(+t)}_.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==_.prototype};_.compare=function(e,r){if(qt(e,Uint8Array)&&(e=_.from(e,e.offset,e.byteLength)),qt(r,Uint8Array)&&(r=_.from(r,r.offset,r.byteLength)),!_.isBuffer(e)||!_.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let i=e.length,n=r.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};_.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};_.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return _.alloc(0);let i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;let n=_.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){let o=e[i];if(qt(o,Uint8Array))s+o.length>n.length?(_.isBuffer(o)||(o=_.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(_.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function H0(t,e){if(_.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||qt(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&r===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return ja(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return ih(t).length;default:if(n)return i?-1:ja(t).length;e=(""+e).toLowerCase(),n=!0}}_.byteLength=H0;function B2(t,e,r){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return M2(this,e,r);case"utf8":case"utf-8":return $0(this,e,r);case"ascii":return N2(this,e,r);case"latin1":case"binary":return L2(this,e,r);case"base64":return O2(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K2(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}_.prototype._isBuffer=!0;function ai(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}_.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)ai(this,r,r+1);return this};_.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)ai(this,r,r+3),ai(this,r+1,r+2);return this};_.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)ai(this,r,r+7),ai(this,r+1,r+6),ai(this,r+2,r+5),ai(this,r+3,r+4);return this};_.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?$0(this,0,e):B2.apply(this,arguments)};_.prototype.toLocaleString=_.prototype.toString;_.prototype.equals=function(e){if(!_.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:_.compare(this,e)===0};_.prototype.inspect=function(){let e="",r=qi.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};G0&&(_.prototype[G0]=_.prototype.inspect);_.prototype.compare=function(e,r,i,n,s){if(qt(e,Uint8Array)&&(e=_.from(e,e.offset,e.byteLength)),!_.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,c=i-r,f=Math.min(o,c),u=this.slice(n,s),a=e.slice(r,i);for(let h=0;h<f;++h)if(u[h]!==a[h]){o=u[h],c=a[h];break}return o<c?-1:c<o?1:0};function z0(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Ha(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=_.from(e,i)),_.isBuffer(e))return e.length===0?-1:W0(t,e,r,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):W0(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function W0(t,e,r,i,n){let s=1,o=t.length,c=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,c/=2,r/=2}function f(a,h){return s===1?a[h]:a.readUInt16BE(h*s)}let u;if(n){let a=-1;for(u=r;u<o;u++)if(f(t,u)===f(e,a===-1?0:u-a)){if(a===-1&&(a=u),u-a+1===c)return a*s}else a!==-1&&(u-=u-a),a=-1}else for(r+c>o&&(r=o-c),u=r;u>=0;u--){let a=!0;for(let h=0;h<c;h++)if(f(t,u+h)!==f(e,h)){a=!1;break}if(a)return u}return-1}_.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};_.prototype.indexOf=function(e,r,i){return z0(this,e,r,i,!0)};_.prototype.lastIndexOf=function(e,r,i){return z0(this,e,r,i,!1)};function R2(t,e,r,i){r=Number(r)||0;let n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let c=parseInt(e.substr(o*2,2),16);if(Ha(c))return o;t[r+o]=c}return o}function C2(t,e,r,i){return Ns(ja(e,t.length-r),t,r,i)}function T2(t,e,r,i){return Ns(G2(e),t,r,i)}function P2(t,e,r,i){return Ns(ih(e),t,r,i)}function D2(t,e,r,i){return Ns(V2(e,t.length-r),t,r,i)}_.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return R2(this,e,r,i);case"utf8":case"utf-8":return C2(this,e,r,i);case"ascii":case"latin1":case"binary":return T2(this,e,r,i);case"base64":return P2(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D2(this,e,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};_.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O2(t,e,r){return e===0&&r===t.length?Ka.fromByteArray(t):Ka.fromByteArray(t.slice(e,r))}function $0(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let s=t[n],o=null,c=s>239?4:s>223?3:s>191?2:1;if(n+c<=r){let f,u,a,h;switch(c){case 1:s<128&&(o=s);break;case 2:f=t[n+1],(f&192)==128&&(h=(s&31)<<6|f&63,h>127&&(o=h));break;case 3:f=t[n+1],u=t[n+2],(f&192)==128&&(u&192)==128&&(h=(s&15)<<12|(f&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:f=t[n+1],u=t[n+2],a=t[n+3],(f&192)==128&&(u&192)==128&&(a&192)==128&&(h=(s&15)<<18|(f&63)<<12|(u&63)<<6|a&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,c=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=c}return k2(i)}var Y0=4096;function k2(t){let e=t.length;if(e<=Y0)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=Y0));return r}function N2(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function L2(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function M2(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let s=e;s<r;++s)n+=j2[t[s]];return n}function K2(t,e,r){let i=t.slice(e,r),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}_.prototype.slice=function(e,r){let i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);let n=this.subarray(e,r);return Object.setPrototypeOf(n,_.prototype),n};function De(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}_.prototype.readUintLE=_.prototype.readUIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||De(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return n};_.prototype.readUintBE=_.prototype.readUIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||De(e,r,this.length);let n=this[e+--r],s=1;for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n};_.prototype.readUint8=_.prototype.readUInt8=function(e,r){return e=e>>>0,r||De(e,1,this.length),this[e]};_.prototype.readUint16LE=_.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||De(e,2,this.length),this[e]|this[e+1]<<8};_.prototype.readUint16BE=_.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||De(e,2,this.length),this[e]<<8|this[e+1]};_.prototype.readUint32LE=_.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||De(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};_.prototype.readUint32BE=_.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||De(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};_.prototype.readBigUInt64LE=Rr(function(e){e=e>>>0,Ui(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&In(e,this.length-8);let n=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});_.prototype.readBigUInt64BE=Rr(function(e){e=e>>>0,Ui(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&In(e,this.length-8);let n=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});_.prototype.readIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||De(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};_.prototype.readIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||De(e,r,this.length);let n=r,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};_.prototype.readInt8=function(e,r){return e=e>>>0,r||De(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};_.prototype.readInt16LE=function(e,r){e=e>>>0,r||De(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};_.prototype.readInt16BE=function(e,r){e=e>>>0,r||De(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};_.prototype.readInt32LE=function(e,r){return e=e>>>0,r||De(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};_.prototype.readInt32BE=function(e,r){return e=e>>>0,r||De(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};_.prototype.readBigInt64LE=Rr(function(e){e=e>>>0,Ui(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&In(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});_.prototype.readBigInt64BE=Rr(function(e){e=e>>>0,Ui(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&In(e,this.length-8);let n=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});_.prototype.readFloatLE=function(e,r){return e=e>>>0,r||De(e,4,this.length),Ki.read(this,e,!0,23,4)};_.prototype.readFloatBE=function(e,r){return e=e>>>0,r||De(e,4,this.length),Ki.read(this,e,!1,23,4)};_.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||De(e,8,this.length),Ki.read(this,e,!0,52,8)};_.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||De(e,8,this.length),Ki.read(this,e,!1,52,8)};function it(t,e,r,i,n,s){if(!_.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}_.prototype.writeUintLE=_.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let c=Math.pow(2,8*i)-1;it(this,e,r,i,c,0)}let s=1,o=0;for(this[r]=e&255;++o<i&&(s*=256);)this[r+o]=e/s&255;return r+i};_.prototype.writeUintBE=_.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let c=Math.pow(2,8*i)-1;it(this,e,r,i,c,0)}let s=i-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+i};_.prototype.writeUint8=_.prototype.writeUInt8=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,1,255,0),this[r]=e&255,r+1};_.prototype.writeUint16LE=_.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};_.prototype.writeUint16BE=_.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};_.prototype.writeUint32LE=_.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};_.prototype.writeUint32BE=_.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Q0(t,e,r,i,n){rh(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function X0(t,e,r,i,n){rh(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}_.prototype.writeBigUInt64LE=Rr(function(e,r=0){return Q0(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});_.prototype.writeBigUInt64BE=Rr(function(e,r=0){return X0(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});_.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let f=Math.pow(2,8*i-1);it(this,e,r,i,f-1,-f)}let s=0,o=1,c=0;for(this[r]=e&255;++s<i&&(o*=256);)e<0&&c===0&&this[r+s-1]!==0&&(c=1),this[r+s]=(e/o>>0)-c&255;return r+i};_.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let f=Math.pow(2,8*i-1);it(this,e,r,i,f-1,-f)}let s=i-1,o=1,c=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&c===0&&this[r+s+1]!==0&&(c=1),this[r+s]=(e/o>>0)-c&255;return r+i};_.prototype.writeInt8=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};_.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};_.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};_.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};_.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||it(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};_.prototype.writeBigInt64LE=Rr(function(e,r=0){return Q0(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});_.prototype.writeBigInt64BE=Rr(function(e,r=0){return X0(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function J0(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Z0(t,e,r,i,n){return e=+e,r=r>>>0,n||J0(t,e,r,4,34028234663852886e22,-34028234663852886e22),Ki.write(t,e,r,i,23,4),r+4}_.prototype.writeFloatLE=function(e,r,i){return Z0(this,e,r,!0,i)};_.prototype.writeFloatBE=function(e,r,i){return Z0(this,e,r,!1,i)};function eh(t,e,r,i,n){return e=+e,r=r>>>0,n||J0(t,e,r,8,17976931348623157e292,-17976931348623157e292),Ki.write(t,e,r,i,52,8),r+8}_.prototype.writeDoubleLE=function(e,r,i){return eh(this,e,r,!0,i)};_.prototype.writeDoubleBE=function(e,r,i){return eh(this,e,r,!1,i)};_.prototype.copy=function(e,r,i,n){if(!_.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),r),s};_.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!_.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{let o=_.isBuffer(e)?e:_.from(e,n),c=o.length;if(c===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=o[s%c]}return this};var Fi={};function Va(t,e,r){Fi[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Va("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Va("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);Va("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=th(String(r)):typeof r=="bigint"&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=th(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function th(t){let e="",r=t.length,i=t[0]==="-"?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function F2(t,e,r){Ui(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&In(e,t.length-(r+1))}function rh(t,e,r,i,n,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",c;throw s>3?e===0||e===BigInt(0)?c=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:c=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:c=`>= ${e}${o} and <= ${r}${o}`,new Fi.ERR_OUT_OF_RANGE("value",c,t)}F2(i,n,s)}function Ui(t,e){if(typeof t!="number")throw new Fi.ERR_INVALID_ARG_TYPE(e,"number",t)}function In(t,e,r){throw Math.floor(t)!==t?(Ui(t,r),new Fi.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new Fi.ERR_BUFFER_OUT_OF_BOUNDS:new Fi.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var U2=/[^+/0-9A-Za-z-_]/g;function q2(t){if(t=t.split("=")[0],t=t.trim().replace(U2,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function ja(t,e){e=e||1/0;let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function G2(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function V2(t,e){let r,i,n,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function ih(t){return Ka.toByteArray(q2(t))}function Ns(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function qt(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function Ha(t){return t!==t}var j2=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let i=r*16;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function Rr(t){return typeof BigInt=="undefined"?H2:t}function H2(){throw new Error("BigInt not supported")}});var za=m((h8,oh)=>{"use strict";var{Buffer:Bt}=nh(),sh=Symbol.for("BufferList");function ce(t){if(!(this instanceof ce))return new ce(t);ce._init.call(this,t)}ce._init=function(e){Object.defineProperty(this,sh,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ce.prototype._new=function(e){return new ce(e)};ce.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};ce.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};ce.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};ce.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};ce.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Bt.alloc(0);let s=!!e,o=this._offset(i),c=n-i,f=c,u=s&&r||0,a=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Bt.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(f<=this._bufs[o[0]].length-a)return s?this._bufs[o[0]].copy(e,r,a,a+f):this._bufs[o[0]].slice(a,a+f);s||(e=Bt.allocUnsafe(c));for(let h=o[0];h<this._bufs.length;h++){let l=this._bufs[h].length-a;if(f>l)this._bufs[h].copy(e,u,a),u+=l;else{this._bufs[h].copy(e,u,a,a+f),u+=l;break}f-=l,a&&(a=0)}return e.length>u?e.slice(0,u):e};ce.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ce.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};ce.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ce.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};ce.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Bt.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Bt.from(e));return this};ce.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ce.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Bt.from([t]):typeof t=="string"?t=Bt.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Bt.from(t.buffer,t.byteOffset,t.byteLength):Bt.isBuffer(t)||(t=Bt.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let f=o.indexOf(t,s);if(f!==-1)return this._reverseOffset([n,f]);s=o.length-t.length+1}else{let f=this._reverseOffset([n,s]);if(this._match(f,t))return f;s++}s=0}return-1};ce.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?ce.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:ce.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();ce.prototype._isBufferList=function(e){return e instanceof ce||ce.isBufferList(e)};ce.isBufferList=function(e){return e!=null&&e[sh]};oh.exports=ce});var uh=m((l8,ch)=>{ch.exports=Wa;var ah=128,z2=127,W2=~z2,$2=Math.pow(2,31);function Wa(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Wa.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var i=r;t>=$2;)e[r++]=t&255|ah,t/=128;for(;t&W2;)e[r++]=t&255|ah,t>>>=7;return e[r]=t|0,Wa.bytes=r-i+1,e}});var lh=m((p8,hh)=>{hh.exports=$a;var Y2=128,fh=127;function $a(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o||i>49)throw $a.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&fh)<<i:(s&fh)*Math.pow(2,i),i+=7}while(s>=Y2);return $a.bytes=n-e,r}});var dh=m((d8,ph)=>{var Q2=Math.pow(2,7),X2=Math.pow(2,14),J2=Math.pow(2,21),Z2=Math.pow(2,28),ev=Math.pow(2,35),tv=Math.pow(2,42),rv=Math.pow(2,49),iv=Math.pow(2,56),nv=Math.pow(2,63);ph.exports=function(t){return t<Q2?1:t<X2?2:t<J2?3:t<Z2?4:t<ev?5:t<tv?6:t<rv?7:t<iv?8:t<nv?9:10}});var Ls=m((y8,yh)=>{yh.exports={encode:uh(),decode:lh(),encodingLength:dh()}});var Ya=m((g8,vh)=>{"use strict";var gh=Ls(),{Buffer:sv}=Mi(),bh=(t,e,r)=>{let i=gh.encode(t,e,r);return bh.bytes=gh.encode.bytes,e||sv.from(i)};vh.exports=bh});var Sh=m((b8,Ms)=>{"use strict";var{Buffer:mh}=Mi(),wh=za(),xh=Ya(),Qa=8,Eh=10*1024;function _h(t){t=t||{};let e=Math.max(t.poolSize||Eh,t.minPoolSize||Qa),r=t.lengthEncoder||xh;return async function*(n){let s=mh.alloc(e),o=0;for await(let c of n){r(c.length,s,o);let f=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<Qa&&(s=mh.alloc(e),o=0),yield new wh().append(f).append(c)}}}_h.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||xh;return new wh([r(t.length),t.slice()])};Ms.exports=_h;Ms.exports.MIN_POOL_SIZE=Qa;Ms.exports.DEFAULT_POOL_SIZE=Eh});var Xa=m((v8,Bh)=>{"use strict";var Ih=Ls(),{Buffer:ov}=Mi(),av=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),Ah=t=>{let e=Ih.decode(ov.isBuffer(t)?t:av(t));return Ah.bytes=Ih.decode.bytes,e};Bh.exports=Ah});var Ph=m((m8,Ks)=>{"use strict";var{Buffer:cv}=Mi(),Ja=za(),uv=Xa(),Rh=8,Ch=1024*1024*4,Th=cv.alloc(0),Cr={LENGTH:"readLength",DATA:"readData"},fv={[Cr.LENGTH]:(t,e,r,i)=>{e=e.append(t);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Cr.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(i.lengthDecoder.bytes),e=new Ja,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(Th),{mode:Cr.LENGTH,chunk:t,buffer:e,data:Th}):{mode:Cr.DATA,chunk:t,buffer:e,state:{dataLength:n},data:void 0}},[Cr.DATA]:(t,e,r,i)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:Cr.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:n}=r,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new Ja,i.onData&&i.onData(s),{mode:Cr.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function Za(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||uv,maxLengthLength:t.maxLengthLength||Rh,maxDataLength:t.maxDataLength||Ch,onLength:t.onLength,onData:t.onData};return async function*(i){let n=new Ja,s=Cr.LENGTH,o;for await(let c of i){let f=c;for(;f;){let u=fv[s](f,n,o,e);s=u.mode,f=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}Za.fromReader=(t,e)=>{let r=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return Za({...e||{},onLength:s=>{r=s}})(i)};Ks.exports=Za;Ks.exports.MAX_LENGTH_LENGTH=Rh;Ks.exports.MAX_DATA_LENGTH=Ch});var kh=m((w8,Oh)=>{"use strict";var{Buffer:hv}=Mi(),Dh=(t,e,r)=>(e=e||hv.allocUnsafe(4),e.writeInt32BE(t,r),e);Dh.bytes=4;Oh.exports=Dh});var Mh=m((x8,Lh)=>{"use strict";var Nh=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};Nh.bytes=4;Lh.exports=Nh});var Kh=m(ci=>{"use strict";ci.encode=Sh();ci.decode=Ph();ci.varintEncode=Ya();ci.varintDecode=Xa();ci.int32BEEncode=kh();ci.int32BEDecode=Mh()});var Uh=m((S8,Fh)=>{Fh.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var Vh=m((A8,Gh)=>{var qh=Uh();Gh.exports=class{constructor(e){this.hwm=e||16,this.head=new qh(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new qh(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Hh=m((B8,jh)=>{var ec=Vh();jh.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new ec,i,n,s,o=()=>{if(!r.isEmpty()){if(t.writev){let y,v=[];for(;!r.isEmpty();){if(y=r.shift(),y.error)throw y.error;v.push(y.value)}return{done:y.done,value:v}}let p=r.shift();if(p.error)throw p.error;return p}return s?{done:!0}:new Promise((p,y)=>{n=v=>(n=null,v.error?y(v.error):t.writev&&!v.done?p({done:v.done,value:[v.value]}):p(v),i)})},c=p=>n?n(p):(r.push(p),i),f=p=>(r=new ec,n?n({error:p}):(r.push({error:p}),i)),u=p=>s?i:c({done:!1,value:p}),a=p=>s?i:(s=!0,p?f(p):c({done:!0})),h=()=>(r=new ec,a(),{done:!0}),l=p=>(a(p),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:h,throw:l,push:u,end:a},!e)return i;let d=i;return i={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(p){return d.throw(p),e&&(e(p),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(p){return d.end(p),e&&(e(p),e=null),i}},i}});var Wh=m((R8,zh)=>{zh.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Yh=m((T8,$h)=>{$h.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var Zh=m((P8,ui)=>{var lv=Wh(),tc=Yh(),Qh=(t,e,r)=>rc(t,Array.isArray(e)?e:[{signal:e,options:r}]),rc=(t,e)=>{t=lv(t),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*r(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:c,options:f}of e)if(c.aborted){let{abortMessage:u,abortCode:a}=f;throw new tc(u,a)}let o=new Promise((c,f)=>{i=()=>{let{options:u}=e.find(({signal:l})=>l.aborted),{abortMessage:a,abortCode:h}=u;f(new tc(a,h))}});s=await Promise.race([o,t.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let c=e.find(({signal:u})=>u.aborted),f=o.type==="aborted"&&c;if(f&&c.options.onAbort&&await c.options.onAbort(t),typeof t.return=="function")try{let u=t.return();u instanceof Promise&&u.catch(a=>{c.options.onReturnError!=null&&c.options.onReturnError(a)})}catch(u){c.options.onReturnError!=null&&c.options.onReturnError(u)}if(f&&c.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return r()},Xh=(t,e,r)=>Jh(t,Array.isArray(e)?e:[{signal:e,options:r}]),Jh=(t,e)=>r=>t(rc(r,e)),pv=(t,e,r)=>dv(t,Array.isArray(e)?e:[{signal:e,options:r}]),dv=(t,e)=>({sink:Jh(t.sink,e),source:rc(t.source,e)});ui.exports=Qh;ui.exports.AbortError=tc;ui.exports.source=Qh;ui.exports.sink=Xh;ui.exports.transform=Xh;ui.exports.duplex=pv});var sl=m((D8,nl)=>{"use strict";var el=mn(),yv=Object.assign(el("libp2p-pubsub:peer-streams"),{error:el("libp2p-pubsub:peer-streams:err")}),{EventEmitter:gv}=ia(),tl=Kh(),bv=Hh(),{pipe:rl}=sa(),{source:vv}=Zh(),il=class extends gv{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new AbortController,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=vv(rl(this._rawInboundStream,tl.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=bv({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),rl(this.outboundStream,tl.encode(),this._rawOutboundStream).catch(i=>{yv.error(i)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};nl.exports=il});var al=m(ol=>{"use strict";var mv={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};ol.SignaturePolicy=mv});var Us=m((k8,cl)=>{"use strict";var Fs=65536;function wv(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>Fs)for(;r<t;)r+Fs>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+Fs)),r+=Fs);else crypto.getRandomValues(e);return e}cl.exports=wv});var fl=m((N8,ul)=>{"use strict";var xv=Us(),Ev=le();ul.exports=function(t){if(isNaN(t)||t<=0)throw Ev(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return xv(t)}});function _v(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var c=t.length,f=t.charAt(0),u=Math.log(c)/Math.log(256),a=Math.log(256)/Math.log(c);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,v=0,b=0,x=p.length;b!==x&&p[b]===0;)b++,y++;for(var I=(x-b)*a+1>>>0,D=new Uint8Array(I);b!==x;){for(var P=p[b],T=0,U=I-1;(P!==0||T<v)&&U!==-1;U--,T++)P+=256*D[U]>>>0,D[U]=P%c>>>0,P=P/c>>>0;if(P!==0)throw new Error("Non-zero carry");v=T,b++}for(var H=I-v;H!==I&&D[H]===0;)H++;for(var Ae=f.repeat(y);H<I;++H)Ae+=t.charAt(D[H]);return Ae}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var v=0,b=0;p[y]===f;)v++,y++;for(var x=(p.length-y)*u+1>>>0,I=new Uint8Array(x);p[y];){var D=r[p.charCodeAt(y)];if(D===255)return;for(var P=0,T=x-1;(D!==0||P<b)&&T!==-1;T--,P++)D+=c*I[T]>>>0,I[T]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");b=P,y++}if(p[y]!==" "){for(var U=x-b;U!==x&&I[U]===0;)U++;for(var H=new Uint8Array(v+(x-U)),Ae=v;U!==x;)H[Ae++]=I[U++];return H}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Sv,Iv,hl,ll=re(()=>{Sv=_v,Iv=Sv,hl=Iv});var M8,pl,fr,dl,yl,Tr=re(()=>{M8=new Uint8Array(0),pl=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},fr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},dl=t=>new TextEncoder().encode(t),yl=t=>new TextDecoder().decode(t)});var bl,vl,ml,wl,xl,qs,Pr,Av,Bv,be,Gt=re(()=>{ll();Tr();bl=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},vl=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return wl(this,e)}},ml=class{constructor(e){this.decoders=e}or(e){return wl(this,e)}decode(e){let r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},wl=(t,e)=>new ml({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),xl=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new bl(e,r,i),this.decoder=new vl(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},qs=({name:t,prefix:e,encode:r,decode:i})=>new xl(t,e,r,i),Pr=({prefix:t,name:e,alphabet:r})=>{let{encode:i,decode:n}=hl(r,e);return qs({prefix:t,name:e,encode:i,decode:s=>fr(n(s))})},Av=(t,e,r,i)=>{let n={};for(let a=0;a<e.length;++a)n[e[a]]=a;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),c=0,f=0,u=0;for(let a=0;a<s;++a){let h=n[t[a]];if(h===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|h,c+=r,c>=8&&(c-=8,o[u++]=255&f>>c)}if(c>=r||255&f<<8-c)throw new SyntaxError("Unexpected end of data");return o},Bv=(t,e,r)=>{let i=e[e.length-1]==="=",n=(1<<r)-1,s="",o=0,c=0;for(let f=0;f<t.length;++f)for(c=c<<8|t[f],o+=8;o>r;)o-=r,s+=e[n&c>>o];if(o&&(s+=e[n&c<<r-o]),i)for(;s.length*r&7;)s+="=";return s},be=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>qs({prefix:e,name:t,encode(n){return Bv(n,i,r)},decode(n){return Av(n,i,r,t)}})});var ic={};Ke(ic,{identity:()=>Rv});var Rv,El=re(()=>{Gt();Tr();Rv=qs({prefix:"\0",name:"identity",encode:t=>yl(t),decode:t=>dl(t)})});var nc={};Ke(nc,{base2:()=>Cv});var Cv,_l=re(()=>{Gt();Cv=be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var sc={};Ke(sc,{base8:()=>Tv});var Tv,Sl=re(()=>{Gt();Tv=be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var oc={};Ke(oc,{base10:()=>Pv});var Pv,Il=re(()=>{Gt();Pv=Pr({prefix:"9",name:"base10",alphabet:"0123456789"})});var Gs={};Ke(Gs,{base16:()=>Dv,base16upper:()=>Ov});var Dv,Ov,ac=re(()=>{Gt();Dv=be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ov=be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var An={};Ke(An,{base32:()=>Gi,base32hex:()=>Mv,base32hexpad:()=>Fv,base32hexpadupper:()=>Uv,base32hexupper:()=>Kv,base32pad:()=>Nv,base32padupper:()=>Lv,base32upper:()=>kv,base32z:()=>qv});var Gi,kv,Nv,Lv,Mv,Kv,Fv,Uv,qv,Bn=re(()=>{Gt();Gi=be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kv=be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Nv=be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Lv=be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Mv=be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kv=be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Fv=be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Uv=be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qv=be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Vs={};Ke(Vs,{base36:()=>Gv,base36upper:()=>Vv});var Gv,Vv,cc=re(()=>{Gt();Gv=Pr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vv=Pr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var fi={};Ke(fi,{base58btc:()=>Vt,base58flickr:()=>jv});var Vt,jv,hi=re(()=>{Gt();Vt=Pr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jv=Pr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Dr={};Ke(Dr,{base64:()=>Hv,base64pad:()=>zv,base64url:()=>Wv,base64urlpad:()=>$v});var Hv,zv,Wv,$v,li=re(()=>{Gt();Hv=be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zv=be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Wv=be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$v=be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function Bl(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Jv;)e[r++]=t&255|Al,t/=128;for(;t&Xv;)e[r++]=t&255|Al,t>>>=7;return e[r]=t|0,Bl.bytes=r-i+1,e}function uc(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw uc.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Rl)<<i:(s&Rl)*Math.pow(2,i),i+=7}while(s>=em);return uc.bytes=n-e,r}var Yv,Al,Qv,Xv,Jv,Zv,em,Rl,tm,rm,im,nm,sm,om,am,cm,um,fm,hm,lm,Rn,Cl=re(()=>{Yv=Bl,Al=128,Qv=127,Xv=~Qv,Jv=Math.pow(2,31);Zv=uc,em=128,Rl=127;tm=Math.pow(2,7),rm=Math.pow(2,14),im=Math.pow(2,21),nm=Math.pow(2,28),sm=Math.pow(2,35),om=Math.pow(2,42),am=Math.pow(2,49),cm=Math.pow(2,56),um=Math.pow(2,63),fm=function(t){return t<tm?1:t<rm?2:t<im?3:t<nm?4:t<sm?5:t<om?6:t<am?7:t<cm?8:t<um?9:10},hm={encode:Yv,decode:Zv,encodingLength:fm},lm=hm,Rn=lm});var Cn,Vi,ji,js=re(()=>{Cl();Cn=t=>[Rn.decode(t),Rn.decode.bytes],Vi=(t,e,r=0)=>(Rn.encode(t,e,r),e),ji=t=>Rn.encodingLength(t)});var Hs={};Ke(Hs,{Digest:()=>Hi,create:()=>Tn,decode:()=>fc,equals:()=>hc});var Tn,fc,hc,Hi,Pn=re(()=>{Tr();js();Tn=(t,e)=>{let r=e.byteLength,i=ji(t),n=i+ji(r),s=new Uint8Array(n+r);return Vi(t,s,0),Vi(r,s,i),s.set(e,n),new Hi(t,r,e,s)},fc=t=>{let e=fr(t),[r,i]=Cn(e),[n,s]=Cn(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new Hi(r,n,o,e)},hc=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&pl(t.bytes,e.bytes),Hi=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}});var Dn,Pl,zs=re(()=>{Pn();Dn=({name:t,code:e,encode:r})=>new Pl(t,e,r),Pl=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return Tn(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var dt={};Ke(dt,{sha256:()=>pm,sha512:()=>dm});var Ol,pm,dm,Rt=re(()=>{zs();Ol=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),pm=Dn({name:"sha2-256",code:18,encode:Ol("SHA-256")}),dm=Dn({name:"sha2-512",code:19,encode:Ol("SHA-512")})});var zi={};Ke(zi,{identity:()=>ym});var ym,On=re(()=>{zs();Tr();ym=Dn({name:"identity",code:0,encode:t=>fr(t)})});var kl=re(()=>{Tr()});var oB,aB,Nl=re(()=>{oB=new TextEncoder,aB=new TextDecoder});var Kl={};Ke(Kl,{CID:()=>Re});var Re,vm,mm,wm,kn,xm,Ll,Ml,Ws,$s,Em,_m,Sm,lc=re(()=>{js();Pn();hi();Bn();Tr();Re=class{constructor(e,r,i,n){this.code=r,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:$s,byteLength:$s,code:Ws,version:Ws,multihash:Ws,bytes:Ws,_baseCache:$s,asCID:$s})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==kn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==xm)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Re.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,i=Tn(e,r);return Re.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&hc(this.multihash,e.multihash)}toString(e){let{bytes:r,version:i,_baseCache:n}=this;switch(i){case 0:return mm(r,n,e||Vt.encoder);default:return wm(r,n,e||Gi.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return _m(/^0\.0/,Sm),!!(e&&(e[Ml]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Re)return e;if(e!=null&&e.asCID===e){let{version:r,code:i,multihash:n,bytes:s}=e;return new Re(r,i,n,s||Ll(r,i,n.bytes))}else if(e!=null&&e[Ml]===!0){let{version:r,multihash:i,code:n}=e,s=fc(i);return Re.create(r,n,s)}else return null}static create(e,r,i){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==kn)throw new Error(`Version 0 CID must use dag-pb (code: ${kn}) block encoding`);return new Re(e,r,i,i.bytes)}case 1:{let n=Ll(e,r,i.bytes);return new Re(e,r,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return Re.create(0,kn,e)}static createV1(e,r){return Re.create(1,e,r)}static decode(e){let[r,i]=Re.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Re.inspectBytes(e),i=r.size-r.multihashSize,n=fr(e.subarray(i,i+r.multihashSize));if(n.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=n.subarray(r.multihashSize-r.digestSize),o=new Hi(r.multihashCode,r.digestSize,s,n);return[r.version===0?Re.createV0(o):Re.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,i=()=>{let[h,l]=Cn(e.subarray(r));return r+=l,h},n=i(),s=kn;if(n===18?(n=0,r=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=r,c=i(),f=i(),u=r+f,a=u-o;return{version:n,codec:s,multihashCode:c,digestSize:f,multihashSize:a,size:u}}static parse(e,r){let[i,n]=vm(e,r),s=Re.decode(n);return s._baseCache.set(i,e),s}},vm=(t,e)=>{switch(t[0]){case"Q":{let r=e||Vt;return[Vt.prefix,r.decode(`${Vt.prefix}${t}`)]}case Vt.prefix:{let r=e||Vt;return[Vt.prefix,r.decode(t)]}case Gi.prefix:{let r=e||Gi;return[Gi.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},mm=(t,e,r)=>{let{prefix:i}=r;if(i!==Vt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let n=e.get(i);if(n==null){let s=r.encode(t).slice(1);return e.set(i,s),s}else return n},wm=(t,e,r)=>{let{prefix:i}=r,n=e.get(i);if(n==null){let s=r.encode(t);return e.set(i,s),s}else return n},kn=112,xm=18,Ll=(t,e,r)=>{let i=ji(t),n=i+ji(e),s=new Uint8Array(n+r.byteLength);return Vi(t,s,0),Vi(e,s,i),s.set(r,n),s},Ml=Symbol.for("@ipld/js-cid/CID"),Ws={writable:!1,configurable:!1,enumerable:!0},$s={writable:!1,enumerable:!1,configurable:!1},Em="0.0.0-dev",_m=(t,e)=>{if(t.test(Em))console.warn(e);else throw new Error(e)},Sm=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Fl=re(()=>{lc();js();Tr();zs();Pn()});var pc,gB,Ul=re(()=>{El();_l();Sl();Il();ac();Bn();cc();hi();li();Rt();On();kl();Nl();Fl();pc={...ic,...nc,...sc,...oc,...Gs,...An,...Vs,...fi,...Dr},gB={...dt,...zi}});function ql(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}var Gl,dc,Im,Ys,yc=re(()=>{Ul();Gl=ql("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),dc=ql("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Im={utf8:Gl,"utf-8":Gl,hex:pc.base16,latin1:dc,ascii:dc,binary:dc,...pc},Ys=Im});var Ue={};Ke(Ue,{toString:()=>Am});function Am(t,e="utf8"){let r=Ys[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var qe=re(()=>{yc()});var Oe={};Ke(Oe,{fromString:()=>Bm});function Bm(t,e="utf8"){let r=Ys[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var ke=re(()=>{yc()});var Xs=m((EB,jl)=>{"use strict";var pi=ni(),Qs=pi.Reader,Vl=pi.Writer,Ge=pi.util,yt=pi.roots["libp2p-crypto-keys"]||(pi.roots["libp2p-crypto-keys"]={});yt.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();yt.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Ge.newBuffer([]),t.encode=function(r,i){return i||(i=Vl.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Qs||(r=Qs.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new yt.PublicKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Ge.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Ge.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof yt.PublicKey)return r;var i=new yt.PublicKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Ge.base64.decode(r.Data,i.Data=Ge.newBuffer(Ge.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Ge.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?yt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Ge.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,pi.util.toJSONOptions)},t}();yt.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Ge.newBuffer([]),t.encode=function(r,i){return i||(i=Vl.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Qs||(r=Qs.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new yt.PrivateKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Ge.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Ge.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof yt.PrivateKey)return r;var i=new yt.PrivateKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Ge.base64.decode(r.Data,i.Data=Ge.newBuffer(Ge.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Ge.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?yt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Ge.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,pi.util.toJSONOptions)},t}();jl.exports=yt});var Q=m((_B,Hl)=>{Hl.exports={options:{usePureJavaScript:!1}}});var $l=m((SB,Wl)=>{var gc={};Wl.exports=gc;var zl={};gc.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(t instanceof Uint8Array))i=Rm(t,e);else{var n=0,s=e.length,o=e.charAt(0),c=[0];for(n=0;n<t.length;++n){for(var f=0,u=t[n];f<c.length;++f)u+=c[f]<<8,c[f]=u%s,u=u/s|0;for(;u>0;)c.push(u%s),u=u/s|0}for(n=0;t[n]===0&&n<t.length-1;++n)i+=o;for(n=c.length-1;n>=0;--n)i+=e[c[n]]}if(r){var a=new RegExp(".{1,"+r+"}","g");i=i.match(a).join(`\r
`)}return i};gc.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=zl[e];if(!r){r=zl[e]=[];for(var i=0;i<e.length;++i)r[e.charCodeAt(i)]=i}t=t.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<t.length;i++){var c=r[t.charCodeAt(i)];if(c===void 0)return;for(var f=0,u=c;f<o.length;++f)u+=o[f]*n,o[f]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var a=0;t[a]===s&&a<t.length-1;++a)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function Rm(t,e){var r=0,i=e.length,n=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,c=t.at(r);o<s.length;++o)c+=s[o]<<8,s[o]=c%i,c=c/i|0;for(;c>0;)s.push(c%i),c=c/i|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=n;for(r=s.length-1;r>=0;--r)f+=e[s[r]];return f}});var xe=m((IB,Jl)=>{var Yl=Q(),Ql=$l(),g=Jl.exports=Yl.util=Yl.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(c){return setImmediate(c)};return}if(g.setImmediate=function(c){setTimeout(c,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let c=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(a){a()})}};var o=c,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(e.push(f),e.length===1&&n.setAttribute("a",i=!i))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self=="undefined"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Nn(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=bc;function bc(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof bc||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=bc;var Cm=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Cm&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){Nn(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){Nn(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function Tm(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),i=g.isArrayBufferView(t);if(r||i){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=Tm;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(r),this.write+=i,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var n=new Uint8Array(t.data.byteLength,this.write);return n.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){Nn(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return Nn(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){Nn(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var i="",n="",s="",o=0,c=0;r>0;--r,++o)n=t.charCodeAt(o)^e.charCodeAt(o),c>=10&&(i+=s,s="",c=0),s+=String.fromCharCode(n),++c;return i+=s,i};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Or="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",kr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Xl="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",i="",n,s,o,c=0;c<t.length;)n=t.charCodeAt(c++),s=t.charCodeAt(c++),o=t.charCodeAt(c++),r+=Or.charAt(n>>2),r+=Or.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Or.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Or.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,i,n,s,o=0;o<t.length;)r=kr[t.charCodeAt(o++)-43],i=kr[t.charCodeAt(o++)-43],n=kr[t.charCodeAt(o++)-43],s=kr[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Ql.encode,decode:Ql.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,s=r;for(t.length&1&&(n=1,i[s++]=parseInt(t[0],16));n<t.length;n+=2)i[s++]=parseInt(t.substr(n,2),16);return e?s-r:i};g.binary.base64.encode=function(t,e){for(var r="",i="",n,s,o,c=0;c<t.byteLength;)n=t[c++],s=t[c++],o=t[c++],r+=Or.charAt(n>>2),r+=Or.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Or.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Or.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};g.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,s,o,c,f=0,u=r;f<t.length;)n=kr[t.charCodeAt(f++)-43],s=kr[t.charCodeAt(f++)-43],o=kr[t.charCodeAt(f++)-43],c=kr[t.charCodeAt(f++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,c!==64&&(i[u++]=(o&3)<<6|c));return e?u-r:i.subarray(0,u)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,Xl,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,Xl,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length*2));var n=new Uint16Array(i.buffer);r=r||0;for(var s=r,o=r,c=0;c<t.length;++c)n[o++]=t.charCodeAt(c),s+=2;return e?s-r:i};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};g.inflate=function(t,e,r){var i=t.inflate(g.encode64(e)).rval;return i===null?null:g.decode64(i)};var vc=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(r===null?i=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),i=t.setItem(e,r)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},mc=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},Pm=function(t,e,r,i){var n=mc(t,e);n===null&&(n={}),n[r]=i,vc(t,e,n)},Dm=function(t,e,r){var i=mc(t,e);return i!==null&&(i=r in i?i[r]:null),i},Om=function(t,e,r){var i=mc(t,e);if(i!==null&&r in i){delete i[r];var n=!0;for(var s in i){n=!1;break}n&&(i=null),vc(t,e,i)}},km=function(t,e){vc(t,e,null)},Js=function(t,e,r){var i=null;typeof r=="undefined"&&(r=["web","flash"]);var n,s=!1,o=null;for(var c in r){n=r[c];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=t.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=t.apply(this,e),s=!0)}catch(f){o=f}if(s)break}if(!s)throw o;return i};g.setItem=function(t,e,r,i,n){Js(Pm,arguments,n)};g.getItem=function(t,e,r,i){return Js(Dm,arguments,i)};g.removeItem=function(t,e,r,i){Js(Om,arguments,i)};g.clearItems=function(t,e,r){Js(km,arguments,r)};g.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),i=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var Zs=null;g.getQueryVariables=function(t){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var c=s[o].indexOf("="),f,u;c>0?(f=s[o].substring(0,c),u=s[o].substring(c+1)):(f=s[o],u=null),f in n||(n[f]=[]),!(f in Object.prototype)&&u!==null&&n[f].push(unescape(u))}return n},r;return typeof t=="undefined"?(Zs===null&&(typeof window!="undefined"&&window.location&&window.location.search?Zs=e(window.location.search.substring(1)):Zs={}),r=Zs):r=e(t),r};g.parseFragment=function(t){var e=t,r="",i=t.indexOf("?");i>0&&(e=t.substring(0,i),r=t.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=r===""?{}:g.getQueryVariables(r);return{pathString:e,queryString:r,path:n,query:s}};g.makeRequest=function(t){var e=g.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=r.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return r};g.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var i=jQuery.param(e||{});return r=r||"",t+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,i,n=0,s=[],o=0;r=e.exec(t);){i=t.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var c=r[0][1];switch(c){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+c+"?>")}}return s.push(t.substring(o)),s.join("")};g.formatNumber=function(t,e,r,i){var n=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,c=i===void 0?".":i,f=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",a=u.length>3?u.length%3:0;return f+(a?u.substr(0,a)+c:"")+u.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+c)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,i=g.createBuffer(),n=0;n<8;++n){if(!t[n]||t[n].length===0){i.fillWithByte(0,r),r=0;continue}var s=g.hexToBytes(t[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var s=g.bytesToHex(t[n]+t[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],c=e.length;!o||c!==o.end+1?r.push({start:c,end:c}):(o.end=c,o.end-o.start>r[i].end-r[i].start&&(i=r.length-1))}e.push(s)}if(r.length>0){var f=r[i];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker=="undefined")return g.cores=1,e(null,g.cores);if(typeof Blob=="undefined")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var c=Date.now(),f=c+4;Date.now()<f;);self.postMessage({st:c,et:f})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,c,f){if(c===0){var u=Math.floor(o.reduce(function(a,h){return a+h},0)/o.length);return g.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,g.cores)}n(f,function(a,h){o.push(s(f,h)),i(o,c-1,f)})}function n(o,c){for(var f=[],u=[],a=0;a<o;++a){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===o){for(var d=0;d<o;++d)f[d].terminate();c(null,u)}}),f.push(h)}for(var a=0;a<o;++a)f[a].postMessage(a)}function s(o,c){for(var f=[],u=0;u<o;++u)for(var a=c[u],h=f[u]=[],l=0;l<o;++l)if(u!==l){var d=c[l];(a.st>d.st&&a.st<d.et||d.st>a.st&&d.st<a.et)&&h.push(l)}return f.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var eo=m((AB,Zl)=>{var Ln=Q();Ln.pki=Ln.pki||{};var wc=Zl.exports=Ln.pki.oids=Ln.oids=Ln.oids||{};function R(t,e){wc[t]=e,wc[e]=t}function ee(t,e){wc[t]=e}R("1.2.840.113549.1.1.1","rsaEncryption");R("1.2.840.113549.1.1.4","md5WithRSAEncryption");R("1.2.840.113549.1.1.5","sha1WithRSAEncryption");R("1.2.840.113549.1.1.7","RSAES-OAEP");R("1.2.840.113549.1.1.8","mgf1");R("1.2.840.113549.1.1.9","pSpecified");R("1.2.840.113549.1.1.10","RSASSA-PSS");R("1.2.840.113549.1.1.11","sha256WithRSAEncryption");R("1.2.840.113549.1.1.12","sha384WithRSAEncryption");R("1.2.840.113549.1.1.13","sha512WithRSAEncryption");R("1.3.101.112","EdDSA25519");R("1.2.840.10040.4.3","dsa-with-sha1");R("1.3.14.3.2.7","desCBC");R("1.3.14.3.2.26","sha1");R("2.16.840.1.101.3.4.2.1","sha256");R("2.16.840.1.101.3.4.2.2","sha384");R("2.16.840.1.101.3.4.2.3","sha512");R("1.2.840.113549.2.5","md5");R("1.2.840.113549.1.7.1","data");R("1.2.840.113549.1.7.2","signedData");R("1.2.840.113549.1.7.3","envelopedData");R("1.2.840.113549.1.7.4","signedAndEnvelopedData");R("1.2.840.113549.1.7.5","digestedData");R("1.2.840.113549.1.7.6","encryptedData");R("1.2.840.113549.1.9.1","emailAddress");R("1.2.840.113549.1.9.2","unstructuredName");R("1.2.840.113549.1.9.3","contentType");R("1.2.840.113549.1.9.4","messageDigest");R("1.2.840.113549.1.9.5","signingTime");R("1.2.840.113549.1.9.6","counterSignature");R("1.2.840.113549.1.9.7","challengePassword");R("1.2.840.113549.1.9.8","unstructuredAddress");R("1.2.840.113549.1.9.14","extensionRequest");R("1.2.840.113549.1.9.20","friendlyName");R("1.2.840.113549.1.9.21","localKeyId");R("1.2.840.113549.1.9.22.1","x509Certificate");R("1.2.840.113549.1.12.10.1.1","keyBag");R("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");R("1.2.840.113549.1.12.10.1.3","certBag");R("1.2.840.113549.1.12.10.1.4","crlBag");R("1.2.840.113549.1.12.10.1.5","secretBag");R("1.2.840.113549.1.12.10.1.6","safeContentsBag");R("1.2.840.113549.1.5.13","pkcs5PBES2");R("1.2.840.113549.1.5.12","pkcs5PBKDF2");R("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");R("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");R("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");R("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");R("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");R("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");R("1.2.840.113549.2.7","hmacWithSHA1");R("1.2.840.113549.2.8","hmacWithSHA224");R("1.2.840.113549.2.9","hmacWithSHA256");R("1.2.840.113549.2.10","hmacWithSHA384");R("1.2.840.113549.2.11","hmacWithSHA512");R("1.2.840.113549.3.7","des-EDE3-CBC");R("2.16.840.1.101.3.4.1.2","aes128-CBC");R("2.16.840.1.101.3.4.1.22","aes192-CBC");R("2.16.840.1.101.3.4.1.42","aes256-CBC");R("2.5.4.3","commonName");R("2.5.4.5","serialName");R("2.5.4.6","countryName");R("2.5.4.7","localityName");R("2.5.4.8","stateOrProvinceName");R("2.5.4.9","streetAddress");R("2.5.4.10","organizationName");R("2.5.4.11","organizationalUnitName");R("2.5.4.13","description");R("2.5.4.15","businessCategory");R("2.5.4.17","postalCode");R("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");R("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");R("2.16.840.1.113730.1.1","nsCertType");R("2.16.840.1.113730.1.13","nsComment");ee("2.5.29.1","authorityKeyIdentifier");ee("2.5.29.2","keyAttributes");ee("2.5.29.3","certificatePolicies");ee("2.5.29.4","keyUsageRestriction");ee("2.5.29.5","policyMapping");ee("2.5.29.6","subtreesConstraint");ee("2.5.29.7","subjectAltName");ee("2.5.29.8","issuerAltName");ee("2.5.29.9","subjectDirectoryAttributes");ee("2.5.29.10","basicConstraints");ee("2.5.29.11","nameConstraints");ee("2.5.29.12","policyConstraints");ee("2.5.29.13","basicConstraints");R("2.5.29.14","subjectKeyIdentifier");R("2.5.29.15","keyUsage");ee("2.5.29.16","privateKeyUsagePeriod");R("2.5.29.17","subjectAltName");R("2.5.29.18","issuerAltName");R("2.5.29.19","basicConstraints");ee("2.5.29.20","cRLNumber");ee("2.5.29.21","cRLReason");ee("2.5.29.22","expirationDate");ee("2.5.29.23","instructionCode");ee("2.5.29.24","invalidityDate");ee("2.5.29.25","cRLDistributionPoints");ee("2.5.29.26","issuingDistributionPoint");ee("2.5.29.27","deltaCRLIndicator");ee("2.5.29.28","issuingDistributionPoint");ee("2.5.29.29","certificateIssuer");ee("2.5.29.30","nameConstraints");R("2.5.29.31","cRLDistributionPoints");R("2.5.29.32","certificatePolicies");ee("2.5.29.33","policyMappings");ee("2.5.29.34","policyConstraints");R("2.5.29.35","authorityKeyIdentifier");ee("2.5.29.36","policyConstraints");R("2.5.29.37","extKeyUsage");ee("2.5.29.46","freshestCRL");ee("2.5.29.54","inhibitAnyPolicy");R("1.3.6.1.4.1.11129.2.4.2","timestampList");R("1.3.6.1.5.5.7.1.1","authorityInfoAccess");R("1.3.6.1.5.5.7.3.1","serverAuth");R("1.3.6.1.5.5.7.3.2","clientAuth");R("1.3.6.1.5.5.7.3.3","codeSigning");R("1.3.6.1.5.5.7.3.4","emailProtection");R("1.3.6.1.5.5.7.3.8","timeStamping")});var di=m((BB,tp)=>{var pe=Q();xe();eo();var O=tp.exports=pe.asn1=pe.asn1||{};O.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};O.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};O.create=function(t,e,r,i,n){if(pe.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var c={tagClass:t,type:e,constructed:r,composed:r||pe.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(c.bitStringContents=n.bitStringContents,c.original=O.copy(c)),c};O.copy=function(t,e){var r;if(pe.util.isArray(t)){r=[];for(var i=0;i<t.length;++i)r.push(O.copy(t[i],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:O.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};O.equals=function(t,e,r){if(pe.util.isArray(t)){if(!pe.util.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!O.equals(t[i],e[i]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var n=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&O.equals(t.value,e.value);return r&&r.includeBitStringContents&&(n=n&&t.bitStringContents===e.bitStringContents),n};O.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,i=e&128;return i?r=t.getInt((e&127)<<3):r=e,r}};function Mn(t,e,r){if(r>e){var i=new Error("Too few bytes to parse DER.");throw i.available=t.length(),i.remaining=e,i.requested=r,i}}var Nm=function(t,e){var r=t.getByte();if(e--,r!==128){var i,n=r&128;if(!n)i=r;else{var s=r&127;Mn(t,e,s),i=t.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};O.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=pe.util.createBuffer(t)),to(t,t.length(),0,e)};function to(t,e,r,i){var n;Mn(t,e,2);var s=t.getByte();e--;var o=s&192,c=s&31;n=t.length();var f=Nm(t,e);if(e-=n-t.length(),f!==void 0&&f>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=f,u}f=e}var a,h,l=(s&32)==32;if(l)if(a=[],f===void 0)for(;;){if(Mn(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}n=t.length(),a.push(to(t,e,r+1,i)),e-=n-t.length()}else for(;f>0;)n=t.length(),a.push(to(t,f,r+1,i)),e-=n-t.length(),f-=n-t.length();if(a===void 0&&o===O.Class.UNIVERSAL&&c===O.Type.BITSTRING&&(h=t.bytes(f)),a===void 0&&i.decodeBitStrings&&o===O.Class.UNIVERSAL&&c===O.Type.BITSTRING&&f>1){var d=t.read,p=e,y=0;if(c===O.Type.BITSTRING&&(Mn(t,e,1),y=t.getByte(),e--),y===0)try{n=t.length();var v={verbose:i.verbose,strict:!0,decodeBitStrings:!0},b=to(t,e,r+1,v),x=n-t.length();e-=x,c==O.Type.BITSTRING&&x++;var I=b.tagClass;x===f&&(I===O.Class.UNIVERSAL||I===O.Class.CONTEXT_SPECIFIC)&&(a=[b])}catch(P){}a===void 0&&(t.read=d,e=p)}if(a===void 0){if(f===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(c===O.Type.BMPSTRING)for(a="";f>0;f-=2)Mn(t,e,2),a+=String.fromCharCode(t.getInt16()),e-=2;else a=t.getBytes(f)}var D=h===void 0?null:{bitStringContents:h};return O.create(o,c,l,a,D)}O.toDer=function(t){var e=pe.util.createBuffer(),r=t.tagClass|t.type,i=pe.util.createBuffer(),n=!1;if("bitStringContents"in t&&(n=!0,t.original&&(n=O.equals(t,t.original))),n)i.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:i.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&i.putBuffer(O.toDer(t.value[s]))}else if(t.type===O.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)i.putInt16(t.value.charCodeAt(s));else t.type===O.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?i.putBytes(t.value.substr(1)):i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),c="";do c+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(c.length|128);for(var s=c.length-1;s>=0;--s)e.putByte(c.charCodeAt(s))}return e.putBuffer(i),e};O.oidToDer=function(t){var e=t.split("."),r=pe.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,c=2;c<e.length;++c){i=!0,n=[],s=parseInt(e[c],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var f=n.length-1;f>=0;--f)r.putByte(n[f])}return r};O.derToOid=function(t){var e;typeof t=="string"&&(t=pe.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i=i<<7,r&128?i+=r&127:(e+="."+(i+r),i=0);return e};O.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),c=0;if(t.length>11){var f=t.charAt(10),u=10;f!=="+"&&f!=="-"&&(c=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,c,0),u&&(f=t.charAt(u),f==="+"||f==="-")){var a=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),l=a*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};O.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),c=parseInt(t.substr(12,2),10),f=0,u=0,a=!1;t.charAt(t.length-1)==="Z"&&(a=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);u=d*60+p,u*=6e4,l==="+"&&(u*=-1),a=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),a?(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,c,f),e.setTime(+e+u)):(e.setFullYear(r,i,n),e.setHours(s,o,c,f)),e};O.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};O.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};O.integerToDer=function(t){var e=pe.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};O.derToInteger=function(t){typeof t=="string"&&(t=pe.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};O.validate=function(t,e,r,i){var n=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&pe.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,t.value[s]&&(n=O.validate(t.value[s],e.value[o],r,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(n&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var c;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else i&&(t.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return n};var ep=/[^\\u0000-\\u00ff]/;O.prettyPrint=function(t,e,r){var i="";e=e||0,r=r||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*r;++s)n+=" ";switch(i+=n+"Tag: ",t.tagClass){case O.Class.UNIVERSAL:i+="Universal:";break;case O.Class.APPLICATION:i+="Application:";break;case O.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case O.Class.PRIVATE:i+="Private:";break}if(t.tagClass===O.Class.UNIVERSAL)switch(i+=t.type,t.type){case O.Type.NONE:i+=" (None)";break;case O.Type.BOOLEAN:i+=" (Boolean)";break;case O.Type.INTEGER:i+=" (Integer)";break;case O.Type.BITSTRING:i+=" (Bit string)";break;case O.Type.OCTETSTRING:i+=" (Octet string)";break;case O.Type.NULL:i+=" (Null)";break;case O.Type.OID:i+=" (Object Identifier)";break;case O.Type.ODESC:i+=" (Object Descriptor)";break;case O.Type.EXTERNAL:i+=" (External or Instance of)";break;case O.Type.REAL:i+=" (Real)";break;case O.Type.ENUMERATED:i+=" (Enumerated)";break;case O.Type.EMBEDDED:i+=" (Embedded PDV)";break;case O.Type.UTF8:i+=" (UTF8)";break;case O.Type.ROID:i+=" (Relative Object Identifier)";break;case O.Type.SEQUENCE:i+=" (Sequence)";break;case O.Type.SET:i+=" (Set)";break;case O.Type.PRINTABLESTRING:i+=" (Printable String)";break;case O.Type.IA5String:i+=" (IA5String (ASCII))";break;case O.Type.UTCTIME:i+=" (UTC time)";break;case O.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case O.Type.BMPSTRING:i+=" (BMP String)";break}else i+=t.type;if(i+=`
`,i+=n+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,c="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,c+=O.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(c+=","));i+=n+"Sub values: "+o+c}else{if(i+=n+"Value: ",t.type===O.Type.OID){var f=O.derToOid(t.value);i+=f,pe.pki&&pe.pki.oids&&f in pe.pki.oids&&(i+=" ("+pe.pki.oids[f]+") ")}if(t.type===O.Type.INTEGER)try{i+=O.derToInteger(t.value)}catch(a){i+="0x"+pe.util.bytesToHex(t.value)}else if(t.type===O.Type.BITSTRING){if(t.value.length>1?i+="0x"+pe.util.bytesToHex(t.value.slice(1)):i+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else t.type===O.Type.OCTETSTRING?(ep.test(t.value)||(i+="("+t.value+") "),i+="0x"+pe.util.bytesToHex(t.value)):t.type===O.Type.UTF8?i+=pe.util.decodeUtf8(t.value):t.type===O.Type.PRINTABLESTRING||t.type===O.Type.IA5String?i+=t.value:ep.test(t.value)?i+="0x"+pe.util.bytesToHex(t.value):t.value.length===0?i+="[null]":i+=t.value}return i}});var Ec=m((RB,rp)=>{var Ne=Q();xe();rp.exports=Ne.cipher=Ne.cipher||{};Ne.cipher.algorithms=Ne.cipher.algorithms||{};Ne.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ne.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ne.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ne.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ne.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ne.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ne.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ne.cipher.algorithms[t]=e};Ne.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ne.cipher.algorithms?Ne.cipher.algorithms[t]:null};var xc=Ne.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};xc.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ne.util.createBuffer(),this.output=t.output||Ne.util.createBuffer(),this.mode.start(e)};xc.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};xc.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Sc=m((CB,ip)=>{var Le=Q();xe();Le.cipher=Le.cipher||{};var V=ip.exports=Le.cipher.modes=Le.cipher.modes||{};V.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};V.ecb.prototype.start=function(t){};V.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};V.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};V.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};V.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};V.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};V.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=ro(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};V.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};V.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};V.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};V.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};V.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0};V.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=ro(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};V.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};V.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};V.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0};V.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=ro(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};V.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};V.ofb.prototype.decrypt=V.ofb.prototype.encrypt;V.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0};V.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=ro(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};V.ctr.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}io(this._inBlock)};V.ctr.prototype.decrypt=V.ctr.prototype.encrypt;V.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0,this._R=3774873600};V.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Le.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Le.util.createBuffer(t.additionalData):r=Le.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Le.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(_c(i*8)))}this._inBlock=this._j0.slice(0),io(this._inBlock),this._partialBytes=0,r=Le.util.createBuffer(r),this._aDataLength=_c(r.length()*8);var n=r.length()%this.blockSize;for(n&&r.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};V.gcm.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s<=0||r){if(r){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),io(this._inBlock)};V.gcm.prototype.decrypt=function(t,e,r){var i=t.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),io(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};V.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Le.util.createBuffer();var i=this._aDataLength.concat(_c(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};V.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=t[n/32|0]&1<<31-n%32;s&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r};V.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,i=3;i>0;--i)e[i]=t[i]>>>1|(t[i-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};V.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var i=r/8|0,n=t[i]>>>(7-r%8)*4&15,s=this._m[r][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};V.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};V.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,s=new Array(n),o=0;o<n;++o){var c=[0,0,0,0],f=o/i|0,u=(i-1-o%i)*e;c[f]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(c,t),e)}return s};V.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var c=n[s],f=n[o];n[s+o]=[c[0]^f[0],c[1]^f[1],c[2]^f[2],c[3]^f[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<r;++s){var u=n[s^i];n[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return n};function ro(t,e){if(typeof t=="string"&&(t=Le.util.createBuffer(t)),Le.util.isArray(t)&&t.length>4){var r=t;t=Le.util.createBuffer();for(var i=0;i<r.length;++i)t.putByte(r[i])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Le.util.isArray(t)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(t.getInt32());t=n}return t}function io(t){t[t.length-1]=t[t.length-1]+1&4294967295}function _c(t){return[t/4294967296|0,t&4294967295]}});var Rc=m((TB,ap)=>{var ue=Q();Ec();Sc();xe();ap.exports=ue.aes=ue.aes||{};ue.aes.startEncrypting=function(t,e,r,i){var n=no({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n};ue.aes.createEncryptionCipher=function(t,e){return no({key:t,output:null,decrypt:!1,mode:e})};ue.aes.startDecrypting=function(t,e,r,i){var n=no({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n};ue.aes.createDecryptionCipher=function(t,e){return no({key:t,output:null,decrypt:!0,mode:e})};ue.aes.Algorithm=function(t,e){Ic||sp();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return Bc(r._w,i,n,!1)},decrypt:function(i,n){return Bc(r._w,i,n,!0)}}}),r._init=!1};ue.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ue.util.createBuffer(e);else if(ue.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ue.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(!ue.util.isArray(e)){r=e,e=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(r.getInt32())}}if(!ue.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=op(e,t.decrypt&&!o),this._init=!0}};ue.aes._expandKey=function(t,e){return Ic||sp(),op(t,e)};ue.aes._updateBlock=Bc;Wi("AES-ECB",ue.cipher.modes.ecb);Wi("AES-CBC",ue.cipher.modes.cbc);Wi("AES-CFB",ue.cipher.modes.cfb);Wi("AES-OFB",ue.cipher.modes.ofb);Wi("AES-CTR",ue.cipher.modes.ctr);Wi("AES-GCM",ue.cipher.modes.gcm);function Wi(t,e){var r=function(){return new ue.aes.Algorithm(t,e)};ue.cipher.registerAlgorithm(t,r)}var Ic=!1,$i=4,Xe,Ac,np,yi,Ct;function sp(){Ic=!0,np=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Xe=new Array(256),Ac=new Array(256),yi=new Array(4),Ct=new Array(4);for(var e=0;e<4;++e)yi[e]=new Array(256),Ct[e]=new Array(256);for(var r=0,i=0,n,s,o,c,f,u,a,e=0;e<256;++e){c=i^i<<1^i<<2^i<<3^i<<4,c=c>>8^c&255^99,Xe[r]=c,Ac[c]=r,f=t[c],n=t[r],s=t[n],o=t[s],u=f<<24^c<<16^c<<8^(c^f),a=(n^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^n^o);for(var h=0;h<4;++h)yi[h][r]=u,Ct[h][c]=a,u=u<<24|u>>>8,a=a<<24|a>>>8;r===0?r=i=1:(r=n^t[t[t[n^o]]],i^=t[t[i]])}}function op(t,e){for(var r=t.slice(0),i,n=1,s=r.length,o=s+6+1,c=$i*o,f=s;f<c;++f)i=r[f-1],f%s==0?(i=Xe[i>>>16&255]<<24^Xe[i>>>8&255]<<16^Xe[i&255]<<8^Xe[i>>>24]^np[n]<<24,n++):s>6&&f%s==4&&(i=Xe[i>>>24]<<24^Xe[i>>>16&255]<<16^Xe[i>>>8&255]<<8^Xe[i&255]),r[f]=r[f-s]^i;if(e){var u,a=Ct[0],h=Ct[1],l=Ct[2],d=Ct[3],p=r.slice(0);c=r.length;for(var f=0,y=c-$i;f<c;f+=$i,y-=$i)if(f===0||f===c-$i)p[f]=r[y],p[f+1]=r[y+3],p[f+2]=r[y+2],p[f+3]=r[y+1];else for(var v=0;v<$i;++v)u=r[y+v],p[f+(3&-v)]=a[Xe[u>>>24]]^h[Xe[u>>>16&255]]^l[Xe[u>>>8&255]]^d[Xe[u&255]];r=p}return r}function Bc(t,e,r,i){var n=t.length/4-1,s,o,c,f,u;i?(s=Ct[0],o=Ct[1],c=Ct[2],f=Ct[3],u=Ac):(s=yi[0],o=yi[1],c=yi[2],f=yi[3],u=Xe);var a,h,l,d,p,y,v;a=e[0]^t[0],h=e[i?3:1]^t[1],l=e[2]^t[2],d=e[i?1:3]^t[3];for(var b=3,x=1;x<n;++x)p=s[a>>>24]^o[h>>>16&255]^c[l>>>8&255]^f[d&255]^t[++b],y=s[h>>>24]^o[l>>>16&255]^c[d>>>8&255]^f[a&255]^t[++b],v=s[l>>>24]^o[d>>>16&255]^c[a>>>8&255]^f[h&255]^t[++b],d=s[d>>>24]^o[a>>>16&255]^c[h>>>8&255]^f[l&255]^t[++b],a=p,h=y,l=v;r[0]=u[a>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^t[++b],r[i?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[a&255]^t[++b],r[2]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[a>>>8&255]<<8^u[h&255]^t[++b],r[i?1:3]=u[d>>>24]<<24^u[a>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^t[++b]}function no(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,i;t.decrypt?i=ue.cipher.createDecipher(r,t.key):i=ue.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var c=null;o instanceof ue.util.ByteBuffer&&(c=o,o={}),o=o||{},o.output=c,o.iv=s,n.call(i,o)},i}});var fp=m((PB,up)=>{var de=Q();Ec();Sc();xe();up.exports=de.des=de.des||{};de.des.startEncrypting=function(t,e,r,i){var n=so({key:t,output:r,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};de.des.createEncryptionCipher=function(t,e){return so({key:t,output:null,decrypt:!1,mode:e})};de.des.startDecrypting=function(t,e,r,i){var n=so({key:t,output:r,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};de.des.createDecryptionCipher=function(t,e){return so({key:t,output:null,decrypt:!0,mode:e})};de.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return cp(r._keys,i,n,!1)},decrypt:function(i,n){return cp(r._keys,i,n,!0)}}}),r._init=!1};de.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=de.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=jm(e),this._init=!0}};jt("DES-ECB",de.cipher.modes.ecb);jt("DES-CBC",de.cipher.modes.cbc);jt("DES-CFB",de.cipher.modes.cfb);jt("DES-OFB",de.cipher.modes.ofb);jt("DES-CTR",de.cipher.modes.ctr);jt("3DES-ECB",de.cipher.modes.ecb);jt("3DES-CBC",de.cipher.modes.cbc);jt("3DES-CFB",de.cipher.modes.cfb);jt("3DES-OFB",de.cipher.modes.ofb);jt("3DES-CTR",de.cipher.modes.ctr);function jt(t,e){var r=function(){return new de.des.Algorithm(t,e)};de.cipher.registerAlgorithm(t,r)}var Lm=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Mm=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Km=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Fm=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Um=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],qm=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Gm=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Vm=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function jm(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],a=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,v=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],x=0,I,D=0;D<y;D++){var P=t.getInt32(),T=t.getInt32();I=(P>>>4^T)&252645135,T^=I,P^=I<<4,I=(T>>>-16^P)&65535,P^=I,T^=I<<-16,I=(P>>>2^T)&858993459,T^=I,P^=I<<2,I=(T>>>-16^P)&65535,P^=I,T^=I<<-16,I=(P>>>1^T)&1431655765,T^=I,P^=I<<1,I=(T>>>8^P)&16711935,P^=I,T^=I<<8,I=(P>>>1^T)&1431655765,T^=I,P^=I<<1,I=P<<8|T>>>20&240,P=T<<24|T<<8&16711680|T>>>8&65280|T>>>24&240,T=I;for(var U=0;U<b.length;++U){b[U]?(P=P<<2|P>>>26,T=T<<2|T>>>26):(P=P<<1|P>>>27,T=T<<1|T>>>27),P&=-15,T&=-15;var H=e[P>>>28]|r[P>>>24&15]|i[P>>>20&15]|n[P>>>16&15]|s[P>>>12&15]|o[P>>>8&15]|c[P>>>4&15],Ae=f[T>>>28]|u[T>>>24&15]|a[T>>>20&15]|h[T>>>16&15]|l[T>>>12&15]|d[T>>>8&15]|p[T>>>4&15];I=(Ae>>>16^H)&65535,v[x++]=H^I,v[x++]=Ae^I<<16}}return v}function cp(t,e,r,i){var n=t.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,c=e[0],f=e[1];o=(c>>>4^f)&252645135,f^=o,c^=o<<4,o=(c>>>16^f)&65535,f^=o,c^=o<<16,o=(f>>>2^c)&858993459,c^=o,f^=o<<2,o=(f>>>8^c)&16711935,c^=o,f^=o<<8,o=(c>>>1^f)&1431655765,f^=o,c^=o<<1,c=c<<1|c>>>31,f=f<<1|f>>>31;for(var u=0;u<n;u+=3){for(var a=s[u+1],h=s[u+2],l=s[u];l!=a;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];o=c,c=f,f=o^(Mm[d>>>24&63]|Fm[d>>>16&63]|qm[d>>>8&63]|Vm[d&63]|Lm[p>>>24&63]|Km[p>>>16&63]|Um[p>>>8&63]|Gm[p&63])}o=c,c=f,f=o}c=c>>>1|c<<31,f=f>>>1|f<<31,o=(c>>>1^f)&1431655765,f^=o,c^=o<<1,o=(f>>>8^c)&16711935,c^=o,f^=o<<8,o=(f>>>2^c)&858993459,c^=o,f^=o<<2,o=(c>>>16^f)&65535,f^=o,c^=o<<16,o=(c>>>4^f)&252645135,f^=o,c^=o<<4,r[0]=c,r[1]=f}function so(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,i;t.decrypt?i=de.cipher.createDecipher(r,t.key):i=de.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var c=null;o instanceof de.util.ByteBuffer&&(c=o,o={}),o=o||{},o.output=c,o.iv=s,n.call(i,o)},i}});var gi=m((DB,hp)=>{var oo=Q();hp.exports=oo.md=oo.md||{};oo.md.algorithms=oo.md.algorithms||{}});var pp=m((OB,lp)=>{var hr=Q();gi();xe();var Hm=lp.exports=hr.hmac=hr.hmac||{};Hm.create=function(){var t=null,e=null,r=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in hr.md.algorithms)e=hr.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=hr.util.createBuffer(o);else if(hr.util.isArray(o)){var c=o;o=hr.util.createBuffer();for(var f=0;f<c.length;++f)o.putByte(c[f])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=hr.util.createBuffer(),i=hr.util.createBuffer(),u=o.length();for(var f=0;f<u;++f){var c=o.at(f);r.putByte(54^c),i.putByte(92^c)}if(u<e.blockLength)for(var c=e.blockLength-u,f=0;f<c;++f)r.putByte(54),i.putByte(92);t=o,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var Yi=m(()=>{});var yp=m((LB,dp)=>{var Je=Q();pp();gi();xe();var zm=Je.pkcs5=Je.pkcs5||{},lr;Je.util.isNodejs&&!Je.options.usePureJavaScript&&(lr=Yi());dp.exports=Je.pbkdf2=zm.pbkdf2=function(t,e,r,i,n,s){if(typeof n=="function"&&(s=n,n=null),Je.util.isNodejs&&!Je.options.usePureJavaScript&&lr.pbkdf2&&(n===null||typeof n!="object")&&(lr.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?lr.pbkdf2Sync.length===4?lr.pbkdf2(t,e,r,i,function(I,D){if(I)return s(I);s(null,D.toString("binary"))}):lr.pbkdf2(t,e,r,i,n,function(I,D){if(I)return s(I);s(null,D.toString("binary"))}):lr.pbkdf2Sync.length===4?lr.pbkdf2Sync(t,e,r,i).toString("binary"):lr.pbkdf2Sync(t,e,r,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Je.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Je.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var c=new Error("Derived key is too long.");if(s)return s(c);throw c}var f=Math.ceil(i/o),u=i-(f-1)*o,a=Je.hmac.create();a.start(n,t);var h="",l,d,p;if(!s){for(var y=1;y<=f;++y){a.start(null,null),a.update(e),a.update(Je.util.int32ToBytes(y)),l=p=a.digest().getBytes();for(var v=2;v<=r;++v)a.start(null,null),a.update(p),d=a.digest().getBytes(),l=Je.util.xorBytes(l,d,o),p=d;h+=y<f?l:l.substr(0,u)}return h}var y=1,v;function b(){if(y>f)return s(null,h);a.start(null,null),a.update(e),a.update(Je.util.int32ToBytes(y)),l=p=a.digest().getBytes(),v=2,x()}function x(){if(v<=r)return a.start(null,null),a.update(p),d=a.digest().getBytes(),l=Je.util.xorBytes(l,d,o),p=d,++v,Je.util.setImmediate(x);h+=y<f?l:l.substr(0,u),++y,b()}b()}});var vp=m((MB,bp)=>{var ao=Q();xe();var gp=bp.exports=ao.pem=ao.pem||{};gp.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,i;if(t.procType&&(i={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=co(i)),t.contentDomain&&(i={name:"Content-Domain",values:[t.contentDomain]},r+=co(i)),t.dekInfo&&(i={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&i.values.push(t.dekInfo.parameters),r+=co(i)),t.headers)for(var n=0;n<t.headers.length;++n)r+=co(t.headers[n]);return t.procType&&(r+=`\r
`),r+=ao.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};gp.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:ao.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var c=s[2].split(n),f=0;s&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),a=f+1;a<c.length;++a){var h=c[a];if(!/\s/.test(h[0]))break;u+=h,f=a}if(s=u.match(i),s){for(var l={name:s[1],values:[]},d=s[2].split(","),p=0;p<d.length;++p)l.values.push(Wm(d[p]));if(o.procType)if(!o.contentDomain&&l.name==="Content-Domain")o.contentDomain=d[0]||"";else if(!o.dekInfo&&l.name==="DEK-Info"){if(l.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else o.headers.push(l);else{if(l.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(l.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:d[0],type:d[1]}}}++f}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function co(t){for(var e=t.name+": ",r=[],i=function(f,u){return" "+u},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var c=e[o];c===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+c+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function Wm(t){return t.replace(/^\s+/,"")}});var Sp=m((KB,_p)=>{var Ht=Q();gi();xe();var mp=_p.exports=Ht.sha256=Ht.sha256||{};Ht.md.sha256=Ht.md.algorithms.sha256=mp;mp.create=function(){wp||$m();var t=null,e=Ht.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Ht.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Ht.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=o[1],o[1]=o[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),Ep(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Ht.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(Cc.substr(0,i.blockLength-o));for(var c,f,u=i.fullMessageLength[0]*8,a=0;a<i.fullMessageLength.length-1;++a)c=i.fullMessageLength[a+1]*8,f=c/4294967296>>>0,u+=f,n.putInt32(u>>>0),u=c>>>0;n.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ep(h,r,n);var l=Ht.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},i};var Cc=null,wp=!1,xp=null;function $m(){Cc=String.fromCharCode(128),Cc+=Ht.util.fillString(String.fromCharCode(0),64),xp=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],wp=!0}function Ep(t,e,r){for(var i,n,s,o,c,f,u,a,h,l,d,p,y,v,b,x=r.length();x>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(a=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,y=t.h5,v=t.h6,b=t.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),c=v^p&(y^v),s=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),f=a&h|l&(a^h),i=b+o+c+xp[u]+e[u],n=s+f,b=v,v=y,y=p,p=d+i>>>0,d=l,l=h,h=a,a=i+n>>>0;t.h0=t.h0+a|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+y|0,t.h6=t.h6+v|0,t.h7=t.h7+b|0,x-=64}}});var Ap=m((FB,Ip)=>{var zt=Q();xe();var uo=null;zt.util.isNodejs&&!zt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(uo=Yi());var Ym=Ip.exports=zt.prng=zt.prng||{};Ym.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();e.pools=i,e.pool=0,e.generate=function(u,a){if(!a)return e.generateSync(u);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,y=zt.util.createBuffer();e.key=null,v();function v(b){if(b)return a(b);if(y.length()>=u)return a(null,y.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return zt.util.nextTick(function(){s(v)});var x=h(e.key,e.seed);e.generated+=x.length,y.putBytes(x),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),zt.util.setImmediate(v)}},e.generateSync=function(u){var a=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=zt.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var y=a(e.key,e.seed);e.generated+=y.length,p.putBytes(y),e.key=l(a(e.key,h(e.seed))),e.seed=d(a(e.key,e.seed))}return p.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return c(),u();var a=32-e.pools[0].messageLength<<5;e.seedFile(a,function(h,l){if(h)return u(h);e.collect(l),c(),u()})}function o(){if(e.pools[0].messageLength>=32)return c();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),c()}function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var a=1,h=0;h<32;++h)e.reseeds%a==0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),a=a<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var l=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(u){var a=null,h=zt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(a=function(P){return l.getRandomValues(P)});var d=zt.util.createBuffer();if(a)for(;d.length()<u;){var p=Math.max(1,Math.min(u-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{a(y);for(var v=0;v<y.length;++v)d.putInt32(y[v])}catch(P){if(!(typeof QuotaExceededError!="undefined"&&P instanceof QuotaExceededError))throw P}}if(d.length()<u)for(var b,x,I,D=Math.floor(Math.random()*65536);d.length()<u;){x=16807*(D&65535),b=16807*(D>>16),x+=(b&32767)<<16,x+=b>>15,x=(x&2147483647)+(x>>31),D=x&4294967295;for(var v=0;v<3;++v)I=D>>>(v<<3),I^=Math.floor(Math.random()*256),d.putByte(String.fromCharCode(I&255))}return d.getBytes(u)}return uo?(e.seedFile=function(u,a){uo.randomBytes(u,function(h,l){if(h)return a(h);a(null,l.toString())})},e.seedFileSync=function(u){return uo.randomBytes(u).toString()}):(e.seedFile=function(u,a){try{a(null,f(u))}catch(h){a(h)}},e.seedFileSync=f),e.collect=function(u){for(var a=u.length,h=0;h<a;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,a){for(var h="",l=0;l<a;l+=8)h+=String.fromCharCode(u>>l&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var a=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){u.postMessage({forge:{prng:{err:d,bytes:p}}})})};u.addEventListener("message",a)}},e}});var Kn=m((UB,Tc)=>{var Me=Q();Rc();Sp();Ap();xe();(function(){if(Me.random&&Me.random.getBytes){Tc.exports=Me.random;return}(function(t){var e={},r=new Array(4),i=Me.util.createBuffer();e.formatKey=function(h){var l=Me.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Me.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Me.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Me.aes._updateBlock(h,l,r,!1),i.putInt32(r[0]),i.putInt32(r[1]),i.putInt32(r[2]),i.putInt32(r[3]),i.getBytes()},e.increment=function(h){return++h[3],h},e.md=Me.md.sha256;function n(){var h=Me.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=n(),o=null,c=Me.util.globalScope,f=c.crypto||c.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),Me.options.usePureJavaScript||!Me.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var a in navigator)try{typeof navigator[a]=="string"&&(u+=navigator[a])}catch(h){}s.collect(u),u=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Me.random)Me.random=s;else for(var a in s)Me.random[a]=s[a];Me.random.createInstance=n,Tc.exports=Me.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Tp=m((qB,Cp)=>{var nt=Q();xe();var Pc=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Bp=[1,2,3,5],Qm=function(t,e){return t<<e&65535|(t&65535)>>16-e},Xm=function(t,e){return(t&65535)>>e|t<<16-e&65535};Cp.exports=nt.rc2=nt.rc2||{};nt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=nt.util.createBuffer(t)),e=e||128;var r=t,i=t.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),c;for(c=i;c<128;c++)r.putByte(Pc[r.at(c-1)+r.at(c-i)&255]);for(r.setAt(128-s,Pc[r.at(128-s)&o]),c=127-s;c>=0;c--)r.setAt(c,Pc[r.at(c+1)^r.at(c+s)]);return r};var Rp=function(t,e,r){var i=!1,n=null,s=null,o=null,c,f,u,a,h=[];for(t=nt.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(c=function(p){for(u=0;u<4;u++)p[u]+=h[a]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=Qm(p[u],Bp[u]),a++},f=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(c=function(p){for(u=3;u>=0;u--)p[u]=Xm(p[u],Bp[u]),p[u]-=h[a]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),a--},f=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var y=[];for(u=0;u<4;u++){var v=n.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),y.push(v&65535)}a=r?0:63;for(var b=0;b<p.length;b++)for(var x=0;x<p[b][0];x++)p[b][1](y);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(y[u]):y[u]^=o.getInt16Le()),s.putInt16Le(y[u])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=nt.util.createBuffer(p)),i=!1,n=nt.util.createBuffer(),s=y||new nt.util.createBuffer,o=p,d.output=s},update:function(p){for(i||n.putBuffer(p);n.length()>=8;)l([[5,c],[1,f],[6,c],[1,f],[5,c]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,n,!r);else{var v=n.length()===8?8:8-n.length();n.fillWithByte(v,v)}if(y&&(i=!0,d.update()),!r&&(y=n.length()===0,y))if(p)y=p(8,s,!r);else{var b=s.length(),x=s.at(b-1);x>b?y=!1:s.truncate(x)}return y}},d};nt.rc2.startEncrypting=function(t,e,r){var i=nt.rc2.createEncryptionCipher(t,128);return i.start(e,r),i};nt.rc2.createEncryptionCipher=function(t,e){return Rp(t,e,!0)};nt.rc2.startDecrypting=function(t,e,r){var i=nt.rc2.createDecryptionCipher(t,128);return i.start(e,r),i};nt.rc2.createDecryptionCipher=function(t,e){return Rp(t,e,!1)}});var Un=m((GB,Kp)=>{var Dc=Q();Kp.exports=Dc.jsbn=Dc.jsbn||{};var pr,Jm=244837814094590,Pp=(Jm&16777215)==15715070;function A(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Dc.jsbn.BigInteger=A;function X(){return new A(null)}function Zm(t,e,r,i,n,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[i]+n;n=Math.floor(o/67108864),r.data[i++]=o&67108863}return n}function ew(t,e,r,i,n,s){for(var o=e&32767,c=e>>15;--s>=0;){var f=this.data[t]&32767,u=this.data[t++]>>15,a=c*f+u*o;f=o*f+((a&32767)<<15)+r.data[i]+(n&1073741823),n=(f>>>30)+(a>>>15)+c*u+(n>>>30),r.data[i++]=f&1073741823}return n}function Dp(t,e,r,i,n,s){for(var o=e&16383,c=e>>14;--s>=0;){var f=this.data[t]&16383,u=this.data[t++]>>14,a=c*f+u*o;f=o*f+((a&16383)<<14)+r.data[i]+n,n=(f>>28)+(a>>14)+c*u,r.data[i++]=f&268435455}return n}typeof navigator=="undefined"?(A.prototype.am=Dp,pr=28):Pp&&navigator.appName=="Microsoft Internet Explorer"?(A.prototype.am=ew,pr=30):Pp&&navigator.appName!="Netscape"?(A.prototype.am=Zm,pr=26):(A.prototype.am=Dp,pr=28);A.prototype.DB=pr;A.prototype.DM=(1<<pr)-1;A.prototype.DV=1<<pr;var Oc=52;A.prototype.FV=Math.pow(2,Oc);A.prototype.F1=Oc-pr;A.prototype.F2=2*pr-Oc;var tw="0123456789abcdefghijklmnopqrstuvwxyz",fo=new Array,Qi,gt;Qi="0".charCodeAt(0);for(gt=0;gt<=9;++gt)fo[Qi++]=gt;Qi="a".charCodeAt(0);for(gt=10;gt<36;++gt)fo[Qi++]=gt;Qi="A".charCodeAt(0);for(gt=10;gt<36;++gt)fo[Qi++]=gt;function Op(t){return tw.charAt(t)}function kp(t,e){var r=fo[t.charCodeAt(e)];return r??-1}function rw(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function iw(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Nr(t){var e=X();return e.fromInt(t),e}function nw(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var o=r==8?t[i]&255:kp(t,i);if(o<0){t.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&A.ZERO.subTo(this,this)}function sw(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function ow(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,i,n=!1,s="",o=this.t,c=this.DB-o*this.DB%e;if(o-- >0)for(c<this.DB&&(i=this.data[o]>>c)>0&&(n=!0,s=Op(i));o>=0;)c<e?(i=(this.data[o]&(1<<c)-1)<<e-c,i|=this.data[--o]>>(c+=this.DB-e)):(i=this.data[o]>>(c-=e)&r,c<=0&&(c+=this.DB,--o)),i>0&&(n=!0),n&&(s+=Op(i));return n?s:"0"}function aw(){var t=X();return A.ZERO.subTo(this,t),t}function cw(){return this.s<0?this.negate():this}function uw(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function ho(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function fw(){return this.t<=0?0:this.DB*(this.t-1)+ho(this.data[this.t-1]^this.s&this.DM)}function hw(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function lw(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function pw(t,e){var r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+s+1]=this.data[c]>>i|o,o=(this.data[c]&n)<<r;for(c=s-1;c>=0;--c)e.data[c]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function dw(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<n,e.data[o-r]=this.data[o]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function yw(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function gw(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&A.ZERO.subTo(e,e)}function bw(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function vw(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=X());var s=X(),o=this.s,c=t.s,f=this.DB-ho(i.data[i.t-1]);f>0?(i.lShiftTo(f,s),n.lShiftTo(f,r)):(i.copyTo(s),n.copyTo(r));var u=s.t,a=s.data[u-1];if(a!=0){var h=a*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,v=y-u,b=e??X();for(s.dlShiftTo(v,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),A.ONE.dlShiftTo(u,b),b.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--v>=0;){var x=r.data[--y]==a?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,x,r,v,0,u))<x)for(s.dlShiftTo(v,b),r.subTo(b,r);r.data[y]<--x;)r.subTo(b,r)}e!=null&&(r.drShiftTo(u,e),o!=c&&A.ZERO.subTo(e,e)),r.t=u,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&A.ZERO.subTo(r,r)}}}function mw(t){var e=X();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(A.ZERO)>0&&t.subTo(e,e),e}function bi(t){this.m=t}function ww(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function xw(t){return t}function Ew(t){t.divRemTo(this.m,null,t)}function _w(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Sw(t,e){t.squareTo(e),this.reduce(e)}bi.prototype.convert=ww;bi.prototype.revert=xw;bi.prototype.reduce=Ew;bi.prototype.mulTo=_w;bi.prototype.sqrTo=Sw;function Iw(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function vi(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Aw(t){var e=X();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(A.ZERO)>0&&this.m.subTo(e,e),e}function Bw(t){var e=X();return t.copyTo(e),this.reduce(e),e}function Rw(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Cw(t,e){t.squareTo(e),this.reduce(e)}function Tw(t,e,r){t.multiplyTo(e,r),this.reduce(r)}vi.prototype.convert=Aw;vi.prototype.revert=Bw;vi.prototype.reduce=Rw;vi.prototype.mulTo=Tw;vi.prototype.sqrTo=Cw;function Pw(){return(this.t>0?this.data[0]&1:this.s)==0}function Dw(t,e){if(t>4294967295||t<1)return A.ONE;var r=X(),i=X(),n=e.convert(this),s=ho(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var o=r;r=i,i=o}return e.revert(r)}function Ow(t,e){var r;return t<256||e.isEven()?r=new bi(e):r=new vi(e),this.exp(t,r)}A.prototype.copyTo=rw;A.prototype.fromInt=iw;A.prototype.fromString=nw;A.prototype.clamp=sw;A.prototype.dlShiftTo=hw;A.prototype.drShiftTo=lw;A.prototype.lShiftTo=pw;A.prototype.rShiftTo=dw;A.prototype.subTo=yw;A.prototype.multiplyTo=gw;A.prototype.squareTo=bw;A.prototype.divRemTo=vw;A.prototype.invDigit=Iw;A.prototype.isEven=Pw;A.prototype.exp=Dw;A.prototype.toString=ow;A.prototype.negate=aw;A.prototype.abs=cw;A.prototype.compareTo=uw;A.prototype.bitLength=fw;A.prototype.mod=mw;A.prototype.modPowInt=Ow;A.ZERO=Nr(0);A.ONE=Nr(1);function kw(){var t=X();return this.copyTo(t),t}function Nw(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Lw(){return this.t==0?this.s:this.data[0]<<24>>24}function Mw(){return this.t==0?this.s:this.data[0]<<16>>16}function Kw(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Fw(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Uw(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=Nr(r),n=X(),s=X(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(t)+o}function qw(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,o=0,c=0;c<t.length;++c){var f=kp(t,c);if(f<0){t.charAt(c)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+f,++s>=r&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&A.ZERO.subTo(this,this)}function Gw(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(A.ONE.shiftLeft(t-1),kc,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(A.ONE.shiftLeft(t-1),this);else{var i=new Array,n=t&7;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function Vw(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,i,n=0;if(t-- >0)for(r<this.DB&&(i=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this.data[t]&(1<<r)-1)<<8-r,i|=this.data[--t]>>(r+=this.DB-8)):(i=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function jw(t){return this.compareTo(t)==0}function Hw(t){return this.compareTo(t)<0?this:t}function zw(t){return this.compareTo(t)>0?this:t}function Ww(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function $w(t,e){return t&e}function Yw(t){var e=X();return this.bitwiseTo(t,$w,e),e}function kc(t,e){return t|e}function Qw(t){var e=X();return this.bitwiseTo(t,kc,e),e}function Np(t,e){return t^e}function Xw(t){var e=X();return this.bitwiseTo(t,Np,e),e}function Lp(t,e){return t&~e}function Jw(t){var e=X();return this.bitwiseTo(t,Lp,e),e}function Zw(){for(var t=X(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function ex(t){var e=X();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function tx(t){var e=X();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function rx(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function ix(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+rx(this.data[t]);return this.s<0?this.t*this.DB:-1}function nx(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function sx(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=nx(this.data[r]^e);return t}function ox(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function ax(t,e){var r=A.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function cx(t){return this.changeBit(t,kc)}function ux(t){return this.changeBit(t,Lp)}function fx(t){return this.changeBit(t,Np)}function hx(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function lx(t){var e=X();return this.addTo(t,e),e}function px(t){var e=X();return this.subTo(t,e),e}function dx(t){var e=X();return this.multiplyTo(t,e),e}function yx(t){var e=X();return this.divRemTo(t,e,null),e}function gx(t){var e=X();return this.divRemTo(t,null,e),e}function bx(t){var e=X(),r=X();return this.divRemTo(t,e,r),new Array(e,r)}function vx(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function mx(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Fn(){}function Mp(t){return t}function wx(t,e,r){t.multiplyTo(e,r)}function xx(t,e){t.squareTo(e)}Fn.prototype.convert=Mp;Fn.prototype.revert=Mp;Fn.prototype.mulTo=wx;Fn.prototype.sqrTo=xx;function Ex(t){return this.exp(t,new Fn)}function _x(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function Sx(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function Xi(t){this.r2=X(),this.q3=X(),A.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Ix(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=X();return t.copyTo(e),this.reduce(e),e}function Ax(t){return t}function Bx(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Rx(t,e){t.squareTo(e),this.reduce(e)}function Cx(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Xi.prototype.convert=Ix;Xi.prototype.revert=Ax;Xi.prototype.reduce=Bx;Xi.prototype.mulTo=Cx;Xi.prototype.sqrTo=Rx;function Tx(t,e){var r=t.bitLength(),i,n=Nr(1),s;if(r<=0)return n;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?s=new bi(e):e.isEven()?s=new Xi(e):s=new vi(e);var o=new Array,c=3,f=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var a=X();for(s.sqrTo(o[1],a);c<=u;)o[c]=X(),s.mulTo(a,o[c-2],o[c]),c+=2}var h=t.t-1,l,d=!0,p=X(),y;for(r=ho(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&u:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),c=i;(l&1)==0;)l>>=1,--c;if((r-=c)<0&&(r+=this.DB,--h),d)o[l].copyTo(n),d=!1;else{for(;c>1;)s.sqrTo(n,p),s.sqrTo(p,n),c-=2;c>0?s.sqrTo(n,p):(y=n,n=p,p=y),s.mulTo(p,o[l],n)}for(;h>=0&&(t.data[h]&1<<r)==0;)s.sqrTo(n,p),y=n,n=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(n)}function Px(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Dx(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function Ox(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return A.ZERO;for(var r=t.clone(),i=this.clone(),n=Nr(1),s=Nr(0),o=Nr(0),c=Nr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!c.isEven())&&(o.addTo(this,o),c.subTo(t,c)),o.rShiftTo(1,o)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(o,n),s.subTo(c,s)):(i.subTo(r,i),e&&o.subTo(n,o),c.subTo(s,c))}if(i.compareTo(A.ONE)!=0)return A.ZERO;if(c.compareTo(t)>=0)return c.subtract(t);if(c.signum()<0)c.addTo(t,c);else return c;return c.signum()<0?c.add(t):c}var Tt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],kx=(1<<26)/Tt[Tt.length-1];function Nx(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Tt[Tt.length-1]){for(e=0;e<Tt.length;++e)if(r.data[0]==Tt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Tt.length;){for(var i=Tt[e],n=e+1;n<Tt.length&&i<kx;)i*=Tt[n++];for(i=r.modInt(i);e<n;)if(i%Tt[e++]==0)return!1}return r.millerRabin(t)}function Lx(t){var e=this.subtract(A.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i=e.shiftRight(r),n=Mx(),s,o=0;o<t;++o){do s=new A(this.bitLength(),n);while(s.compareTo(A.ONE)<=0||s.compareTo(e)>=0);var c=s.modPow(i,this);if(c.compareTo(A.ONE)!=0&&c.compareTo(e)!=0){for(var f=1;f++<r&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(A.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}function Mx(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}A.prototype.chunkSize=Kw;A.prototype.toRadix=Uw;A.prototype.fromRadix=qw;A.prototype.fromNumber=Gw;A.prototype.bitwiseTo=Ww;A.prototype.changeBit=ax;A.prototype.addTo=hx;A.prototype.dMultiply=vx;A.prototype.dAddOffset=mx;A.prototype.multiplyLowerTo=_x;A.prototype.multiplyUpperTo=Sx;A.prototype.modInt=Dx;A.prototype.millerRabin=Lx;A.prototype.clone=kw;A.prototype.intValue=Nw;A.prototype.byteValue=Lw;A.prototype.shortValue=Mw;A.prototype.signum=Fw;A.prototype.toByteArray=Vw;A.prototype.equals=jw;A.prototype.min=Hw;A.prototype.max=zw;A.prototype.and=Yw;A.prototype.or=Qw;A.prototype.xor=Xw;A.prototype.andNot=Jw;A.prototype.not=Zw;A.prototype.shiftLeft=ex;A.prototype.shiftRight=tx;A.prototype.getLowestSetBit=ix;A.prototype.bitCount=sx;A.prototype.testBit=ox;A.prototype.setBit=cx;A.prototype.clearBit=ux;A.prototype.flipBit=fx;A.prototype.add=lx;A.prototype.subtract=px;A.prototype.multiply=dx;A.prototype.divide=yx;A.prototype.remainder=gx;A.prototype.divideAndRemainder=bx;A.prototype.modPow=Tx;A.prototype.modInverse=Ox;A.prototype.pow=Ex;A.prototype.gcd=Px;A.prototype.isProbablePrime=Nx});var Vp=m((VB,Gp)=>{var Wt=Q();gi();xe();var Fp=Gp.exports=Wt.sha1=Wt.sha1||{};Wt.md.sha1=Wt.md.algorithms.sha1=Fp;Fp.create=function(){Up||Kx();var t=null,e=Wt.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Wt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Wt.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=o[1],o[1]=o[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),qp(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Wt.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(Nc.substr(0,i.blockLength-o));for(var c,f,u=i.fullMessageLength[0]*8,a=0;a<i.fullMessageLength.length-1;++a)c=i.fullMessageLength[a+1]*8,f=c/4294967296>>>0,u+=f,n.putInt32(u>>>0),u=c>>>0;n.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};qp(h,r,n);var l=Wt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},i};var Nc=null,Up=!1;function Kx(){Nc=String.fromCharCode(128),Nc+=Wt.util.fillString(String.fromCharCode(0),64),Up=!0}function qp(t,e,r){for(var i,n,s,o,c,f,u,a,h=r.length();h>=64;){for(n=t.h0,s=t.h1,o=t.h2,c=t.h3,f=t.h4,a=0;a<16;++a)i=r.getInt32(),e[a]=i,u=c^s&(o^c),i=(n<<5|n>>>27)+u+f+1518500249+i,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;a<20;++a)i=e[a-3]^e[a-8]^e[a-14]^e[a-16],i=i<<1|i>>>31,e[a]=i,u=c^s&(o^c),i=(n<<5|n>>>27)+u+f+1518500249+i,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;a<32;++a)i=e[a-3]^e[a-8]^e[a-14]^e[a-16],i=i<<1|i>>>31,e[a]=i,u=s^o^c,i=(n<<5|n>>>27)+u+f+1859775393+i,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;a<40;++a)i=e[a-6]^e[a-16]^e[a-28]^e[a-32],i=i<<2|i>>>30,e[a]=i,u=s^o^c,i=(n<<5|n>>>27)+u+f+1859775393+i,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;a<60;++a)i=e[a-6]^e[a-16]^e[a-28]^e[a-32],i=i<<2|i>>>30,e[a]=i,u=s&o|c&(s^o),i=(n<<5|n>>>27)+u+f+2400959708+i,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;a<80;++a)i=e[a-6]^e[a-16]^e[a-28]^e[a-32],i=i<<2|i>>>30,e[a]=i,u=s^o^c,i=(n<<5|n>>>27)+u+f+3395469782+i,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+c|0,t.h4=t.h4+f|0,h-=64}}});var zp=m((jB,Hp)=>{var $t=Q();xe();Kn();Vp();var jp=Hp.exports=$t.pkcs1=$t.pkcs1||{};jp.encode_rsa_oaep=function(t,e,r){var i,n,s,o;typeof r=="string"?(i=r,n=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,n=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=$t.md.sha1.create(),o||(o=s);var c=Math.ceil(t.n.bitLength()/8),f=c-2*s.digestLength-2;if(e.length>f){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=f,u}i||(i=""),s.update(i,"raw");for(var a=s.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=a.getBytes()+h+""+e;if(!n)n=$t.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var y=lo(n,c-s.digestLength-1,o),v=$t.util.xorBytes(p,y,p.length),b=lo(v,s.digestLength,o),x=$t.util.xorBytes(n,b,n.length);return"\0"+x+v};jp.decode_rsa_oaep=function(t,e,r){var i,n,s;typeof r=="string"?(i=r,n=arguments[3]||void 0):r&&(i=r.label||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=o,v}if(n===void 0?n=$t.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var c=n.digest().getBytes(),f=e.charAt(0),u=e.substring(1,n.digestLength+1),a=e.substring(1+n.digestLength),h=lo(a,n.digestLength,s),l=$t.util.xorBytes(u,h,u.length),d=lo(l,o-n.digestLength-1,s),p=$t.util.xorBytes(a,d,a.length),y=p.substring(0,n.digestLength),v=f!=="\0",b=0;b<n.digestLength;++b)v|=c.charAt(b)!==y.charAt(b);for(var x=1,I=n.digestLength,D=n.digestLength;D<p.length;D++){var P=p.charCodeAt(D),T=P&1^1,U=x?65534:0;v|=P&U,x=x&T,I+=x}if(v||p.charCodeAt(I)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(I+1)};function lo(t,e,r){r||(r=$t.md.sha1.create());for(var i="",n=Math.ceil(e/r.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),i+=r.digest().getBytes()}return i.substring(0,e)}});var Wp=m((HB,Lc)=>{var Lr=Q();xe();Un();Kn();(function(){if(Lr.prime){Lc.exports=Lr.prime;return}var t=Lc.exports=Lr.prime=Lr.prime||{},e=Lr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||Lr.random,v={nextBytes:function(b){for(var x=y.getBytesSync(b.length),I=0;I<b.length;++I)b[I]=x.charCodeAt(I)}};if(p.name==="PRIMEINC")return s(h,v,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var y=u(h,l),v=0,b=a(y.bitLength());"millerRabinTests"in d&&(b=d.millerRabinTests);var x=10;"maxBlockTime"in d&&(x=d.maxBlockTime),c(y,h,l,v,b,x,p)}function c(h,l,d,p,y,v,b){var x=+new Date;do{if(h.bitLength()>l&&(h=u(l,d)),h.isProbablePrime(y))return b(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-x<v);Lr.util.setImmediate(function(){c(h,l,d,p,y,v,b)})}function f(h,l,d,p){if(typeof Worker=="undefined")return o(h,l,d,p);var y=u(h,l),v=d.workers,b=d.workLoad||100,x=b*30/8,I=d.workerScript||"forge/prime.worker.js";if(v===-1)return Lr.util.estimateCores(function(P,T){P&&(T=2),v=T-1,D()});D();function D(){v=Math.max(1,v);for(var P=[],T=0;T<v;++T)P[T]=new Worker(I);for(var U=v,T=0;T<v;++T)P[T].addEventListener("message",Ae);var H=!1;function Ae(St){if(!H){--U;var ut=St.data;if(ut.found){for(var Ye=0;Ye<P.length;++Ye)P[Ye].terminate();return H=!0,p(null,new e(ut.prime,16))}y.bitLength()>h&&(y=u(h,l));var Ii=y.toString(16);St.target.postMessage({hex:Ii,workLoad:b}),y.dAddOffset(x,0)}}}}function u(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),n,d),d.dAddOffset(31-d.mod(i).byteValue(),0),d}function a(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Ji=m((zB,ed)=>{var K=Q();di();Un();eo();zp();Wp();Kn();xe();typeof z=="undefined"&&(z=K.jsbn.BigInteger);var z,Mc=K.util.isNodejs?Yi():null,w=K.asn1,bt=K.util;K.pki=K.pki||{};ed.exports=K.pki.rsa=K.rsa=K.rsa||{};var F=K.pki,Fx=[6,4,2,4,2,4,6,2],Ux={name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},qx={name:"RSAPrivateKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Gx={name:"RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Vx=K.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},jx=function(t){var e;if(t.algorithm in F.oids)e=F.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var i=w.oidToDer(e).getBytes(),n=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),s=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);s.value.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,i)),s.value.push(w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,""));var o=w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(s),n.value.push(o),w.toDer(n).getBytes()},$p=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(z.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(z.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new z(K.util.bytesToHex(K.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(z.ONE));t=t.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};F.rsa.encrypt=function(t,e,r){var i=r,n,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(i=r===2,n=Yp(t,e,r)):(n=K.util.createBuffer(),n.putBytes(t));for(var o=new z(n.toHex(),16),c=$p(o,e,i),f=c.toString(16),u=K.util.createBuffer(),a=s-Math.ceil(f.length/2);a>0;)u.putByte(0),--a;return u.putBytes(K.util.hexToBytes(f)),u.getBytes()};F.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=n,s}var o=new z(K.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=$p(o,e,r),f=c.toString(16),u=K.util.createBuffer(),a=n-Math.ceil(f.length/2);a>0;)u.putByte(0),--a;return u.putBytes(K.util.hexToBytes(f)),i!==!1?po(u.getBytes(),e,r):u.getBytes()};F.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||K.random,n={nextBytes:function(c){for(var f=i.getBytesSync(c.length),u=0;u<c.length;++u)c[u]=f.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:n,eInt:e||65537,e:new z(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};F.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new z(null);r.fromInt(30);for(var i=0,n=function(h,l){return h|l},s=+new Date,o,c=0;t.keys===null&&(e<=0||c<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,u=f-1;t.pqState===0?(t.num=new z(f,t.rng),t.num.testBit(u)||t.num.bitwiseTo(z.ONE.shiftLeft(u),n,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(zx(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Fx[i++%8],0):t.pqState===2?t.pqState=t.num.subtract(z.ONE).gcd(t.e).compareTo(z.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(z.ONE),t.q1=t.q.subtract(z.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(z.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var a=t.e.modInverse(t.phi);t.keys={privateKey:F.rsa.setPrivateKey(t.n,t.e,a,t.p,t.q,a.mod(t.p1),a.mod(t.q1),t.q.modInverse(t.p)),publicKey:F.rsa.setPublicKey(t.n,t.e)}}o=+new Date,c+=o-s,s=o}return t.keys!==null};F.rsa.generateKeyPair=function(t,e,r,i){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(i=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,i=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!K.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(i){if(Qp("generateKeyPair"))return Mc.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,f,u){if(c)return i(c);i(null,{privateKey:F.privateKeyFromPem(u),publicKey:F.publicKeyFromPem(f)})});if(Xp("generateKey")&&Xp("exportKey"))return bt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Zp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return bt.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){i(c)}).then(function(c){if(c){var f=F.privateKeyFromAsn1(w.fromDer(K.util.createBuffer(c)));i(null,{privateKey:f,publicKey:F.setRsaPublicKey(f.n,f.e)})}});if(Jp("generateKey")&&Jp("exportKey")){var n=bt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Zp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(c){var f=c.target.result,u=bt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);u.oncomplete=function(a){var h=a.target.result,l=F.privateKeyFromAsn1(w.fromDer(K.util.createBuffer(h)));i(null,{privateKey:l,publicKey:F.setRsaPublicKey(l.n,l.e)})},u.onerror=function(a){i(a)}},n.onerror=function(c){i(c)};return}}else if(Qp("generateKeyPairSync")){var s=Mc.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:F.privateKeyFromPem(s.privateKey),publicKey:F.publicKeyFromPem(s.publicKey)}}}var o=F.rsa.createKeyPairGenerationState(t,e,r);if(!i)return F.rsa.stepKeyPairGenerationState(o,0),o.keys;Hx(o,r,i)};F.setRsaPublicKey=F.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(c,f,u){return Yp(c,f,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(c,f){return K.pkcs1.encode_rsa_oaep(f,c,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(c){return c}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,r,!0);return F.rsa.encrypt(o,r,!0)},r.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,f){f=po(f,r,!0);var u=w.fromDer(f);return c===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,f){return f=po(f,r,!0),c===f}});var o=F.rsa.decrypt(n,r,!0,!1);return s.verify(i,o,r.n.bitLength())},r};F.setRsaPrivateKey=F.rsa.setPrivateKey=function(t,e,r,i,n,s,o,c){var f={n:t,e,d:r,p:i,q:n,dP:s,dQ:o,qInv:c};return f.decrypt=function(u,a,h){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSAES-PKCS1-V1_5");var l=F.rsa.decrypt(u,f,!1,!1);if(a==="RSAES-PKCS1-V1_5")a={decode:po};else if(a==="RSA-OAEP"||a==="RSAES-OAEP")a={decode:function(d,p){return K.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(a)!==-1)a={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+a+'".');return a.decode(l,f,!1)},f.sign=function(u,a){var h=!1;typeof a=="string"&&(a=a.toUpperCase()),a===void 0||a==="RSASSA-PKCS1-V1_5"?(a={encode:jx},h=1):(a==="NONE"||a==="NULL"||a===null)&&(a={encode:function(){return u}},h=1);var l=a.encode(u,f.n.bitLength());return F.rsa.encrypt(l,f,h)},f};F.wrapRsaPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(F.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,w.toDer(t).getBytes())])};F.privateKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,Ux,e,r)&&(t=w.fromDer(K.util.createBuffer(e.privateKey))),e={},r=[],!w.validate(t,qx,e,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var n,s,o,c,f,u,a,h;return n=K.util.createBuffer(e.privateKeyModulus).toHex(),s=K.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=K.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=K.util.createBuffer(e.privateKeyPrime1).toHex(),f=K.util.createBuffer(e.privateKeyPrime2).toHex(),u=K.util.createBuffer(e.privateKeyExponent1).toHex(),a=K.util.createBuffer(e.privateKeyExponent2).toHex(),h=K.util.createBuffer(e.privateKeyCoefficient).toHex(),F.setRsaPrivateKey(new z(n,16),new z(s,16),new z(o,16),new z(c,16),new z(f,16),new z(u,16),new z(a,16),new z(h,16))};F.privateKeyToAsn1=F.privateKeyToRSAPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.e)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.d)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.p)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.q)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.dP)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.dQ)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.qInv))])};F.publicKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,Vx,e,r)){var i=w.derToOid(e.publicKeyOid);if(i!==F.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}t=e.rsaPublicKey}if(r=[],!w.validate(t,Gx,e,r)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=r,n}var s=K.util.createBuffer(e.publicKeyModulus).toHex(),o=K.util.createBuffer(e.publicKeyExponent).toHex();return F.setRsaPublicKey(new z(s,16),new z(o,16))};F.publicKeyToAsn1=F.publicKeyToSubjectPublicKeyInfo=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(F.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,[F.publicKeyToRSAPublicKey(t)])])};F.publicKeyToRSAPublicKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Yt(t.e))])};function Yp(t,e,r){var i=K.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(t.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=n-11,s}i.putByte(0),i.putByte(r);var o=n-3-t.length,c;if(r===0||r===1){c=r===0?0:255;for(var f=0;f<o;++f)i.putByte(c)}else for(;o>0;){for(var u=0,a=K.random.getBytes(o),f=0;f<o;++f)c=a.charCodeAt(f),c===0?++u:i.putByte(c);o=u}return i.putByte(0),i.putBytes(t),i}function po(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8),s=K.util.createBuffer(t),o=s.getByte(),c=s.getByte();if(o!==0||r&&c!==0&&c!==1||!r&&c!=2||r&&c===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var f=0;if(c===0){f=n-3-i;for(var u=0;u<f;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(c===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var a=s.getByte();if(a!==0||f!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Hx(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(t.pBits,function(c,f){if(c)return r(c);if(t.p=f,t.q!==null)return o(c,t.q);s(t.qBits,o)})}function s(c,f){K.prime.generateProbablePrime(c,i,f)}function o(c,f){if(c)return r(c);if(t.q=f,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(z.ONE).gcd(t.e).compareTo(z.ONE)!==0){t.p=null,n();return}if(t.q.subtract(z.ONE).gcd(t.e).compareTo(z.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(z.ONE),t.q1=t.q.subtract(z.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(z.ONE)!==0){t.p=t.q=null,n();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var a=t.e.modInverse(t.phi);t.keys={privateKey:F.rsa.setPrivateKey(t.n,t.e,a,t.p,t.q,a.mod(t.p1),a.mod(t.q1),t.q.modInverse(t.p)),publicKey:F.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Yt(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=K.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function zx(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Qp(t){return K.util.isNodejs&&typeof Mc[t]=="function"}function Xp(t){return typeof bt.globalScope!="undefined"&&typeof bt.globalScope.crypto=="object"&&typeof bt.globalScope.crypto.subtle=="object"&&typeof bt.globalScope.crypto.subtle[t]=="function"}function Jp(t){return typeof bt.globalScope!="undefined"&&typeof bt.globalScope.msCrypto=="object"&&typeof bt.globalScope.msCrypto.subtle=="object"&&typeof bt.globalScope.msCrypto.subtle[t]=="function"}function Zp(t){for(var e=K.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r}});var Kc=m((WB,sd)=>{var k=Q();Rc();di();fp();gi();eo();yp();vp();Kn();Tp();Ji();xe();typeof td=="undefined"&&(td=k.jsbn.BigInteger);var td,S=k.asn1,q=k.pki=k.pki||{};sd.exports=q.pbe=k.pbe=k.pbe||{};var mi=q.oids,Wx={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},$x={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Yx={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};q.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=k.random.getBytesSync(r.saltSize),n=r.count,s=S.integerToDer(n),o,c,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,a,h;switch(r.algorithm){case"aes128":o=16,u=16,a=mi["aes128-CBC"],h=k.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,a=mi["aes192-CBC"],h=k.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,a=mi["aes256-CBC"],h=k.aes.createEncryptionCipher;break;case"des":o=8,u=8,a=mi.desCBC,h=k.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=nd(d),y=k.pkcs5.pbkdf2(e,i,n,o,p),v=k.random.getBytesSync(u),b=h(y);b.start(v),b.update(S.toDer(t)),b.finish(),f=b.output.getBytes();var x=Qx(i,s,o,d);c=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(mi.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(mi.pkcs5PBKDF2).getBytes()),x]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(a).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var I=new k.util.ByteBuffer(i),y=q.pbe.generatePkcs12Key(e,I,1,n,o),v=q.pbe.generatePkcs12Key(e,I,2,n,o),b=k.des.createEncryptionCipher(y);b.start(v),b.update(S.toDer(t)),b.finish(),f=b.output.getBytes(),c=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(mi["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,i),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var D=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[c,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return D};q.decryptPrivateKeyInfo=function(t,e){var r=null,i={},n=[];if(!S.validate(t,Wx,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=S.derToOid(i.encryptionOid),c=q.pbe.getCipher(o,i.encryptionParams,e),f=k.util.createBuffer(i.encryptedData);return c.update(f),c.finish()&&(r=S.fromDer(c.output)),r};q.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return k.pem.encode(r,{maxline:e})};q.encryptedPrivateKeyFromPem=function(t){var e=k.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};q.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var i=q.wrapRsaPrivateKey(q.privateKeyToAsn1(t));return i=q.encryptPrivateKeyInfo(i,e,r),q.encryptedPrivateKeyToPem(i)}var n,s,o,c;switch(r.algorithm){case"aes128":n="AES-128-CBC",o=16,s=k.random.getBytesSync(16),c=k.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=k.random.getBytesSync(16),c=k.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=k.random.getBytesSync(16),c=k.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=k.random.getBytesSync(8),c=k.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=k.random.getBytesSync(8),c=k.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var u=k.pbe.opensslDeriveBytes(e,s.substr(0,8),o),a=c(u);a.start(s),a.update(S.toDer(q.privateKeyToAsn1(t))),a.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:k.util.bytesToHex(s).toUpperCase()},body:a.output.getBytes()};return k.pem.encode(h)};q.decryptRsaPrivateKey=function(t,e){var r=null,i=k.pem.decode(t)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=k.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=k.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=k.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=k.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=k.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return k.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return k.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return k.rc2.createDecryptionCipher(h,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var c=k.util.hexToBytes(i.dekInfo.parameters),f=k.pbe.opensslDeriveBytes(e,c.substr(0,8),s),u=o(f);if(u.start(c),u.update(k.util.createBuffer(i.body)),u.finish())r=u.output.getBytes();else return r}else r=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?r=q.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=q.privateKeyFromAsn1(r)),r};q.pbe.generatePkcs12Key=function(t,e,r,i,n,s){var o,c;if(typeof s=="undefined"||s===null){if(!("sha1"in k.md))throw new Error('"sha1" hash algorithm unavailable.');s=k.md.sha1.create()}var f=s.digestLength,u=s.blockLength,a=new k.util.ByteBuffer,h=new k.util.ByteBuffer;if(t!=null){for(c=0;c<t.length;c++)h.putInt16(t.charCodeAt(c));h.putInt16(0)}var l=h.length(),d=e.length(),p=new k.util.ByteBuffer;p.fillWithByte(r,u);var y=u*Math.ceil(d/u),v=new k.util.ByteBuffer;for(c=0;c<y;c++)v.putByte(e.at(c%d));var b=u*Math.ceil(l/u),x=new k.util.ByteBuffer;for(c=0;c<b;c++)x.putByte(h.at(c%l));var I=v;I.putBuffer(x);for(var D=Math.ceil(n/f),P=1;P<=D;P++){var T=new k.util.ByteBuffer;T.putBytes(p.bytes()),T.putBytes(I.bytes());for(var U=0;U<i;U++)s.start(),s.update(T.getBytes()),T=s.digest();var H=new k.util.ByteBuffer;for(c=0;c<u;c++)H.putByte(T.at(c%f));var Ae=Math.ceil(d/u)+Math.ceil(l/u),St=new k.util.ByteBuffer;for(o=0;o<Ae;o++){var ut=new k.util.ByteBuffer(I.getBytes(u)),Ye=511;for(c=H.length()-1;c>=0;c--)Ye=Ye>>8,Ye+=H.at(c)+ut.at(c),ut.setAt(c,Ye&255);St.putBuffer(ut)}I=St,a.putBuffer(T)}return a.truncate(a.length()-n),a};q.pbe.getCipher=function(t,e,r){switch(t){case q.oids.pkcs5PBES2:return q.pbe.getCipherForPBES2(t,e,r);case q.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case q.oids["pbewithSHAAnd40BitRC2-CBC"]:return q.pbe.getCipherForPKCS12PBE(t,e,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=t,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};q.pbe.getCipherForPBES2=function(t,e,r){var i={},n=[];if(!S.validate(e,$x,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(t=S.derToOid(i.kdfOid),t!==q.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=S.derToOid(i.encOid),t!==q.oids["aes128-CBC"]&&t!==q.oids["aes192-CBC"]&&t!==q.oids["aes256-CBC"]&&t!==q.oids["des-EDE3-CBC"]&&t!==q.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,c=k.util.createBuffer(i.kdfIterationCount);c=c.getInt(c.length()<<3);var f,u;switch(q.oids[t]){case"aes128-CBC":f=16,u=k.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,u=k.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,u=k.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,u=k.des.createDecryptionCipher;break;case"desCBC":f=8,u=k.des.createDecryptionCipher;break}var a=id(i.prfOid),h=k.pkcs5.pbkdf2(r,o,c,f,a),l=i.encIv,d=u(h);return d.start(l),d};q.pbe.getCipherForPKCS12PBE=function(t,e,r){var i={},n=[];if(!S.validate(e,Yx,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=k.util.createBuffer(i.salt),c=k.util.createBuffer(i.iterations);c=c.getInt(c.length()<<3);var f,u,a;switch(t){case q.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,u=8,a=k.des.startDecrypting;break;case q.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,u=8,a=function(y,v){var b=k.rc2.createDecryptionCipher(y,40);return b.start(v,null),b};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=id(i.prfOid),l=q.pbe.generatePkcs12Key(r,o,1,c,f,h);h.start();var d=q.pbe.generatePkcs12Key(r,o,2,c,u,h);return a(l,d)};q.pbe.opensslDeriveBytes=function(t,e,r,i){if(typeof i=="undefined"||i===null){if(!("md5"in k.md))throw new Error('"md5" hash algorithm unavailable.');i=k.md.md5.create()}e===null&&(e="");for(var n=[rd(i,t+e)],s=16,o=1;s<r;++o,s+=16)n.push(rd(i,n[o-1]+t+e));return n.join("").substr(0,r)};function rd(t,e){return t.start().update(e).digest().getBytes()}function id(t){var e;if(!t)e="hmacWithSHA1";else if(e=q.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return nd(e)}function nd(t){var e=k.md;switch(t){case"hmacWithSHA224":e=k.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Qx(t,e,r,i){var n=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,k.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(q.oids[i]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),n}});var Pt={};Ke(Pt,{concat:()=>Xx});function Xx(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));let r=new Uint8Array(e),i=0;for(let n of t)r.set(n,i),i+=n.length;return r}var Dt=re(()=>{});var qn=m(od=>{"use strict";od.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var Fc=m((YB,cd)=>{"use strict";var{concat:Jx}=(Dt(),Pt),{fromString:ad}=(ke(),Oe),Zx=qn();function eE({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=Zx.get();r*=8;async function c(u,a){let h=o.getRandomValues(new Uint8Array(n)),l=o.getRandomValues(new Uint8Array(e)),d={name:t,iv:l},p={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},y=await o.subtle.importKey("raw",ad(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(p,y,{name:t,length:r},!0,["encrypt"]),b=await o.subtle.encrypt(d,v,u);return Jx([h,d.iv,new Uint8Array(b)])}async function f(u,a){let h=u.slice(0,n),l=u.slice(n,n+e),d=u.slice(n+e),p={name:t,iv:l},y={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},v=await o.subtle.importKey("raw",ad(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(y,v,{name:t,length:r},!0,["decrypt"]),x=await o.subtle.decrypt(p,b,d);return new Uint8Array(x)}return{encrypt:c,decrypt:f}}cd.exports={create:eE}});var fd=m((QB,ud)=>{"use strict";var{base64:tE}=(li(),Dr),rE=Fc();ud.exports={import:async function(t,e){let r=tE.decode(t);return await rE.create().decrypt(r,e)}}});var Ot={};Ke(Ot,{equals:()=>iE});function iE(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var kt=re(()=>{});var Gc=m((XB,dd)=>{var fe=Q();gi();xe();var Gn=dd.exports=fe.sha512=fe.sha512||{};fe.md.sha512=fe.md.algorithms.sha512=Gn;var hd=fe.sha384=fe.sha512.sha384=fe.sha512.sha384||{};hd.create=function(){return Gn.create("SHA-384")};fe.md.sha384=fe.md.algorithms.sha384=hd;fe.sha512.sha256=fe.sha512.sha256||{create:function(){return Gn.create("SHA-512/256")}};fe.md["sha512/256"]=fe.md.algorithms["sha512/256"]=fe.sha512.sha256;fe.sha512.sha224=fe.sha512.sha224||{create:function(){return Gn.create("SHA-512/224")}};fe.md["sha512/224"]=fe.md.algorithms["sha512/224"]=fe.sha512.sha224;Gn.create=function(t){if(ld||nE(),typeof t=="undefined"&&(t="SHA-512"),!(t in wi))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=wi[t],r=null,i=fe.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var c={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var f=c.messageLengthSize/4,u=0;u<f;++u)c.fullMessageLength.push(0);i=fe.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return c},c.start(),c.update=function(f,u){u==="utf8"&&(f=fe.util.encodeUtf8(f));var a=f.length;c.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var h=c.fullMessageLength.length-1;h>=0;--h)c.fullMessageLength[h]+=a[1],a[1]=a[0]+(c.fullMessageLength[h]/4294967296>>>0),c.fullMessageLength[h]=c.fullMessageLength[h]>>>0,a[0]=a[1]/4294967296>>>0;return i.putBytes(f),pd(r,n,i),(i.read>2048||i.length()===0)&&i.compact(),c},c.digest=function(){var f=fe.util.createBuffer();f.putBytes(i.bytes());var u=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,a=u&c.blockLength-1;f.putBytes(Uc.substr(0,c.blockLength-a));for(var h,l,d=c.fullMessageLength[0]*8,p=0;p<c.fullMessageLength.length-1;++p)h=c.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);pd(y,n,f);var v=fe.util.createBuffer(),b;t==="SHA-512"?b=y.length:t==="SHA-384"?b=y.length-2:b=y.length-4;for(var p=0;p<b;++p)v.putInt32(y[p][0]),(p!==b-1||t!=="SHA-512/224")&&v.putInt32(y[p][1]);return v},c};var Uc=null,ld=!1,qc=null,wi=null;function nE(){Uc=String.fromCharCode(128),Uc+=fe.util.fillString(String.fromCharCode(0),128),qc=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],wi={},wi["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],wi["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],wi["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],wi["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],ld=!0}function pd(t,e,r){for(var i,n,s,o,c,f,u,a,h,l,d,p,y,v,b,x,I,D,P,T,U,H,Ae,St,ut,Ye,Ii,bs,Se,et,M,Jo,Zo,ea,ta,Ou=r.length();Ou>=128;){for(Se=0;Se<16;++Se)e[Se][0]=r.getInt32()>>>0,e[Se][1]=r.getInt32()>>>0;for(;Se<80;++Se)Jo=e[Se-2],et=Jo[0],M=Jo[1],i=((et>>>19|M<<13)^(M>>>29|et<<3)^et>>>6)>>>0,n=((et<<13|M>>>19)^(M<<3|et>>>29)^(et<<26|M>>>6))>>>0,ea=e[Se-15],et=ea[0],M=ea[1],s=((et>>>1|M<<31)^(et>>>8|M<<24)^et>>>7)>>>0,o=((et<<31|M>>>1)^(et<<24|M>>>8)^(et<<25|M>>>7))>>>0,Zo=e[Se-7],ta=e[Se-16],M=n+Zo[1]+o+ta[1],e[Se][0]=i+Zo[0]+s+ta[0]+(M/4294967296>>>0)>>>0,e[Se][1]=M>>>0;for(y=t[0][0],v=t[0][1],b=t[1][0],x=t[1][1],I=t[2][0],D=t[2][1],P=t[3][0],T=t[3][1],U=t[4][0],H=t[4][1],Ae=t[5][0],St=t[5][1],ut=t[6][0],Ye=t[6][1],Ii=t[7][0],bs=t[7][1],Se=0;Se<80;++Se)u=((U>>>14|H<<18)^(U>>>18|H<<14)^(H>>>9|U<<23))>>>0,a=((U<<18|H>>>14)^(U<<14|H>>>18)^(H<<23|U>>>9))>>>0,h=(ut^U&(Ae^ut))>>>0,l=(Ye^H&(St^Ye))>>>0,c=((y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25))>>>0,f=((y<<4|v>>>28)^(v<<30|y>>>2)^(v<<25|y>>>7))>>>0,d=(y&b|I&(y^b))>>>0,p=(v&x|D&(v^x))>>>0,M=bs+a+l+qc[Se][1]+e[Se][1],i=Ii+u+h+qc[Se][0]+e[Se][0]+(M/4294967296>>>0)>>>0,n=M>>>0,M=f+p,s=c+d+(M/4294967296>>>0)>>>0,o=M>>>0,Ii=ut,bs=Ye,ut=Ae,Ye=St,Ae=U,St=H,M=T+n,U=P+i+(M/4294967296>>>0)>>>0,H=M>>>0,P=I,T=D,I=b,D=x,b=y,x=v,M=n+o,y=i+s+(M/4294967296>>>0)>>>0,v=M>>>0;M=t[0][1]+v,t[0][0]=t[0][0]+y+(M/4294967296>>>0)>>>0,t[0][1]=M>>>0,M=t[1][1]+x,t[1][0]=t[1][0]+b+(M/4294967296>>>0)>>>0,t[1][1]=M>>>0,M=t[2][1]+D,t[2][0]=t[2][0]+I+(M/4294967296>>>0)>>>0,t[2][1]=M>>>0,M=t[3][1]+T,t[3][0]=t[3][0]+P+(M/4294967296>>>0)>>>0,t[3][1]=M>>>0,M=t[4][1]+H,t[4][0]=t[4][0]+U+(M/4294967296>>>0)>>>0,t[4][1]=M>>>0,M=t[5][1]+St,t[5][0]=t[5][0]+Ae+(M/4294967296>>>0)>>>0,t[5][1]=M>>>0,M=t[6][1]+Ye,t[6][0]=t[6][0]+ut+(M/4294967296>>>0)>>>0,t[6][1]=M>>>0,M=t[7][1]+bs,t[7][0]=t[7][0]+Ii+(M/4294967296>>>0)>>>0,t[7][1]=M>>>0,Ou-=128}}});var Vc=m((JB,yd)=>{"use strict";var sE=Us(),oE=le();yd.exports=function(t){if(isNaN(t)||t<=0)throw oE(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return sE(t)}});var yo=m(Vn=>{"use strict";xe();Un();var aE=Q(),{fromString:cE}=(ke(),Oe),{toString:gd}=(qe(),Ue),{concat:bd}=(Dt(),Pt);Vn.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=bd([new Uint8Array(e-r.length),r])}return gd(r,"base64url")};Vn.base64urlToBigInteger=t=>{let e=Vn.base64urlToBuffer(t);return new aE.jsbn.BigInteger(gd(e,"base16"),16)};Vn.base64urlToBuffer=(t,e)=>{let r=cE(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=bd([new Uint8Array(e-r.length),r])}return r}});var wd=m(jn=>{"use strict";di();Ji();var Mr=Q(),{bigIntegerToUintBase64url:Qt,base64urlToBigInteger:Xt}=yo(),{fromString:vd}=(ke(),Oe),{toString:md}=(qe(),Ue);jn.pkcs1ToJwk=function(t){let e=Mr.asn1.fromDer(md(t,"ascii")),r=Mr.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Qt(r.n),e:Qt(r.e),d:Qt(r.d),p:Qt(r.p),q:Qt(r.q),dp:Qt(r.dP),dq:Qt(r.dQ),qi:Qt(r.qInv),alg:"RS256",kid:"2011-04-29"}};jn.jwkToPkcs1=function(t){let e=Mr.pki.privateKeyToAsn1({n:Xt(t.n),e:Xt(t.e),d:Xt(t.d),p:Xt(t.p),q:Xt(t.q),dP:Xt(t.dp),dQ:Xt(t.dq),qInv:Xt(t.qi)});return vd(Mr.asn1.toDer(e).getBytes(),"ascii")};jn.pkixToJwk=function(t){let e=Mr.asn1.fromDer(md(t,"ascii")),r=Mr.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Qt(r.n),e:Qt(r.e),alg:"RS256",kid:"2011-04-29"}};jn.jwkToPkix=function(t){let e=Mr.pki.publicKeyToAsn1({n:Xt(t.n),e:Xt(t.e)});return vd(Mr.asn1.toDer(e).getBytes(),"ascii")}});var Sd=m((tR,_d)=>{"use strict";Ji();var xd=Q(),{base64urlToBigInteger:uE}=yo();function Ed(t,e){return e.map(r=>uE(t[r]))}function fE(t){return xd.pki.setRsaPrivateKey(...Ed(t,["n","e","d","p","q","dp","dq","qi"]))}function hE(t){return xd.pki.setRsaPublicKey(...Ed(t,["n","e"]))}_d.exports={jwk2pub:hE,jwk2priv:fE}});var Bd=m(yr=>{"use strict";var dr=qn(),lE=Vc(),{toString:pE}=(qe(),Ue),{fromString:dE}=(ke(),Oe);yr.utils=wd();yr.generateKey=async function(t){let e=await dr.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Id(e);return{privateKey:r[0],publicKey:r[1]}};yr.unmarshalPrivateKey=async function(t){let r=[await dr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await yE(t)],i=await Id({privateKey:r[0],publicKey:r[1]});return{privateKey:i[0],publicKey:i[1]}};yr.getRandomValues=lE;yr.hashAndSign=async function(t,e){let r=await dr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await dr.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};yr.hashAndVerify=async function(t,e,r){let i=await dr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return dr.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,r)};function Id(t){return Promise.all([dr.get().subtle.exportKey("jwk",t.privateKey),dr.get().subtle.exportKey("jwk",t.publicKey)])}function yE(t){return dr.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:gE,jwk2priv:bE}=Sd();function Ad(t,e,r,i){let n=e?gE(t):bE(t),s=pE(Uint8Array.from(r),"ascii"),o=i(s,n);return dE(o,"ascii")}yr.encrypt=function(t,e){return Ad(t,!0,e,(r,i)=>i.encrypt(r))};yr.decrypt=function(t,e){return Ad(t,!1,e,(r,i)=>i.decrypt(r))}});var go=m((iR,Rd)=>{"use strict";var{base64:vE}=(li(),Dr),mE=Fc();Rd.exports={export:async function(t,e){let i=await mE.create().encrypt(t,e);return vE.encode(i)}}});var Od=m((nR,Dd)=>{"use strict";var{sha256:Cd}=(Rt(),dt),Td=le(),{equals:Pd}=(kt(),Ot),{toString:wE}=(qe(),Ue);Gc();var bo=Q(),vt=Bd(),vo=Xs(),xE=go(),mo=class{constructor(e){this._key=e}async verify(e,r){return vt.hashAndVerify(this._key,r,e)}marshal(){return vt.utils.jwkToPkix(this._key)}get bytes(){return vo.PublicKey.encode({Type:vo.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return vt.encrypt(this._key,e)}equals(e){return Pd(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Cd.digest(this.bytes);return e}},Hn=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return vt.getRandomValues(16)}async sign(e){return vt.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw Td(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new mo(this._publicKey)}decrypt(e){return vt.decrypt(this._key,e)}marshal(){return vt.utils.jwkToPkcs1(this._key)}get bytes(){return vo.PrivateKey.encode({Type:vo.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return Pd(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Cd.digest(this.bytes);return e}async id(){let e=await this.public.hash();return wE(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let i=new bo.util.ByteBuffer(this.marshal()),n=bo.asn1.fromDer(i),s=bo.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return bo.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return xE.export(this.bytes,e);throw Td(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function EE(t){let e=vt.utils.pkcs1ToJwk(t),r=await vt.unmarshalPrivateKey(e);return new Hn(r.privateKey,r.publicKey)}function _E(t){let e=vt.utils.pkixToJwk(t);return new mo(e)}async function SE(t){let e=await vt.unmarshalPrivateKey(t);return new Hn(e.privateKey,e.publicKey)}async function IE(t){let e=await vt.generateKey(t);return new Hn(e.privateKey,e.publicKey)}Dd.exports={RsaPublicKey:mo,RsaPrivateKey:Hn,unmarshalRsaPublicKey:_E,unmarshalRsaPrivateKey:EE,generateKeyPair:IE,fromJwk:SE}});var Jc=m(he=>{"use strict";var AE=he&&he.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(he,"__esModule",{value:!0});he.utils=he.verify=he.sign=he.getPublicKey=he.SignResult=he.Signature=he.Point=he.ExtendedPoint=he.CURVE=void 0;var BE=AE(Yi()),Ve=BigInt(0),W=BigInt(1),st=BigInt(2),kd=BigInt(255),Ee={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:st**kd-BigInt(19),n:st**BigInt(252)+BigInt("27742317777372353535851937790883648493"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};he.CURVE=Ee;var Ze=32,zn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),RE=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),CE=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),TE=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),PE=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),se=class{constructor(e,r,i,n){this.x=e,this.y=r,this.z=i,this.t=n}static fromAffine(e){if(!(e instanceof ye))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ye.ZERO)?se.ZERO:new se(e.x,e.y,W,B(e.x*e.y))}static toAffineBatch(e){let r=kE(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(r[n]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}static fromRistrettoHash(e){if(typeof e=="string"&&(e=Fr(e)),e.length!==64)throw new Error("Invalid ristretto hash, need 64 bytes");let r=Wc(e.slice(0,Ze)),i=this.calcElligatorRistrettoMap(r),n=Wc(e.slice(Ze,Ze*2)),s=this.calcElligatorRistrettoMap(n);return i.add(s)}static calcElligatorRistrettoMap(e){let{d:r}=Ee,i=B(zn*e*e),n=B((i+W)*TE),s=BigInt(-1),o=B((s-r*i)*B(i+r)),{isValid:c,value:f}=Yc(n,o),u=B(f*e);Ur(u)||(u=B(-u)),c||(f=u),c||(s=i);let a=B(s*(i-W)*PE-o),h=f*f,l=B((f+f)*o),d=B(a*RE),p=B(W-h),y=B(W+h);return new se(B(l*y),B(p*d),B(d*y),B(l*p))}static fromRistrettoBytes(e){if(typeof e=="string"&&(e=Fr(e)),e.length!==32)throw new Error("Invalid ristretto hash, need 64 bytes");let{a:r,d:i}=Ee,n="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",s=Wc(e);if(!ME(Ld(s,Ze),e)||Ur(s))throw new Error(n);let o=B(s*s),c=B(W+r*o),f=B(W-r*o),u=B(c*c),a=B(f*f),h=B(r*i*u-a),{isValid:l,value:d}=Md(B(h*a)),p=B(d*f),y=B(d*p*h),v=B((s+s)*p);Ur(v)&&(v=B(-v));let b=B(c*y),x=B(v*b);if(!l||Ur(x)||b===Ve)throw new Error(n);return new se(v,b,W,x)}toRistrettoBytes(){let{x:e,y:r,z:i,t:n}=this,s=B(B(i+r)*B(i-r)),o=B(e*r),{value:c}=Md(B(s*o**st)),f=B(c*s),u=B(c*o),a=B(f*u*n),h;if(Ur(n*a)){let d=B(r*zn),p=B(e*zn);e=d,r=p,h=B(f*CE)}else h=u;Ur(e*a)&&(r=B(-r));let l=B((i-r)*h);return Ur(l)&&(l=B(-l)),Ld(l,Ze)}equals(e){let r=this,i=e;return B(r.t*i.z)===B(i.t*r.z)}negate(){return new se(B(-this.x),this.y,this.z,B(-this.t))}double(){let e=this.x,r=this.y,i=this.z,{a:n}=Ee,s=B(e**st),o=B(r**st),c=B(st*i**st),f=B(n*s),u=B((e+r)**st-s-o),a=B(f+o),h=B(a-c),l=B(f-o),d=B(u*h),p=B(a*l),y=B(u*l),v=B(h*a);return new se(d,p,v,y)}add(e){let r=this.x,i=this.y,n=this.z,s=this.t,o=e.x,c=e.y,f=e.z,u=e.t,a=B((i-r)*(c+o)),h=B((i+r)*(c-o)),l=B(h-a);if(l===Ve)return this.double();let d=B(n*st*u),p=B(s*st*f),y=B(p+d),v=B(h+a),b=B(p-d),x=B(y*l),I=B(v*b),D=B(y*b),P=B(l*v);return new se(x,I,P,D)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=qd(e);if(r===W)return this;let i=se.ZERO,n=this;for(;r>Ve;)r&W&&(i=i.add(n)),n=n.double(),r>>=W;return i}precomputeWindow(e){let r=256/e+1,i=[],n=this,s=n;for(let o=0;o<r;o++){s=n,i.push(s);for(let c=1;c<2**(e-1);c++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,r){!r&&this.equals(se.BASE)&&(r=ye.BASE);let i=r&&r._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&jc.get(r);n||(n=this.precomputeWindow(i),r&&i!==1&&(n=se.normalizeZ(n),jc.set(r,n)));let s=se.ZERO,o=se.ZERO,c=256/i+1,f=2**(i-1),u=BigInt(2**i-1),a=2**i,h=BigInt(i);for(let l=0;l<c;l++){let d=l*f,p=Number(e&u);if(e>>=h,p>f&&(p-=a,e+=W),p===0){let y=n[d];l%2&&(y=y.negate()),o=o.add(y)}else{let y=n[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return[s,o]}multiply(e,r){let i=qd(e);return se.normalizeZ(this.wNAF(i,r))[0]}toAffine(e=$c(this.z)){let r=B(this.x*e),i=B(this.y*e);return new ye(r,i)}};he.ExtendedPoint=se;se.BASE=new se(Ee.Gx,Ee.Gy,W,B(Ee.Gx*Ee.Gy));se.ZERO=new se(Ve,W,W,Ve);var jc=new WeakMap,ye=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,jc.delete(this)}static fromHex(e){let{d:r,P:i}=Ee,n=e instanceof Uint8Array?e:Fr(e);if(n.length!==32)throw new Error("Point.fromHex: expected 32 bytes");let s=n[31],o=s&~128,c=(s&128)!=0,f=Uint8Array.from(Array.from(n.slice(0,31)).concat(o)),u=Wn(f);if(u>=i)throw new Error("Point.fromHex expects hex <= Fp");let a=B(u*u),h=B(a-W),l=B(r*a+W),{isValid:d,value:p}=Yc(h,l);if(!d)throw new Error("Point.fromHex: invalid y coordinate");let y=(p&W)===W;return c!==y&&(p=B(-p)),new ye(p,u)}static async fromPrivateKey(e){let r=await Ud(e);return ye.BASE.multiply(Kd(r))}toRawBytes(){let e=zc(this.y),r=new Uint8Array(Ze);for(let n=e.length-2,s=0;s<Ze&&n>=0;n-=2,s++)r[s]=Nd(e[n]+e[n+1]);let i=this.x&W?128:0;return r[Ze-1]|=i,r}toHex(){return Hc(this.toRawBytes())}toX25519(){return B((W+this.y)*$c(W-this.y))}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ye(B(-this.x),this.y)}add(e){return se.fromAffine(this).add(se.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return se.fromAffine(this).multiply(e,this).toAffine()}};he.Point=ye;ye.BASE=new ye(Ee.Gx,Ee.Gy);ye.ZERO=new ye(Ve,W);var Kr=class{constructor(e,r){this.r=e,this.s=r}static fromHex(e){e=Xc(e);let r=ye.fromHex(e.slice(0,32)),i=Wn(e.slice(32));if(!Fd(i))throw new Error("Signature.fromHex expects s <= CURVE.n");return new Kr(r,i)}toRawBytes(){let e=Fr(zc(this.s)).reverse(),r=new Uint8Array(Ze);r.set(e);let i=new Uint8Array(Ze*2);return i.set(this.r.toRawBytes()),i.set(r,32),i}toHex(){return Hc(this.toRawBytes())}};he.Signature=Kr;he.SignResult=Kr;function DE(...t){if(t.length===1)return t[0];let e=t.reduce((i,n)=>i+n.length,0),r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){let s=t[i];r.set(s,n),n+=s.length}return r}var OE=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Hc(t){let e="";for(let r=0;r<t.length;r++)e+=OE[t[r]];return e}function Nd(t){let e=Number.parseInt(t,16);if(Number.isNaN(e))throw new Error("Invalid byte sequence");return e}function Fr(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let i=r*2;e[r]=Nd(t.slice(i,i+2))}return e}function zc(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Ld(t,e=Ze){let r=zc(t).padStart(e*2,"0");return Fr(r).reverse()}function Ur(t){return(B(t)&W)===W}function Wn(t){let e=Ve;for(let r=0;r<t.length;r++)e+=BigInt(t[r])<<BigInt(8)*BigInt(r);return e}function Wc(t){return B(Wn(t)&st**kd-W)}function B(t,e=Ee.P){let r=t%e;return r>=Ve?r:e+r}function $c(t,e=Ee.P){if(t===Ve||e<=Ve)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=B(t,e),i=e,n=Ve,s=W,o=W,c=Ve;for(;r!==Ve;){let u=i/r,a=i%r,h=n-o*u,l=s-c*u;i=r,r=a,n=o,s=c,o=h,c=l}if(i!==W)throw new Error("invert: does not exist");return B(n,e)}function kE(t,e=Ee.P){let r=t.length,i=new Array(r),n=W;for(let s=0;s<r;s++)t[s]!==Ve&&(i[s]=n,n=B(n*t[s],e));n=$c(n,e);for(let s=r-1;s>=0;s--){if(t[s]===Ve)continue;let o=B(n*t[s],e);t[s]=B(n*i[s],e),n=o}return t}function Jt(t,e){let{P:r}=Ee,i=t;for(;e-- >Ve;)i*=i,i%=r;return i}function NE(t){let{P:e}=Ee,[r,i,n,s,o]=[5,10,20,40,80].map(I=>BigInt(I)),f=t*t%e*t%e,u=Jt(f,st)*f%e,a=Jt(u,W)*t%e,h=Jt(a,r)*a%e,l=Jt(h,i)*h%e,d=Jt(l,n)*l%e,p=Jt(d,s)*d%e,y=Jt(p,o)*p%e,v=Jt(y,o)*p%e,b=Jt(v,i)*h%e;return Jt(b,st)*t%e}function Yc(t,e){let r=B(e*e*e),i=B(r*r*e),n=B(t*r*NE(t*i)),s=B(e*n*n),o=n,c=B(n*zn),f=s===t,u=s===B(-t),a=s===B(-t*zn);return f&&(n=o),(u||a)&&(n=c),Ur(n)&&(n=B(-n)),{isValid:f||u,value:n}}function Md(t){return Yc(W,t)}async function Qc(...t){let e=DE(...t),r=await he.utils.sha512(e),i=Wn(r);return B(i,Ee.n)}function LE(t){return t.slice(Ze)}function Kd(t){let e=Ze-1,r=t.slice(0,Ze);return r[0]&=248,r[e]&=127,r[e]|=64,B(Wn(r),Ee.n)}function ME(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Xc(t){return t instanceof Uint8Array?t:Fr(t)}function Fd(t){return 0<t&&t<Ee.n}var KE=st**BigInt(256)-W;function FE(t){let e,r="Expected 32 bytes of private key";if(typeof t=="bigint"||typeof t=="number"&&Number.isSafeInteger(t)){let i=BigInt(t);if(i<0||i>KE)throw new Error(r);e=Fr(i.toString(16).padStart(Ze*2,"0"))}else if(typeof t=="string"){if(t.length!==64)throw new Error(r);e=Fr(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error(r);e=t}else throw new TypeError("Expected valid private key");return e}async function Ud(t){return await he.utils.sha512(FE(t))}function qd(t){if(typeof t=="number"&&t>0&&Number.isSafeInteger(t))return BigInt(t);if(typeof t=="bigint"&&Fd(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}async function UE(t){return(await ye.fromPrivateKey(t)).toRawBytes()}he.getPublicKey=UE;async function qE(t,e){let r=await Ud(e),i=Kd(r),n=ye.BASE.multiply(i),s=Xc(t),o=await Qc(LE(r),s),c=ye.BASE.multiply(o),f=await Qc(c.toRawBytes(),n.toRawBytes(),s),u=B(o+f*i,Ee.n);return new Kr(c,u).toRawBytes()}he.sign=qE;async function GE(t,e,r){e=Xc(e),r instanceof ye||(r=ye.fromHex(r)),t instanceof Kr||(t=Kr.fromHex(t));let i=await Qc(t.r.toRawBytes(),r.toRawBytes(),e),n=se.fromAffine(r).multiplyUnsafe(i),s=se.BASE.multiply(t.s);return se.fromAffine(t.r).add(n).subtract(s).multiplyUnsafe(Ee.h).equals(se.ZERO)}he.verify=GE;ye.BASE._setWindowSize(8);var qr={node:BE.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};he.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:Hc,randomBytes:(t=32)=>{if(qr.web)return qr.web.getRandomValues(new Uint8Array(t));if(qr.node){let{randomBytes:e}=qr.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>he.utils.randomBytes(32),sha512:async t=>{if(qr.web){let e=await qr.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(qr.node)return Uint8Array.from(qr.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ye.BASE){let r=e.equals(ye.BASE)?e:new ye(e.x,e.y);return r._setWindowSize(t),r.multiply(W),r}}});var Vd=m(Gr=>{"use strict";var $n=Jc(),VE=32,jE=64,wo=32;Gr.publicKeyLength=VE;Gr.privateKeyLength=jE;Gr.generateKey=async function(){let t=$n.utils.randomPrivateKey(),e=await $n.getPublicKey(t);return{privateKey:Gd(t,e),publicKey:e}};Gr.generateKeyFromSeed=async function(t){if(t.length!==wo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await $n.getPublicKey(e);return{privateKey:Gd(e,r),publicKey:r}};Gr.hashAndSign=function(t,e){let r=t.slice(0,wo);return $n.sign(e,r)};Gr.hashAndVerify=function(t,e,r){return $n.verify(e,r,t)};function Gd(t,e){let r=new Uint8Array(Gr.privateKeyLength);for(let i=0;i<wo;i++)r[i]=t[i],r[wo+i]=e[i];return r}});var $d=m((aR,Wd)=>{"use strict";var jd=le(),{equals:Hd}=(kt(),Ot),{sha256:zd}=(Rt(),dt),{base58btc:HE}=(hi(),fi),{identity:zE}=(On(),zi),je=Vd(),xo=Xs(),WE=go(),Eo=class{constructor(e){this._key=en(e,je.publicKeyLength)}async verify(e,r){return je.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return xo.PublicKey.encode({Type:xo.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Hd(this.bytes,e.bytes)}async hash(){let{bytes:e}=await zd.digest(this.bytes);return e}},Zi=class{constructor(e,r){this._key=en(e,je.privateKeyLength),this._publicKey=en(r,je.publicKeyLength)}async sign(e){return je.hashAndSign(this._key,e)}get public(){return new Eo(this._publicKey)}marshal(){return this._key}get bytes(){return xo.PrivateKey.encode({Type:xo.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Hd(this.bytes,e.bytes)}async hash(){let{bytes:e}=await zd.digest(this.bytes);return e}async id(){let e=await zE.digest(this.public.bytes);return HE.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return WE.export(this.bytes,e);throw jd(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function $E(t){if(t.length>je.privateKeyLength){t=en(t,je.privateKeyLength+je.publicKeyLength);let i=t.slice(0,je.privateKeyLength),n=t.slice(je.privateKeyLength,t.length);return new Zi(i,n)}t=en(t,je.privateKeyLength);let e=t.slice(0,je.privateKeyLength),r=t.slice(je.publicKeyLength);return new Zi(e,r)}function YE(t){return t=en(t,je.publicKeyLength),new Eo(t)}async function QE(){let{privateKey:t,publicKey:e}=await je.generateKey();return new Zi(t,e)}async function XE(t){let{privateKey:e,publicKey:r}=await je.generateKeyFromSeed(t);return new Zi(e,r)}function en(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw jd(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}Wd.exports={Ed25519PublicKey:Eo,Ed25519PrivateKey:Zi,unmarshalEd25519PrivateKey:$E,unmarshalEd25519PublicKey:YE,generateKeyPair:QE,generateKeyPairFromSeed:XE}});var nu=m(Z=>{"use strict";var JE=Z&&Z.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Z,"__esModule",{value:!0});Z.utils=Z.schnorr=Z.verify=Z.signSync=Z.sign=Z.getSharedSecret=Z.recoverPublicKey=Z.getPublicKey=Z.Signature=Z.Point=Z.CURVE=void 0;var ZE=JE(Yi()),$=BigInt(0),ve=BigInt(1),_e=BigInt(2),tn=BigInt(3),e_=BigInt(8),Zc=_e**BigInt(256),ne={a:$,b:BigInt(7),P:Zc-_e**BigInt(32)-BigInt(977),n:Zc-BigInt("432420386565659656852420866394968145599"),h:ve,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};Z.CURVE=ne;function Yd(t){let{a:e,b:r}=ne;return N(t**tn+e*t+r)}var _o=ne.a===$,J=class{constructor(e,r,i){this.x=e,this.y=r,this.z=i}static fromAffine(e){if(!(e instanceof te))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new J(e.x,e.y,ve)}static toAffineBatch(e){let r=s_(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(r[n]))}static normalizeZ(e){return J.toAffineBatch(e).map(J.fromAffine)}equals(e){let r=this,i=e,n=N(r.z*r.z),s=N(r.z*n),o=N(i.z*i.z),c=N(i.z*o);return N(r.x*o)===N(n*i.x)&&N(r.y*c)===N(s*i.y)}negate(){return new J(this.x,N(-this.y),this.z)}double(){let e=this.x,r=this.y,i=this.z,n=N(e**_e),s=N(r**_e),o=N(s**_e),c=N(_e*(N(N((e+s)**_e))-n-o)),f=N(tn*n),u=N(f**_e),a=N(u-_e*c),h=N(f*(c-a)-e_*o),l=N(_e*r*i);return new J(a,h,l)}add(e){if(!(e instanceof J))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,i=this.y,n=this.z,s=e.x,o=e.y,c=e.z;if(s===$||o===$)return this;if(r===$||i===$)return e;let f=N(n**_e),u=N(c**_e),a=N(r*u),h=N(s*f),l=N(i*c*u),d=N(N(o*n)*f),p=N(h-a),y=N(d-l);if(p===$)return y===$?this.double():J.ZERO;let v=N(p**_e),b=N(p*v),x=N(a*v),I=N(y**_e-b-_e*x),D=N(y*(x-I)-l*b),P=N(n*c*p);return new J(I,D,P)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=Jd(e);if(!_o){let a=J.ZERO,h=this;for(;r>$;)r&ve&&(a=a.add(h)),h=h.double(),r>>=ve;return a}let{k1neg:i,k1:n,k2neg:s,k2:o}=ey(r),c=J.ZERO,f=J.ZERO,u=this;for(;n>$||o>$;)n&ve&&(c=c.add(u)),o&ve&&(f=f.add(u)),u=u.double(),n>>=ve,o>>=ve;return i&&(c=c.negate()),s&&(f=f.negate()),f=new J(N(f.x*ne.beta),f.y,f.z),c.add(f)}precomputeWindow(e){let r=_o?128/e+1:256/e+1,i=[],n=this,s=n;for(let o=0;o<r;o++){s=n,i.push(s);for(let c=1;c<2**(e-1);c++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,r){!r&&this.equals(J.BASE)&&(r=te.BASE);let i=r&&r._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&eu.get(r);n||(n=this.precomputeWindow(i),r&&i!==1&&(n=J.normalizeZ(n),eu.set(r,n)));let s=J.ZERO,o=J.ZERO,c=_o?128/i+1:256/i+1,f=2**(i-1),u=BigInt(2**i-1),a=2**i,h=BigInt(i);for(let l=0;l<c;l++){let d=l*f,p=Number(e&u);if(e>>=h,p>f&&(p-=a,e+=ve),p===0){let y=n[d];l%2&&(y=y.negate()),o=o.add(y)}else{let y=n[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return{p:s,f:o}}multiply(e,r){let i=Jd(e),n,s;if(_o){let{k1neg:o,k1:c,k2neg:f,k2:u}=ey(i),{p:a,f:h}=this.wNAF(c,r),{p:l,f:d}=this.wNAF(u,r);o&&(a=a.negate()),f&&(l=l.negate()),l=new J(N(l.x*ne.beta),l.y,l.z),n=a.add(l),s=h.add(d)}else{let{p:o,f:c}=this.wNAF(i,r);n=o,s=c}return J.normalizeZ([n,s])[0]}toAffine(e=Xn(this.z)){let r=e**_e,i=N(this.x*r),n=N(this.y*r*e);return new te(i,n)}};J.BASE=new J(ne.Gx,ne.Gy,ve);J.ZERO=new J($,ve,$);var eu=new WeakMap,te=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,eu.delete(this)}static fromCompressedHex(e){let r=e.length===32,i=ot(r?e:e.slice(1)),n=Yd(i),s=n_(n),o=(s&ve)===ve;r?o&&(s=N(-s)):(e[0]&1)==1!==o&&(s=N(-s));let c=new te(i,s);return c.assertValidity(),c}static fromUncompressedHex(e){let r=ot(e.slice(1,33)),i=ot(e.slice(33)),n=new te(r,i);return n.assertValidity(),n}static fromHex(e){let r=Io(e),i=r[0];if(r.length===32||r.length===33&&(i===2||i===3))return this.fromCompressedHex(r);if(r.length===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(e){return te.BASE.multiply(nn(e))}static fromSignature(e,r,i){let n=e instanceof Uint8Array?ot(e):jr(e),s=iy(r),{r:o,s:c}=s;if(i!==0&&i!==1)throw new Error("Cannot recover signature: invalid recovery bit");let f=2+(i&1),u=te.fromHex(`0${f}${Vr(o)}`),a=J.fromAffine(u).multiplyUnsafe(c),h=J.BASE.multiply(n),l=Xn(o,ne.n),p=a.subtract(h).multiplyUnsafe(l).toAffine();return p.assertValidity(),p}toRawBytes(e=!1){return Hr(this.toHex(e))}toHex(e=!1){let r=Vr(this.x);return e?`${this.y&ve?"03":"02"}${r}`:`04${r}${Vr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{P:r}=ne,{x:i,y:n}=this;if(i===$||n===$||i>=r||n>=r)throw new Error(e);let s=N(n*n),o=Yd(i);if((s-o)%r!==$)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new te(this.x,N(-this.y))}double(){return J.fromAffine(this).double().toAffine()}add(e){return J.fromAffine(this).add(J.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return J.fromAffine(this).multiply(e,this).toAffine()}};Z.Point=te;te.BASE=new te(ne.Gx,ne.Gy);te.ZERO=new te($,$);function Qd(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function Xd(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${xi(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ot(r),left:t.subarray(e+2)}}function t_(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${xi(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=Xd(t.subarray(2)),{data:i,left:n}=Xd(r);if(n.length)throw new Error(`Invalid signature: left bytes after parsing: ${xi(n)}`);return{r:e,s:i}}var Zt=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,i="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${i}: Expected string or Uint8Array`);let n=r?xi(e):e;if(n.length!==128)throw new Error(`${i}: Expected 64-byte hex`);return new Zt(jr(n.slice(0,64)),jr(n.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:i,s:n}=t_(r?e:Hr(e));return new Zt(i,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!rn(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!rn(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ne.n>>ve;return this.s>e}normalizeS(){return this.hasHighS()?new Zt(this.r,ne.n-this.s):this}toDERRawBytes(e=!1){return Hr(this.toDERHex(e))}toDERHex(e=!1){let r=Qd(Qn(this.s));if(e)return r;let i=Qd(Qn(this.r)),n=Qn(i.length/2),s=Qn(r.length/2);return`30${Qn(i.length/2+r.length/2+4)}02${n}${i}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Hr(this.toCompactHex())}toCompactHex(){return Vr(this.r)+Vr(this.s)}};Z.Signature=Zt;function So(...t){if(t.length===1)return t[0];let e=t.reduce((i,n)=>i+n.length,0),r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){let s=t[i];r.set(s,n),n+=s.length}return r}var r_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function xi(t){let e="";for(let r=0;r<t.length;r++)e+=r_[t[r]];return e}function Vr(t){if(t>Zc)throw new Error("pad64: invalid number");return t.toString(16).padStart(64,"0")}function Yn(t){return Hr(Vr(t))}function Qn(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function jr(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function i_(t){if(t.length!==2)throw new Error("Invalid byte sequence");let e=Number.parseInt(t,16);if(Number.isNaN(e))throw new Error("Invalid byte sequence");return e}function Hr(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let i=r*2;e[r]=i_(t.slice(i,i+2))}return e}function Io(t){return t instanceof Uint8Array?t:Hr(t)}function ot(t){return jr(xi(t))}function Jd(t){if(typeof t=="number"&&t>0&&Number.isSafeInteger(t))return BigInt(t);if(typeof t=="bigint"&&rn(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function N(t,e=ne.P){let r=t%e;return r>=0?r:e+r}function mt(t,e){let{P:r}=ne,i=t;for(;e-- >$;)i*=i,i%=r;return i}function n_(t){let{P:e}=ne,r=BigInt(6),i=BigInt(11),n=BigInt(22),s=BigInt(23),o=BigInt(44),c=BigInt(88),f=t*t*t%e,u=f*f*t%e,a=mt(u,tn)*u%e,h=mt(a,tn)*u%e,l=mt(h,_e)*f%e,d=mt(l,i)*l%e,p=mt(d,n)*d%e,y=mt(p,o)*p%e,v=mt(y,c)*y%e,b=mt(v,o)*p%e,x=mt(b,tn)*u%e,I=mt(x,s)*d%e,D=mt(I,r)*f%e;return mt(D,_e)}function Xn(t,e=ne.P){if(t===$||e<=$)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=N(t,e),i=e,n=$,s=ve,o=ve,c=$;for(;r!==$;){let u=i/r,a=i%r,h=n-o*u,l=s-c*u;i=r,r=a,n=o,s=c,o=h,c=l}if(i!==ve)throw new Error("invert: does not exist");return N(n,e)}function s_(t,e=ne.P){let r=t.length,i=new Array(r),n=ve;for(let s=0;s<r;s++)t[s]!==$&&(i[s]=n,n=N(n*t[s],e));n=Xn(n,e);for(let s=r-1;s>=0;s--){if(t[s]===$)continue;let o=N(n*t[s],e);t[s]=N(n*i[s],e),n=o}return t}var Zd=(t,e)=>(t+e/_e)/e,Ao=_e**BigInt(128);function ey(t){let{n:e}=ne,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-ve*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=Zd(s*t,e),c=Zd(-i*t,e),f=N(t-o*r-c*n,e),u=N(-o*i-c*s,e),a=f>Ao,h=u>Ao;if(a&&(f=e-f),h&&(u=e-u),f>Ao||u>Ao)throw new Error("splitScalarEndo: Endomorphism failed");return{k1neg:a,k1:f,k2neg:h,k2:u}}function o_(t){typeof t!="string"&&(t=xi(t));let e=jr(t||"0"),i=t.length/2*8-256;return i>0&&(e=e>>BigInt(i)),e>=ne.n&&(e-=ne.n),e}function ty(t,e,r){if(t==null)throw new Error(`sign: expected valid msgHash, not "${t}"`);let i=typeof t=="string"?jr(t):ot(t),n=Yn(i),s=ot(n),o=Yn(e),c=new Uint8Array(32).fill(1),f=new Uint8Array(32).fill(0),u=Uint8Array.from([0]),a=Uint8Array.from([1]),h=So(o,n);if(r!=null){let l=Yn(typeof r=="string"?jr(r):ot(r));if(l.length!==32)throw new Error("secp256k1: Expected 32 bytes of extra data");h=So(h,l)}return{xh1:h,h1n:s,v:c,k:f,b0:u,b1:a}}async function a_(t,e,r){let i=nn(e),{xh1:n,h1n:s,v:o,k:c,b0:f,b1:u}=ty(t,i,r),a=Z.utils.hmacSha256;c=await a(c,o,f,n),o=await a(c,o),c=await a(c,o,u,n),o=await a(c,o);for(let h=0;h<1e3;h++){o=await a(c,o);let l=ry(o,s,i);if(l)return l;c=await a(c,o,f),o=await a(c,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function c_(t,e,r){let i=nn(e),{xh1:n,h1n:s,v:o,k:c,b0:f,b1:u}=ty(t,i,r),a=Z.utils.hmacSha256Sync;if(!a)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");if(c=a(c,o,f,n),c instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");o=a(c,o),c=a(c,o,u,n),o=a(c,o);for(let h=0;h<1e3;h++){o=a(c,o);let l=ry(o,s,i);if(l)return l;c=a(c,o,f),o=a(c,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function rn(t){return 0<t&&t<ne.n}function ry(t,e,r){let i=ot(t);if(!rn(i))return;let n=ne.n,s=te.BASE.multiply(i),o=N(s.x,n),c=N(Xn(i,n)*(e+o*r),n);if(!(o===$||c===$))return{q:s,r:o,s:c}}function nn(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=jr(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=ot(t)}else throw new TypeError("Expected valid private key");if(!rn(e))throw new Error("Expected private key: 0 < key < n");return e}function tu(t){return t instanceof te?(t.assertValidity(),t):te.fromHex(t)}function iy(t){if(t instanceof Zt)return t.assertValidity(),t;try{return Zt.fromDER(t)}catch(e){return Zt.fromCompact(t)}}function u_(t,e=!1){return te.fromPrivateKey(t).toRawBytes(e)}Z.getPublicKey=u_;function f_(t,e,r){return te.fromSignature(t,e,r).toRawBytes()}Z.recoverPublicKey=f_;function ny(t){let e=t instanceof Uint8Array,r=typeof t=="string",i=(e||r)&&t.length;return e?i===33||i===65:r?i===66||i===130:t instanceof te}function h_(t,e,r=!1){if(ny(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!ny(e))throw new TypeError("getSharedSecret: second arg must be public key");let i=tu(e);return i.assertValidity(),i.multiply(nn(t)).toRawBytes(r)}Z.getSharedSecret=h_;function sy(t,e){let{q:r,r:i,s:n}=t,s={canonical:!0,der:!0},{canonical:o,der:c,recovered:f}=Object.assign(s,e),u=(r.x===i?0:2)|Number(r.y&ve),a=new Zt(i,n);o&&a.hasHighS()&&(a=a.normalizeS(),u^=1);let h=c?a.toDERRawBytes():a.toCompactRawBytes();return f?[h,u]:h}async function l_(t,e,r={}){return sy(await a_(t,e,r.extraEntropy),r)}Z.sign=l_;function p_(t,e,r={}){return sy(c_(t,e,r.extraEntropy),r)}Z.signSync=p_;var d_={strict:!0};function y_(t,e,r,i=d_){let n;try{n=iy(t)}catch(b){return!1}let{r:s,s:o}=n;if(i.strict&&n.hasHighS())return!1;let c=o_(e);if(c===$)return!1;let f;try{f=J.fromAffine(tu(r))}catch(b){return!1}let{n:u}=ne,a=Xn(o,u),h=N(c*a,u),l=N(s*a,u),d=J.BASE.multiply(h),p=f.multiplyUnsafe(l),y=d.add(p).toAffine();return N(y.x,u)===s}Z.verify=y_;async function ru(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),i=await Z.utils.sha256(r),n=await Z.utils.sha256(So(i,i,...e));return ot(n)}async function oy(t,e,r){let i=Yn(t),n=await ru("BIP0340/challenge",i,e.toRawX(),r);return N(n,ne.n)}function iu(t){return N(t.y,_e)===$}var Ei=class{constructor(e,r){if(this.r=e,this.s=r,e<=$||r<=$||e>=ne.P||r>=ne.n)throw new Error("Invalid signature")}static fromHex(e){let r=Io(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let i=ot(r.slice(0,32)),n=ot(r.slice(32));return new Ei(i,n)}toHex(){return Vr(this.r)+Vr(this.s)}toRawBytes(){return Hr(this.toHex())}};function g_(t){return te.fromPrivateKey(t).toRawX()}async function b_(t,e,r=Z.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);e||(e=$);let{n:i}=ne,n=Io(t),s=nn(e),o=Io(r);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let c=te.fromPrivateKey(s),f=iu(c)?s:i-s,u=await ru("BIP0340/aux",o),a=f^u,h=await ru("BIP0340/nonce",Yn(a),c.toRawX(),n),l=N(h,i);if(l===$)throw new Error("sign: Creation of signature failed. k is zero");let d=te.fromPrivateKey(l),p=iu(d)?l:i-l,y=await oy(d.x,c,n),v=new Ei(d.x,N(p+y*f,i));if(!await ay(v.toRawBytes(),n,c.toRawX()))throw new Error("sign: Invalid signature produced");return v.toRawBytes()}async function ay(t,e,r){let i=t instanceof Ei?t:Ei.fromHex(t),n=typeof e=="string"?Hr(e):e,s=tu(r),o=await oy(i.r,s,n),c=te.fromPrivateKey(i.s),f=s.multiply(o),u=c.subtract(f);return!(u.equals(te.BASE)||!iu(u)||u.x!==i.r)}Z.schnorr={Signature:Ei,getPublicKey:g_,sign:b_,verify:ay};te.BASE._setWindowSize(8);var ht={node:ZE.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};Z.utils={isValidPrivateKey(t){try{return nn(t),!0}catch(e){return!1}},randomBytes:(t=32)=>{if(ht.web)return ht.web.getRandomValues(new Uint8Array(t));if(ht.node){let{randomBytes:e}=ht.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){let e=Z.utils.randomBytes(32),r=ot(e);if(rn(r)&&r!==ve)return e}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},bytesToHex:xi,sha256:async t=>{if(ht.web){let e=await ht.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(ht.node){let{createHash:e}=ht.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(ht.web){let r=await ht.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),i=So(...e),n=await ht.web.subtle.sign("HMAC",r,i);return new Uint8Array(n)}else if(ht.node){let{createHmac:r}=ht.node,i=r("sha256",t);for(let n of e)i.update(n);return Uint8Array.from(i.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=te.BASE){let r=e===te.BASE?e:new te(e.x,e.y);return r._setWindowSize(t),r.multiply(tn),r}}});var fy=m((uR,uy)=>{"use strict";var Jn=le(),zr=nu(),{sha256:cy}=(Rt(),dt);uy.exports=()=>{let t=32;function e(){return zr.utils.randomPrivateKey()}async function r(u,a){let{digest:h}=await cy.digest(a);try{return await zr.sign(h,u)}catch(l){throw Jn(l,"ERR_INVALID_INPUT")}}async function i(u,a,h){try{let{digest:l}=await cy.digest(h);return zr.verify(a,l,u)}catch(l){throw Jn(l,"ERR_INVALID_INPUT")}}function n(u){return zr.Point.fromHex(u).toRawBytes(!0)}function s(u){return zr.Point.fromHex(u).toRawBytes(!1)}function o(u){try{zr.getPublicKey(u,!0)}catch(a){throw Jn(a,"ERR_INVALID_PRIVATE_KEY")}}function c(u){try{zr.Point.fromHex(u)}catch(a){throw Jn(a,"ERR_INVALID_PUBLIC_KEY")}}function f(u){try{return zr.getPublicKey(u,!0)}catch(a){throw Jn(a,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:i,compressPublicKey:n,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:c,computePublicKey:f}}});var dy=m((fR,py)=>{"use strict";var{sha256:hy}=(Rt(),dt),v_=le(),{equals:ly}=(kt(),Ot),{toString:m_}=(qe(),Ue),w_=go();py.exports=(t,e,r)=>{r=r||fy()();class i{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,a){return r.hashAndVerify(this._key,a,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return ly(this.bytes,u.bytes)}async hash(){let{bytes:u}=await hy.digest(this.bytes);return u}}class n{constructor(u,a){this._key=u,this._publicKey=a||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return ly(this.bytes,u.bytes)}async hash(){let{bytes:u}=await hy.digest(this.bytes);return u}async id(){let u=await this.public.hash();return m_(u,"base58btc")}async export(u,a="libp2p-key"){if(a==="libp2p-key")return w_.export(this.bytes,u);throw v_(new Error(`export format '${a}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(f){return new n(f)}function o(f){return new i(f)}async function c(){let f=await r.generateKey();return new n(f)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:c}}});var gy=m((hR,yy)=>{"use strict";yy.exports={SHA1:20,SHA256:32,SHA512:64}});var my=m(vy=>{"use strict";var by=qn(),x_=gy(),E_={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},__=async(t,e)=>{let r=await by.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};vy.create=async function(t,e){let r=E_[t],i=await by.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(n){return __(i,n)},length:x_[t]}}});var Sy=m((pR,_y)=>{"use strict";var wy=le(),{concat:xy}=(Dt(),Pt),{fromString:S_}=(ke(),Oe),I_=my(),Ey={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};_y.exports=async(t,e,r)=>{let i=Ey[t];if(!i){let x=Object.keys(Ey).join(" / ");throw wy(new Error(`unknown cipher type '${t}'. Must be ${x}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw wy(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,c=S_("key expansion"),f=2*(s+n+o),u=await I_.create(e,r),a=await u.digest(c),h=[],l=0;for(;l<f;){let x=await u.digest(xy([a,c])),I=x.length;l+I>f&&(I=f-l),h.push(x),l+=I,a=await u.digest(a)}let d=f/2,p=xy(h),y=p.slice(0,d),v=p.slice(d,f),b=x=>({iv:x.slice(0,s),cipherKey:x.slice(s,s+n),macKey:x.slice(s+n)});return{k1:b(y),k2:b(v)}}});var Ay=m((dR,Iy)=>{"use strict";var A_=le();Iy.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw A_(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var Dy=m(Py=>{"use strict";var B_=le(),Zn=qn(),{base64urlToBuffer:By}=yo(),R_=Ay(),{toString:su}=(qe(),Ue),{concat:C_}=(Dt(),Pt),{equals:T_}=(kt(),Ot),Ry={"P-256":256,"P-384":384,"P-521":521};Py.generateEphmeralKeyPair=async function(t){R_(Object.keys(Ry),t);let e=await Zn.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(n,s)=>{let o;s?o=await Zn.get().subtle.importKey("jwk",D_(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let c=[await Zn.get().subtle.importKey("jwk",Ty(t,n),{name:"ECDH",namedCurve:t},!1,[]),o],f=await Zn.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:c[0]},c[1],Ry[t]);return new Uint8Array(f,f.byteOffset,f.byteLength)},i=await Zn.get().subtle.exportKey("jwk",e.publicKey);return{key:P_(i),genSharedKey:r}};var Cy={"P-256":32,"P-384":48,"P-521":66};function P_(t){let e=Cy[t.crv];return C_([Uint8Array.from([4]),By(t.x,e),By(t.y,e)],1+e*2)}function Ty(t,e){let r=Cy[t];if(T_(!e.slice(0,1),Uint8Array.from([4])))throw B_(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:su(e.slice(1,r+1),"base64url"),y:su(e.slice(1+r),"base64url"),ext:!0}}var D_=(t,e)=>({...Ty(t,e.public),d:su(e.private,"base64url")})});var ky=m((gR,Oy)=>{"use strict";var O_=Dy();Oy.exports=async t=>O_.generateEphmeralKeyPair(t)});var My=m((bR,Ly)=>{"use strict";var er=Xs();di();Kc();var ou=Q(),es=le(),{fromString:k_}=(ke(),Oe),N_=fd(),wt={rsa:Od(),ed25519:$d(),secp256k1:dy()(er,Vc())},Bo={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function sn(t){let e=wt[t.toLowerCase()];if(!e){let r=Object.keys(wt).join(" / ");throw es(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var L_=async(t,e)=>sn(t).generateKeyPair(e),M_=async(t,e,r)=>{let i=sn(t);if(t.toLowerCase()!=="ed25519")throw es(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,r)},K_=t=>{let e=er.PublicKey.decode(t),r=e.Data;switch(e.Type){case er.KeyType.RSA:return wt.rsa.unmarshalRsaPublicKey(r);case er.KeyType.Ed25519:return wt.ed25519.unmarshalEd25519PublicKey(r);case er.KeyType.Secp256k1:if(wt.secp256k1)return wt.secp256k1.unmarshalSecp256k1PublicKey(r);throw es(new Error(Bo.message),Bo.code);default:sn(e.Type)}},F_=(t,e)=>(e=(e||"rsa").toLowerCase(),sn(e),t.bytes),Ny=async t=>{let e=er.PrivateKey.decode(t),r=e.Data;switch(e.Type){case er.KeyType.RSA:return wt.rsa.unmarshalRsaPrivateKey(r);case er.KeyType.Ed25519:return wt.ed25519.unmarshalEd25519PrivateKey(r);case er.KeyType.Secp256k1:if(wt.secp256k1)return wt.secp256k1.unmarshalSecp256k1PrivateKey(r);throw es(new Error(Bo.message),Bo.code);default:sn(e.Type)}},U_=(t,e)=>(e=(e||"rsa").toLowerCase(),sn(e),t.bytes),q_=async(t,e)=>{try{let n=await N_.import(t,e);return Ny(n)}catch(n){}let r=ou.pki.decryptRsaPrivateKey(t,e);if(r===null)throw es(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=ou.asn1.toDer(ou.pki.privateKeyToAsn1(r));return i=k_(i.getBytes(),"ascii"),wt.rsa.unmarshalRsaPrivateKey(i)};Ly.exports={supportedKeys:wt,keysPBM:er,keyStretcher:Sy(),generateEphemeralKeyPair:ky(),generateKeyPair:L_,generateKeyPairFromSeed:M_,unmarshalPublicKey:K_,marshalPublicKey:F_,unmarshalPrivateKey:Ny,marshalPrivateKey:U_,import:q_}});var Ky=m((vR,au)=>{"use strict";function G_(t,{className:e,symbolName:r}){let i=Symbol.for(r),n={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function V_(t,{className:e,symbolName:r,withoutNew:i}){let n=Symbol.for(r),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let c=t.call(this,...o)||this;return c&&!c[n]&&Object.defineProperty(c,n,{value:!0}),c}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}au.exports=G_;au.exports.proto=V_});var qy=m((mR,Uy)=>{"use strict";var on=ni(),Fy=on.Reader,j_=on.Writer,Ce=on.util,ts=on.roots["libp2p-peer-id"]||(on.roots["libp2p-peer-id"]={});ts.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.id=Ce.newBuffer([]),t.prototype.pubKey=Ce.newBuffer([]),t.prototype.privKey=Ce.newBuffer([]),t.encode=function(r,i){return i||(i=j_.create()),i.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&i.uint32(26).bytes(r.privKey),i},t.decode=function(r,i){r instanceof Fy||(r=Fy.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new ts.PeerIdProto;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw Ce.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ts.PeerIdProto)return r;var i=new ts.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?Ce.base64.decode(r.id,i.id=Ce.newBuffer(Ce.base64.length(r.id)),0):r.id.length&&(i.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?Ce.base64.decode(r.pubKey,i.pubKey=Ce.newBuffer(Ce.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?Ce.base64.decode(r.privKey,i.privKey=Ce.newBuffer(Ce.base64.length(r.privKey)),0):r.privKey.length&&(i.privKey=r.privKey)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=Ce.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Ce.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=Ce.newBuffer(n.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(n.id=i.bytes===String?Ce.base64.encode(r.id,0,r.id.length):i.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Ce.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?Ce.base64.encode(r.privKey,0,r.privKey.length):i.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,on.util.toJSONOptions)},t}();Uy.exports=ts});var an=m((He,Yy)=>{"use strict";var{CID:cu}=(lc(),Kl),H_=(Bn(),An),z_=(cc(),Vs),W_=(hi(),fi),$_=(li(),Dr),{base58btc:uu}=(hi(),fi),{base32:Y_}=(Bn(),An),{base16:Gy}=(ac(),Gs),rs=(Pn(),Hs),tr=My(),Q_=Ky(),{PeerIdProto:Vy}=qy(),{equals:_i}=(kt(),Ot),{fromString:is}=(ke(),Oe),{toString:X_}=(qe(),Ue),{identity:Ro}=(On(),zi),jy={...H_,...z_,...W_,...$_},J_=Object.keys(jy).reduce((t,e)=>t.or(jy[e]),Y_.decoder),Z_=112,Hy=114,zy=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&i&&!_i(r.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=uu.encode(this.id).substring(1),this._privKey=r,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=rs.decode(this.id);e.code===Ro.code&&(this._pubKey=tr.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return tr.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return tr.marshalPrivateKey(this.privKey)}marshal(e){return Vy.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:$y(this.marshalPrivKey()),pubKey:$y(this.marshalPubKey())}}toHexString(){return Gy.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=cu.createV1(Hy,rs.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return _i(this.id,e);if(e.id)return _i(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&_i(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(rs.decode(this.id).code===Ro.code)return!0}catch(e){}return!1}},rr=Q_(zy,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});He=Yy.exports=rr;var ns=t=>t.bytes.length<=42?rs.create(Ro.code,t.bytes).bytes:t.hash(),fu=async(t,e)=>{let r=await ns(e);return new rr(r,t,e)};He.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await tr.generateKeyPair(t.keyType,t.bits);return fu(e,e.public)};He.createFromHexString=t=>new rr(Gy.decode("f"+t));He.createFromBytes=t=>{try{let e=cu.decode(t);if(!Wy(e))throw new Error("Supplied PeerID CID is invalid");return He.createFromCID(e)}catch{if(rs.decode(t).code!==Ro.code)throw new Error("Supplied PeerID CID is invalid");return new rr(t)}};He.createFromB58String=t=>He.createFromBytes(uu.decode("z"+t));var Wy=t=>t.code===Hy||t.code===Z_;He.createFromCID=t=>{if(t=cu.asCID(t),!t||!Wy(t))throw new Error("Supplied PeerID CID is invalid");return new rr(t.multihash.bytes)};He.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=is(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await tr.unmarshalPublicKey(e);return fu(void 0,r)};He.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=is(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await tr.unmarshalPrivateKey(t);return fu(e,e.public)};He.createFromJSON=async t=>{let e=uu.decode("z"+t.id),r=t.privKey&&is(t.privKey,"base64pad"),i=t.pubKey&&is(t.pubKey,"base64pad"),n=i&&await tr.unmarshalPublicKey(i);if(!r)return new rr(e,void 0,n);let s=await tr.unmarshalPrivateKey(r),o=await ns(s.public),c;if(n&&(c=await ns(n)),n&&!_i(o,c))throw new Error("Public and private key do not match");if(e&&!_i(o,e))throw new Error("Id and private key do not match");return new rr(e,s,n)};He.createFromProtobuf=async t=>{typeof t=="string"&&(t=is(t,"base16"));let{id:e,privKey:r,pubKey:i}=Vy.decode(t);r=r?await tr.unmarshalPrivateKey(r):!1,i=i?await tr.unmarshalPublicKey(i):!1;let n,s;if(r&&(s=await ns(r.public)),i&&(n=await ns(i)),r){if(i&&!_i(s,n))throw new Error("Public and private key do not match");return new rr(s,r,r.public)}if(i)return new rr(n,void 0,i);if(e)return new rr(e);throw new Error("Protobuf did not contain any usable key material")};He.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),He.createFromBytes(J_.decode(t)));He.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function $y(t){if(t)return X_(t,"base64pad")}});var hu=m((wR,Jy)=>{"use strict";var eS=fl(),{toString:tS}=(qe(),Ue),{fromString:Qy}=(ke(),Oe),Xy=an(),{sha256:rS}=(Rt(),dt),iS=()=>eS(8),nS=(t,e)=>{let r;t instanceof Uint8Array?r=Xy.createFromBytes(t).id:r=Xy.parse(t).id;let i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i},sS=t=>rS.encode(t),oS=(t,e)=>{let r;Array.isArray(e)?r=i=>e.indexOf(i)>-1:r=i=>e.has(i);for(let i of t)if(r(i))return!0;return!1},aS=t=>Array.isArray(t)?t:[t],cS=(t,e)=>{let r=Object.assign({},t);return t.from instanceof Uint8Array&&(r.from=tS(t.from,"base58btc")),e&&(r.receivedFrom=e),r},uS=t=>{let e=Object.assign({},t);return typeof t.from=="string"&&(e.from=Qy(t.from,"base58btc")),typeof t.data=="string"&&(e.data=Qy(t.data)),e};Jy.exports={randomSeqno:iS,msgId:nS,noSignMsgId:sS,anyMatch:oS,ensureArray:aS,normalizeInRpcMessage:cS,normalizeOutRpcMessage:uS}});var ig=m((xR,rg)=>{"use strict";var lu=an(),{RPC:Zy}=Ia(),{concat:eg}=(Dt(),Pt),{fromString:fS}=(ke(),Oe),pu=fS("libp2p-pubsub:"),{normalizeOutRpcMessage:hS}=hu();async function lS(t,e){let r=eg([pu,Zy.Message.encode(hS(e)).finish()]),i=await t.privKey.sign(r);return{...e,signature:i,key:t.pubKey.bytes}}async function pS(t){if(!t.signature)throw new Error("Message must contain a signature to be verified");if(!t.from)throw new Error("Message must contain a from property to be verified");let e=eg([pu,Zy.Message.encode({...t,from:lu.createFromB58String(t.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await tg(t)).verify(e,t.signature)}async function tg(t){if(!t.from)throw new Error("Could not get the public key from the originator id");let e=lu.createFromB58String(t.from);if(t.key){let r=await lu.createFromPubKey(t.key);if(r.equals(e))return r.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}rg.exports={messagePublicKey:tg,signMessage:lS,SignPrefix:pu,verifySignature:pS}});var ag=m((ER,og)=>{"use strict";var ng=mn(),{EventEmitter:dS}=ia(),at=le(),{pipe:yS}=sa(),{default:gS}=lf(),bS=_f(),{codes:Nt}=As(),{RPC:sg}=Ia(),vS=sl(),{SignaturePolicy:gr}=al(),Wr=hu(),{signMessage:mS,verifySignature:wS}=ig(),Co=class extends dS{constructor({debugName:e,multicodecs:r,libp2p:i,globalSignaturePolicy:n=gr.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1,messageProcessingConcurrency:c=10}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!r)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(ng(e),{err:ng(`${e}:error`)}),this.multicodecs=Wr.ensureArray(r),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!gr[n])throw at(new Error("Invalid global signature policy"),Nt.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this.queue=new gS({concurrency:c}),this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}async start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new bS({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=await this.registrar.register(e),this.log("started"),this.started=!0}async stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:r,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),c=o.attachInboundStream(r);this._processMessages(s,c,o)}async _onPeerConnected(e,r){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await r.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,r){let i=e.toB58String();this.log("connection ended",i,r?r.message:""),this._removePeer(e)}_addPeer(e,r){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new vS({id:e,protocol:r});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let r=e.toB58String(),i=this.peers.get(r);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",r),this.peers.delete(r);for(let n of this.topics.values())n.delete(r);return i}}async _processMessages(e,r,i){try{await yS(r,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),c=this._decodeRpc(o);(async()=>{try{await this._processRpc(e,i,c)}catch(f){this.log.err(f)}})()}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,r,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;return n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",r.id,n)),this._acceptFrom(e)?(s.length&&this.queue.addAll(s.map(o=>async()=>{if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");return}try{let c=Wr.normalizeInRpcMessage(o,e);await this._processRpcMessage(c)}catch(c){this.log.err(c)}})),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,r){let i=r.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),r.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(r){this.log("Message is invalid, dropping it. %O",r);return}return this._emitMessage(e),this._publish(Wr.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(r=>{this.subscriptions.has(r)&&this.emit(r,e)})}getMsgId(e){let r=this.globalSignaturePolicy;switch(r){case gr.StrictSign:return Wr.msgId(e.from,e.seqno);case gr.StrictNoSign:return Wr.noSignMsgId(e.data);default:throw at(new Error("Cannot get message id: unhandled signature policy: "+r),Nt.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return sg.decode(e)}_encodeRpc(e){return sg.encode(e).finish()}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(r))}_sendSubscriptions(e,r,i){return this._sendRpc(e,{subscriptions:r.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let r=this.globalSignaturePolicy;switch(r){case gr.StrictNoSign:if(e.from)throw at(new Error("StrictNoSigning: from should not be present"),Nt.ERR_UNEXPECTED_FROM);if(e.signature)throw at(new Error("StrictNoSigning: signature should not be present"),Nt.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw at(new Error("StrictNoSigning: key should not be present"),Nt.ERR_UNEXPECTED_KEY);if(e.seqno)throw at(new Error("StrictNoSigning: seqno should not be present"),Nt.ERR_UNEXPECTED_SEQNO);break;case gr.StrictSign:if(!e.signature)throw at(new Error("StrictSigning: Signing required and no signature was present"),Nt.ERR_MISSING_SIGNATURE);if(!e.seqno)throw at(new Error("StrictSigning: Signing required and no seqno was present"),Nt.ERR_MISSING_SEQNO);if(!await wS(e))throw at(new Error("StrictSigning: Invalid message signature"),Nt.ERR_INVALID_SIGNATURE);break;default:throw at(new Error("Cannot validate message: unhandled signature policy: "+r),Nt.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let r=this.globalSignaturePolicy;switch(r){case gr.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=Wr.randomSeqno(),mS(this.peerId,e);case gr.StrictNoSign:return Promise.resolve(e);default:throw at(new Error("Cannot build message: unhandled signature policy: "+r),Nt.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw at(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw at(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let r=this.topics.get(e);return r?Array.from(r):[]}async publish(e,r){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,r);let n={receivedFrom:this.peerId.toB58String(),data:r,topicIDs:[e]},s=await this._buildMessage(n),o=Wr.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw at(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};Co.utils=Wr;Co.SignaturePolicy=gr;og.exports=Co});var cg=m(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.createGossipRpc=void 0;function xS(t=[],e={}){return{subscriptions:[],msgs:t,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}To.createGossipRpc=xS});var ug=m(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.shuffle=void 0;function ES(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let i=e(),n=t[r];t[r]=t[i],t[i]=n}return t}Po.shuffle=ES});var $r=m(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.ACCEPT_FROM_WHITELIST_DURATION_MS=C.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=C.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=C.ERR_TOPIC_VALIDATOR_IGNORE=C.ERR_TOPIC_VALIDATOR_REJECT=C.TimeCacheDuration=C.GossipsubSeenTTL=C.GossipsubIWantFollowupTime=C.GossipsubMaxIHaveMessages=C.GossipsubMaxIHaveLength=C.GossipsubGraftFloodThreshold=C.GossipsubOpportunisticGraftPeers=C.GossipsubOpportunisticGraftTicks=C.GossipsubDirectConnectInitialDelay=C.GossipsubDirectConnectTicks=C.GossipsubConnectionTimeout=C.GossipsubMaxPendingConnections=C.GossipsubConnectors=C.GossipsubPruneBackoffTicks=C.GossipsubPruneBackoff=C.GossipsubPrunePeers=C.GossipsubFanoutTTL=C.GossipsubHeartbeatInterval=C.GossipsubHeartbeatInitialDelay=C.GossipsubGossipRetransmission=C.GossipsubGossipFactor=C.GossipsubDlazy=C.GossipsubHistoryGossip=C.GossipsubHistoryLength=C.GossipsubDout=C.GossipsubDscore=C.GossipsubDhi=C.GossipsubDlo=C.GossipsubD=C.GossipsubIDv11=C.GossipsubIDv10=C.FloodsubID=C.minute=C.second=void 0;C.second=1e3;C.minute=60*C.second;C.FloodsubID="/floodsub/1.0.0";C.GossipsubIDv10="/meshsub/1.0.0";C.GossipsubIDv11="/meshsub/1.1.0";C.GossipsubD=6;C.GossipsubDlo=4;C.GossipsubDhi=12;C.GossipsubDscore=4;C.GossipsubDout=2;C.GossipsubHistoryLength=5;C.GossipsubHistoryGossip=3;C.GossipsubDlazy=6;C.GossipsubGossipFactor=.25;C.GossipsubGossipRetransmission=3;C.GossipsubHeartbeatInitialDelay=100;C.GossipsubHeartbeatInterval=C.second;C.GossipsubFanoutTTL=C.minute;C.GossipsubPrunePeers=16;C.GossipsubPruneBackoff=C.minute;C.GossipsubPruneBackoffTicks=15;C.GossipsubConnectors=8;C.GossipsubMaxPendingConnections=128;C.GossipsubConnectionTimeout=30*C.second;C.GossipsubDirectConnectTicks=300;C.GossipsubDirectConnectInitialDelay=C.second;C.GossipsubOpportunisticGraftTicks=60;C.GossipsubOpportunisticGraftPeers=2;C.GossipsubGraftFloodThreshold=10*C.second;C.GossipsubMaxIHaveLength=5e3;C.GossipsubMaxIHaveMessages=10;C.GossipsubIWantFollowupTime=3*C.second;C.GossipsubSeenTTL=30*C.second;C.TimeCacheDuration=120*1e3;C.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";C.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE";C.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0;C.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128;C.ACCEPT_FROM_WHITELIST_DURATION_MS=1e3});var hg=m(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.hasGossipProtocol=void 0;var fg=$r();function _S(t){return t===fg.GossipsubIDv10||t===fg.GossipsubIDv11}Do.hasGossipProtocol=_S});var lg=m(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});cn.messageIdFromString=cn.messageIdToString=void 0;var SS=(ke(),Oe),IS=(qe(),Ue);function AS(t){return IS.toString(t,"base64")}cn.messageIdToString=AS;function BS(t){return SS.fromString(t,"base64")}cn.messageIdFromString=BS});var un=m(ir=>{"use strict";var RS=ir&&ir.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Oo=ir&&ir.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&RS(e,t,r)};Object.defineProperty(ir,"__esModule",{value:!0});Oo(cg(),ir);Oo(ug(),ir);Oo(hg(),ir);Oo(lg(),ir)});var dg=m(fn=>{"use strict";var CS=fn&&fn.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(i.next(a))}catch(h){o(h)}}function f(a){try{u(i.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):n(a.value).then(c,f)}u((i=i.apply(t,e||[])).next())})};Object.defineProperty(fn,"__esModule",{value:!0});fn.MessageCache=void 0;var du=un(),pg=class{constructor(e,r){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let i=0;i<r;i++)this.history[i]=[];this.gossip=e}put(e,r){return CS(this,void 0,void 0,function*(){this.msgs.set(r,e);let i=du.messageIdFromString(r);this.history[0].push({msgId:i,topics:e.topicIDs})})}get(e){return this.msgs.get(du.messageIdToString(e))}getForPeer(e,r){let i=this.msgs.get(e);if(!i)return[void 0,0];let n=this.peertx.get(e);n||(n=new Map,this.peertx.set(e,n));let s=(n.get(r)||0)+1;return n.set(r,s),[i,s]}getGossipIDs(e){let r=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){r.push(n.msgId);break}});return r}shift(){this.history[this.history.length-1].forEach(r=>{let i=du.messageIdToString(r.msgId);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};fn.MessageCache=pg});var gg=m((yg,ss)=>{(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Nu=="function"&&typeof ss=="object"&&ss&&ss.exports&&(ss.exports=e(ni()))})(yg,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots.default||(t.roots.default={});return n.RPC=function(){function s(c){if(this.subscriptions=[],this.msgs=[],c)for(var f=Object.keys(c),u=0;u<f.length;++u)c[f[u]]!=null&&(this[f[u]]=c[f[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(f,u){if(u||(u=r.create()),f.subscriptions!=null&&f.subscriptions.length)for(var a=0;a<f.subscriptions.length;++a)n.RPC.SubOpts.encode(f.subscriptions[a],u.uint32(10).fork()).ldelim();if(f.msgs!=null&&f.msgs.length)for(var a=0;a<f.msgs.length;++a)n.RPC.Message.encode(f.msgs[a],u.uint32(18).fork()).ldelim();return f.control!=null&&Object.hasOwnProperty.call(f,"control")&&n.RPC.ControlMessage.encode(f.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(f,u){f instanceof e||(f=e.create(f));for(var a=u===void 0?f.len:f.pos+u,h=new n.RPC;f.pos<a;){var l=f.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(n.RPC.SubOpts.decode(f,f.uint32()));break;case 2:h.msgs&&h.msgs.length||(h.msgs=[]),h.msgs.push(n.RPC.Message.decode(f,f.uint32()));break;case 3:h.control=n.RPC.ControlMessage.decode(f,f.uint32());break;default:f.skipType(l&7);break}}return h},s.fromObject=function(f){if(f instanceof n.RPC)return f;var u=new n.RPC;if(f.subscriptions){if(!Array.isArray(f.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var a=0;a<f.subscriptions.length;++a){if(typeof f.subscriptions[a]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[a]=n.RPC.SubOpts.fromObject(f.subscriptions[a])}}if(f.msgs){if(!Array.isArray(f.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var a=0;a<f.msgs.length;++a){if(typeof f.msgs[a]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[a]=n.RPC.Message.fromObject(f.msgs[a])}}if(f.control!=null){if(typeof f.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(f.control)}return u},s.toObject=function(f,u){u||(u={});var a={};if((u.arrays||u.defaults)&&(a.subscriptions=[],a.msgs=[]),f.subscriptions&&f.subscriptions.length){a.subscriptions=[];for(var h=0;h<f.subscriptions.length;++h)a.subscriptions[h]=n.RPC.SubOpts.toObject(f.subscriptions[h],u)}if(f.msgs&&f.msgs.length){a.msgs=[];for(var h=0;h<f.msgs.length;++h)a.msgs[h]=n.RPC.Message.toObject(f.msgs[h],u)}return f.control!=null&&f.hasOwnProperty("control")&&(a.control=n.RPC.ControlMessage.toObject(f.control,u),u.oneofs&&(a._control="control")),a},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function c(u){if(u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.subscribe=null,c.prototype.topicID=null;var f;return Object.defineProperty(c.prototype,"_subscribe",{get:i.oneOfGetter(f=["subscribe"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_topicID",{get:i.oneOfGetter(f=["topicID"]),set:i.oneOfSetter(f)}),c.encode=function(a,h){return h||(h=r.create()),a.subscribe!=null&&Object.hasOwnProperty.call(a,"subscribe")&&h.uint32(8).bool(a.subscribe),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(18).string(a.topicID),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new n.RPC.SubOpts;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.subscribe=a.bool();break;case 2:d.topicID=a.string();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof n.RPC.SubOpts)return a;var h=new n.RPC.SubOpts;return a.subscribe!=null&&(h.subscribe=Boolean(a.subscribe)),a.topicID!=null&&(h.topicID=String(a.topicID)),h},c.toObject=function(a,h){h||(h={});var l={};return a.subscribe!=null&&a.hasOwnProperty("subscribe")&&(l.subscribe=a.subscribe,h.oneofs&&(l._subscribe="subscribe")),a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.Message=function(){function c(u){if(this.topicIDs=[],u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.from=null,c.prototype.data=null,c.prototype.seqno=null,c.prototype.topicIDs=i.emptyArray,c.prototype.signature=null,c.prototype.key=null;var f;return Object.defineProperty(c.prototype,"_from",{get:i.oneOfGetter(f=["from"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_data",{get:i.oneOfGetter(f=["data"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_seqno",{get:i.oneOfGetter(f=["seqno"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_signature",{get:i.oneOfGetter(f=["signature"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_key",{get:i.oneOfGetter(f=["key"]),set:i.oneOfSetter(f)}),c.encode=function(a,h){if(h||(h=r.create()),a.from!=null&&Object.hasOwnProperty.call(a,"from")&&h.uint32(10).bytes(a.from),a.data!=null&&Object.hasOwnProperty.call(a,"data")&&h.uint32(18).bytes(a.data),a.seqno!=null&&Object.hasOwnProperty.call(a,"seqno")&&h.uint32(26).bytes(a.seqno),a.topicIDs!=null&&a.topicIDs.length)for(var l=0;l<a.topicIDs.length;++l)h.uint32(34).string(a.topicIDs[l]);return a.signature!=null&&Object.hasOwnProperty.call(a,"signature")&&h.uint32(42).bytes(a.signature),a.key!=null&&Object.hasOwnProperty.call(a,"key")&&h.uint32(50).bytes(a.key),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new n.RPC.Message;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.from=a.bytes();break;case 2:d.data=a.bytes();break;case 3:d.seqno=a.bytes();break;case 4:d.topicIDs&&d.topicIDs.length||(d.topicIDs=[]),d.topicIDs.push(a.string());break;case 5:d.signature=a.bytes();break;case 6:d.key=a.bytes();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof n.RPC.Message)return a;var h=new n.RPC.Message;if(a.from!=null&&(typeof a.from=="string"?i.base64.decode(a.from,h.from=i.newBuffer(i.base64.length(a.from)),0):a.from.length&&(h.from=a.from)),a.data!=null&&(typeof a.data=="string"?i.base64.decode(a.data,h.data=i.newBuffer(i.base64.length(a.data)),0):a.data.length&&(h.data=a.data)),a.seqno!=null&&(typeof a.seqno=="string"?i.base64.decode(a.seqno,h.seqno=i.newBuffer(i.base64.length(a.seqno)),0):a.seqno.length&&(h.seqno=a.seqno)),a.topicIDs){if(!Array.isArray(a.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");h.topicIDs=[];for(var l=0;l<a.topicIDs.length;++l)h.topicIDs[l]=String(a.topicIDs[l])}return a.signature!=null&&(typeof a.signature=="string"?i.base64.decode(a.signature,h.signature=i.newBuffer(i.base64.length(a.signature)),0):a.signature.length&&(h.signature=a.signature)),a.key!=null&&(typeof a.key=="string"?i.base64.decode(a.key,h.key=i.newBuffer(i.base64.length(a.key)),0):a.key.length&&(h.key=a.key)),h},c.toObject=function(a,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.topicIDs=[]),a.from!=null&&a.hasOwnProperty("from")&&(l.from=h.bytes===String?i.base64.encode(a.from,0,a.from.length):h.bytes===Array?Array.prototype.slice.call(a.from):a.from,h.oneofs&&(l._from="from")),a.data!=null&&a.hasOwnProperty("data")&&(l.data=h.bytes===String?i.base64.encode(a.data,0,a.data.length):h.bytes===Array?Array.prototype.slice.call(a.data):a.data,h.oneofs&&(l._data="data")),a.seqno!=null&&a.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?i.base64.encode(a.seqno,0,a.seqno.length):h.bytes===Array?Array.prototype.slice.call(a.seqno):a.seqno,h.oneofs&&(l._seqno="seqno")),a.topicIDs&&a.topicIDs.length){l.topicIDs=[];for(var d=0;d<a.topicIDs.length;++d)l.topicIDs[d]=a.topicIDs[d]}return a.signature!=null&&a.hasOwnProperty("signature")&&(l.signature=h.bytes===String?i.base64.encode(a.signature,0,a.signature.length):h.bytes===Array?Array.prototype.slice.call(a.signature):a.signature,h.oneofs&&(l._signature="signature")),a.key!=null&&a.hasOwnProperty("key")&&(l.key=h.bytes===String?i.base64.encode(a.key,0,a.key.length):h.bytes===Array?Array.prototype.slice.call(a.key):a.key,h.oneofs&&(l._key="key")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlMessage=function(){function c(f){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],f)for(var u=Object.keys(f),a=0;a<u.length;++a)f[u[a]]!=null&&(this[u[a]]=f[u[a]])}return c.prototype.ihave=i.emptyArray,c.prototype.iwant=i.emptyArray,c.prototype.graft=i.emptyArray,c.prototype.prune=i.emptyArray,c.encode=function(u,a){if(a||(a=r.create()),u.ihave!=null&&u.ihave.length)for(var h=0;h<u.ihave.length;++h)n.RPC.ControlIHave.encode(u.ihave[h],a.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var h=0;h<u.iwant.length;++h)n.RPC.ControlIWant.encode(u.iwant[h],a.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var h=0;h<u.graft.length;++h)n.RPC.ControlGraft.encode(u.graft[h],a.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var h=0;h<u.prune.length;++h)n.RPC.ControlPrune.encode(u.prune[h],a.uint32(34).fork()).ldelim();return a},c.decode=function(u,a){u instanceof e||(u=e.create(u));for(var h=a===void 0?u.len:u.pos+a,l=new n.RPC.ControlMessage;u.pos<h;){var d=u.uint32();switch(d>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(d&7);break}}return l},c.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var a=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");a.ihave=[];for(var h=0;h<u.ihave.length;++h){if(typeof u.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");a.ihave[h]=n.RPC.ControlIHave.fromObject(u.ihave[h])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");a.iwant=[];for(var h=0;h<u.iwant.length;++h){if(typeof u.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");a.iwant[h]=n.RPC.ControlIWant.fromObject(u.iwant[h])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");a.graft=[];for(var h=0;h<u.graft.length;++h){if(typeof u.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");a.graft[h]=n.RPC.ControlGraft.fromObject(u.graft[h])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");a.prune=[];for(var h=0;h<u.prune.length;++h){if(typeof u.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");a.prune[h]=n.RPC.ControlPrune.fromObject(u.prune[h])}}return a},c.toObject=function(u,a){a||(a={});var h={};if((a.arrays||a.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),u.ihave&&u.ihave.length){h.ihave=[];for(var l=0;l<u.ihave.length;++l)h.ihave[l]=n.RPC.ControlIHave.toObject(u.ihave[l],a)}if(u.iwant&&u.iwant.length){h.iwant=[];for(var l=0;l<u.iwant.length;++l)h.iwant[l]=n.RPC.ControlIWant.toObject(u.iwant[l],a)}if(u.graft&&u.graft.length){h.graft=[];for(var l=0;l<u.graft.length;++l)h.graft[l]=n.RPC.ControlGraft.toObject(u.graft[l],a)}if(u.prune&&u.prune.length){h.prune=[];for(var l=0;l<u.prune.length;++l)h.prune[l]=n.RPC.ControlPrune.toObject(u.prune[l],a)}return h},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlIHave=function(){function c(u){if(this.messageIDs=[],u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.topicID=null,c.prototype.messageIDs=i.emptyArray;var f;return Object.defineProperty(c.prototype,"_topicID",{get:i.oneOfGetter(f=["topicID"]),set:i.oneOfSetter(f)}),c.encode=function(a,h){if(h||(h=r.create()),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(10).string(a.topicID),a.messageIDs!=null&&a.messageIDs.length)for(var l=0;l<a.messageIDs.length;++l)h.uint32(18).bytes(a.messageIDs[l]);return h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new n.RPC.ControlIHave;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.topicID=a.string();break;case 2:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(a.bytes());break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof n.RPC.ControlIHave)return a;var h=new n.RPC.ControlIHave;if(a.topicID!=null&&(h.topicID=String(a.topicID)),a.messageIDs){if(!Array.isArray(a.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<a.messageIDs.length;++l)typeof a.messageIDs[l]=="string"?i.base64.decode(a.messageIDs[l],h.messageIDs[l]=i.newBuffer(i.base64.length(a.messageIDs[l])),0):a.messageIDs[l].length&&(h.messageIDs[l]=a.messageIDs[l])}return h},c.toObject=function(a,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),a.messageIDs&&a.messageIDs.length){l.messageIDs=[];for(var d=0;d<a.messageIDs.length;++d)l.messageIDs[d]=h.bytes===String?i.base64.encode(a.messageIDs[d],0,a.messageIDs[d].length):h.bytes===Array?Array.prototype.slice.call(a.messageIDs[d]):a.messageIDs[d]}return l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlIWant=function(){function c(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),a=0;a<u.length;++a)f[u[a]]!=null&&(this[u[a]]=f[u[a]])}return c.prototype.messageIDs=i.emptyArray,c.encode=function(u,a){if(a||(a=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var h=0;h<u.messageIDs.length;++h)a.uint32(10).bytes(u.messageIDs[h]);return a},c.decode=function(u,a){u instanceof e||(u=e.create(u));for(var h=a===void 0?u.len:u.pos+a,l=new n.RPC.ControlIWant;u.pos<h;){var d=u.uint32();switch(d>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(u.bytes());break;default:u.skipType(d&7);break}}return l},c.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var a=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");a.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)typeof u.messageIDs[h]=="string"?i.base64.decode(u.messageIDs[h],a.messageIDs[h]=i.newBuffer(i.base64.length(u.messageIDs[h])),0):u.messageIDs[h].length&&(a.messageIDs[h]=u.messageIDs[h])}return a},c.toObject=function(u,a){a||(a={});var h={};if((a.arrays||a.defaults)&&(h.messageIDs=[]),u.messageIDs&&u.messageIDs.length){h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)h.messageIDs[l]=a.bytes===String?i.base64.encode(u.messageIDs[l],0,u.messageIDs[l].length):a.bytes===Array?Array.prototype.slice.call(u.messageIDs[l]):u.messageIDs[l]}return h},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlGraft=function(){function c(u){if(u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.topicID=null;var f;return Object.defineProperty(c.prototype,"_topicID",{get:i.oneOfGetter(f=["topicID"]),set:i.oneOfSetter(f)}),c.encode=function(a,h){return h||(h=r.create()),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(10).string(a.topicID),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new n.RPC.ControlGraft;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.topicID=a.string();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof n.RPC.ControlGraft)return a;var h=new n.RPC.ControlGraft;return a.topicID!=null&&(h.topicID=String(a.topicID)),h},c.toObject=function(a,h){h||(h={});var l={};return a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlPrune=function(){function c(u){if(this.peers=[],u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.topicID=null,c.prototype.peers=i.emptyArray,c.prototype.backoff=null;var f;return Object.defineProperty(c.prototype,"_topicID",{get:i.oneOfGetter(f=["topicID"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_backoff",{get:i.oneOfGetter(f=["backoff"]),set:i.oneOfSetter(f)}),c.encode=function(a,h){if(h||(h=r.create()),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(10).string(a.topicID),a.peers!=null&&a.peers.length)for(var l=0;l<a.peers.length;++l)n.RPC.PeerInfo.encode(a.peers[l],h.uint32(18).fork()).ldelim();return a.backoff!=null&&Object.hasOwnProperty.call(a,"backoff")&&h.uint32(24).uint64(a.backoff),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new n.RPC.ControlPrune;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.topicID=a.string();break;case 2:d.peers&&d.peers.length||(d.peers=[]),d.peers.push(n.RPC.PeerInfo.decode(a,a.uint32()));break;case 3:d.backoff=a.uint64();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof n.RPC.ControlPrune)return a;var h=new n.RPC.ControlPrune;if(a.topicID!=null&&(h.topicID=String(a.topicID)),a.peers){if(!Array.isArray(a.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<a.peers.length;++l){if(typeof a.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=n.RPC.PeerInfo.fromObject(a.peers[l])}}return a.backoff!=null&&(i.Long?(h.backoff=i.Long.fromValue(a.backoff)).unsigned=!0:typeof a.backoff=="string"?h.backoff=parseInt(a.backoff,10):typeof a.backoff=="number"?h.backoff=a.backoff:typeof a.backoff=="object"&&(h.backoff=new i.LongBits(a.backoff.low>>>0,a.backoff.high>>>0).toNumber(!0))),h},c.toObject=function(a,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),a.peers&&a.peers.length){l.peers=[];for(var d=0;d<a.peers.length;++d)l.peers[d]=n.RPC.PeerInfo.toObject(a.peers[d],h)}return a.backoff!=null&&a.hasOwnProperty("backoff")&&(typeof a.backoff=="number"?l.backoff=h.longs===String?String(a.backoff):a.backoff:l.backoff=h.longs===String?i.Long.prototype.toString.call(a.backoff):h.longs===Number?new i.LongBits(a.backoff.low>>>0,a.backoff.high>>>0).toNumber(!0):a.backoff,h.oneofs&&(l._backoff="backoff")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.PeerInfo=function(){function c(u){if(u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.peerID=null,c.prototype.signedPeerRecord=null;var f;return Object.defineProperty(c.prototype,"_peerID",{get:i.oneOfGetter(f=["peerID"]),set:i.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_signedPeerRecord",{get:i.oneOfGetter(f=["signedPeerRecord"]),set:i.oneOfSetter(f)}),c.encode=function(a,h){return h||(h=r.create()),a.peerID!=null&&Object.hasOwnProperty.call(a,"peerID")&&h.uint32(10).bytes(a.peerID),a.signedPeerRecord!=null&&Object.hasOwnProperty.call(a,"signedPeerRecord")&&h.uint32(18).bytes(a.signedPeerRecord),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new n.RPC.PeerInfo;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.peerID=a.bytes();break;case 2:d.signedPeerRecord=a.bytes();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof n.RPC.PeerInfo)return a;var h=new n.RPC.PeerInfo;return a.peerID!=null&&(typeof a.peerID=="string"?i.base64.decode(a.peerID,h.peerID=i.newBuffer(i.base64.length(a.peerID)),0):a.peerID.length&&(h.peerID=a.peerID)),a.signedPeerRecord!=null&&(typeof a.signedPeerRecord=="string"?i.base64.decode(a.signedPeerRecord,h.signedPeerRecord=i.newBuffer(i.base64.length(a.signedPeerRecord)),0):a.signedPeerRecord.length&&(h.signedPeerRecord=a.signedPeerRecord)),h},c.toObject=function(a,h){h||(h={});var l={};return a.peerID!=null&&a.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?i.base64.encode(a.peerID,0,a.peerID.length):h.bytes===Array?Array.prototype.slice.call(a.peerID):a.peerID,h.oneofs&&(l._peerID="peerID")),a.signedPeerRecord!=null&&a.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?i.base64.encode(a.signedPeerRecord,0,a.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(a.signedPeerRecord):a.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s}(),n})});var yu=m(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.getGossipPeers=void 0;var bg=un();function TS(t,e,r,i=()=>!0){let n=t.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let c=t.peers.get(o);!c||bg.hasGossipProtocol(c.protocol)&&i(o)&&s.push(o)}),s=bg.shuffle(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}ko.getGossipPeers=TS});var mg=m(nr=>{"use strict";var PS=nr&&nr.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),DS=nr&&nr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),OS=nr&&nr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&PS(e,t,r);return DS(e,t),e};Object.defineProperty(nr,"__esModule",{value:!0});nr.Heartbeat=void 0;var gu=OS($r()),No=yu(),kS=un(),vg=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),r=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,this.gossipsub._options.heartbeatInterval)},gu.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(r),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:r,Dhi:i,Dscore:n,Dout:s,fanoutTTL:o}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let c=new Map,f=d=>{let p=c.get(d);return p===void 0&&(p=this.gossipsub.score.score(d),c.set(d,p)),p},u=new Map,a=new Map,h=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((d,p)=>{let y=b=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",b,p),this.gossipsub.score.prune(b,p),this.gossipsub._addBackoff(b,p),d.delete(b);let x=a.get(b);x?x.push(p):a.set(b,[p])},v=b=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",b,p),this.gossipsub.score.graft(b,p),d.add(b);let x=u.get(b);x?x.push(p):u.set(b,[p])};if(d.forEach(b=>{let x=f(b);x<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,x,p),y(b),h.set(b,!0))}),d.size<r){let b=this.gossipsub.backoff.get(p),x=e-d.size;No.getGossipPeers(this.gossipsub,p,x,D=>!d.has(D)&&!this.gossipsub.direct.has(D)&&(!b||!b.has(D))&&f(D)>=0).forEach(v)}if(d.size>i){let b=Array.from(d);b.sort((I,D)=>f(D)-f(I)),b=b.slice(0,n).concat(kS.shuffle(b.slice(n)));let x=0;if(b.slice(0,e).forEach(I=>{this.gossipsub.outbound.get(I)&&x++}),x<s){let I=P=>{let T=b[P];for(let U=P;U>0;U--)b[U]=b[U-1];b[0]=T};if(x>0){let P=x;for(let T=1;T<e&&P>0;T++)this.gossipsub.outbound.get(b[T])&&(I(T),P--)}let D=e-x;for(let P=e;P<b.length&&D>0;P++)this.gossipsub.outbound.get(b[P])&&(I(P),D--)}b.slice(e).forEach(y)}if(d.size>=r){let b=0;if(d.forEach(x=>{this.gossipsub.outbound.get(x)&&b++}),b<s){let x=s-b,I=this.gossipsub.backoff.get(p);No.getGossipPeers(this.gossipsub,p,x,D=>!d.has(D)&&!this.gossipsub.direct.has(D)&&(!I||!I.has(D))&&f(D)>=0).forEach(v)}}if(this.gossipsub.heartbeatTicks%gu.GossipsubOpportunisticGraftTicks==0&&d.size>1){let b=Array.from(d).sort((D,P)=>f(D)-f(P)),x=Math.floor(d.size/2),I=f(b[x]);if(I<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let D=this.gossipsub.backoff.get(p);No.getGossipPeers(this.gossipsub,p,gu.GossipsubOpportunisticGraftPeers,T=>d.has(T)&&!this.gossipsub.direct.has(T)&&(!D||!D.has(T))&&f(T)>I).forEach(T=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",T,p),v(T)})}}this.gossipsub._emitGossip(p,d)});let l=this.gossipsub._now();this.gossipsub.lastpub.forEach((d,p)=>{d+o<l&&(this.gossipsub.fanout.delete(p),this.gossipsub.lastpub.delete(p))}),this.gossipsub.fanout.forEach((d,p)=>{let y=this.gossipsub.topics.get(p);if(d.forEach(v=>{(!y.has(v)||f(v)<this.gossipsub._options.scoreThresholds.publishThreshold)&&d.delete(v)}),d.size<e){let v=e-d.size;No.getGossipPeers(this.gossipsub,p,v,x=>!d.has(x)&&!this.gossipsub.direct.has(x)&&f(x)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(x=>{d.add(x)})}this.gossipsub._emitGossip(p,d)}),this.gossipsub._sendGraftPrune(u,a,h),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};nr.Heartbeat=vg});var bu=m(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.ERR_INVALID_PEER_SCORE_THRESHOLDS=hn.ERR_INVALID_PEER_SCORE_PARAMS=void 0;hn.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";hn.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var vu=m(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.validateTopicScoreParams=ze.validatePeerScoreParams=ze.createTopicScoreParams=ze.createPeerScoreParams=ze.defaultTopicScoreParams=ze.defaultPeerScoreParams=void 0;var oe=bu(),ae=le();ze.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};ze.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function NS(t={}){return Object.assign(Object.assign(Object.assign({},ze.defaultPeerScoreParams),t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=wg(i),e),{}):{}})}ze.createPeerScoreParams=NS;function wg(t={}){return Object.assign(Object.assign({},ze.defaultTopicScoreParams),t)}ze.createTopicScoreParams=wg;function LS(t){for(let[e,r]of Object.entries(t.topics))try{xg(r)}catch(i){throw ae(new Error(`invalid score parameters for topic ${e}: ${i.message}`),oe.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw ae(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw ae(new Error("missing application specific score function"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw ae(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw ae(new Error("invalid IPColocationFactorThreshold; must be at least 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw ae(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw ae(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw ae(new Error("invalid DecayInterval; must be at least 1s"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw ae(new Error("invalid DecayToZero; must be between 0 and 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS)}ze.validatePeerScoreParams=LS;function xg(t){if(t.topicWeight<0)throw ae(new Error("invalid topic weight; must be >= 0"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw ae(new Error("invalid TimeInMeshQuantum; must be non zero"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw ae(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw ae(new Error("invalid TimeInMeshQuantum; must be positive"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw ae(new Error("invalid TimeInMeshCap; must be positive"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw ae(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw ae(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw ae(new Error("invalid FirstMessageDeliveriesCap; must be positive"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw ae(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw ae(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw ae(new Error("invalid MeshMessageDeliveriesCap; must be positive"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw ae(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw ae(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw ae(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw ae(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw ae(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw ae(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),oe.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw ae(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),oe.ERR_INVALID_PEER_SCORE_PARAMS)}ze.validateTopicScoreParams=xg});var Eg=m(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.validatePeerScoreThresholds=br.createPeerScoreThresholds=br.defaultPeerScoreThresholds=void 0;var os=bu(),as=le();br.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function MS(t={}){return Object.assign(Object.assign({},br.defaultPeerScoreThresholds),t)}br.createPeerScoreThresholds=MS;function KS(t){if(t.gossipThreshold>0)throw as(new Error("invalid gossip threshold; it must be <= 0"),os.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw as(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),os.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw as(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),os.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw as(new Error("invalid accept PX threshold; it must be >= 0"),os.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw as(new Error("invalid opportunistic grafting threshold; it must be >= 0"),os.ERR_INVALID_PEER_SCORE_THRESHOLDS)}br.validatePeerScoreThresholds=KS});var _g=m(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.ensureTopicStats=Yr.createTopicStats=Yr.createPeerStats=void 0;function FS(t={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=mu(i),e),{}):{}})}Yr.createPeerStats=FS;function mu(t={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t)}Yr.createTopicStats=mu;function US(t,e,r){let i=e.topics[t];if(i)return i;if(!!r.topics[t])return e.topics[t]=i=mu(),i}Yr.ensureTopicStats=US});var Sg=m(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.computeScore=void 0;function qS(t,e,r,i){let n=0;return Object.entries(e.topics).forEach(([c,f])=>{let u=r.topics[c];if(!u)return;let a=0;if(f.inMesh){let p=f.meshTime/u.timeInMeshQuantum;p>u.timeInMeshCap&&(p=u.timeInMeshCap),a+=p*u.timeInMeshWeight}if(a+=f.firstMessageDeliveries*u.firstMessageDeliveriesWeight,f.meshMessageDeliveriesActive&&f.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let p=u.meshMessageDeliveriesThreshold-f.meshMessageDeliveries;a+=p*p*u.meshMessageDeliveriesWeight}a+=f.meshFailurePenalty*u.meshFailurePenaltyWeight,a+=f.invalidMessageDeliveries*f.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=a*u.topicWeight}),r.topicScoreCap>0&&n>r.topicScoreCap&&(n=r.topicScoreCap),n+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(c=>{if(r.IPColocationFactorWhitelist.has(c))return;let f=i.get(c),u=f?f.size:0;if(u>r.IPColocationFactorThreshold){let a=u-r.IPColocationFactorThreshold;n+=a*a*r.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,n}Lo.computeScore=qS});var Ag=m((MR,Ig)=>{"use strict";function me(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}me.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};me.prototype.get=function(e){return this.peekAt(e)};me.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};me.prototype.peekFront=function(){return this.peek()};me.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(me.prototype,"length",{get:function(){return this.size()}});me.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};me.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};me.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};me.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};me.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),i}};me.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<i/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};me.prototype.remove=function(e,r){var i=e,n,s=r;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),c=this._list.length;if(!(i>=o||i<-o||r<1)){if(i<0&&(i+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+r>=o)return n=this.toArray(),this.clear(),n;i+r>o&&(r=o-i);var f;for(n=new Array(r),f=0;f<r;f++)n[f]=this._list[this._head+i+f&this._capacityMask];if(i=this._head+i&this._capacityMask,e+r===o){for(this._tail=this._tail-r+c&this._capacityMask,f=r;f>0;f--)this._list[i=i+1+c&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+c&this._capacityMask,f=r-1;f>0;f--)this._list[i=i+1+c&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+r+c&this._capacityMask,f=e;f>0;f--)this.unshift(this._list[i=i-1+c&this._capacityMask]);for(i=this._head-1+c&this._capacityMask;s>0;)this._list[i=i-1+c&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+c&this._capacityMask,f=o-(r+e);f>0;f--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+c&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=c>>>2&&this._shrinkArray(),n}}};me.prototype.splice=function(e,r){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,c,f=arguments.length,u=this._list.length,a=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(c=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(c=this.remove(i,r),this._head=this._head+i+u&this._capacityMask);f>a;)this.unshift(arguments[--f]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+r));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+i+r+s&this._capacityMask];for(r===0?(c=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(c=this.remove(i,r),this._tail=this._tail-h+u&this._capacityMask);a<f;)this.push(arguments[a++]);for(s=0;s<h;s++)this.push(o[s])}return c}else return this.remove(i,r)}};me.prototype.clear=function(){this._head=0,this._tail=0};me.prototype.isEmpty=function(){return this._head===this._tail};me.prototype.toArray=function(){return this._copyArray(!1)};me.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};me.prototype._copyArray=function(e){var r=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)r.push(i[s]);for(s=0;s<this._tail;s++)r.push(i[s])}else for(s=this._head;s<this._tail;s++)r.push(i[s]);return r};me.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};me.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Ig.exports=me});var Cg=m(vr=>{"use strict";var GS=vr&&vr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vr,"__esModule",{value:!0});vr.MessageDeliveries=vr.DeliveryRecordStatus=void 0;var VS=$r(),jS=GS(Ag()),Bg;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(Bg=vr.DeliveryRecordStatus||(vr.DeliveryRecordStatus={}));var Rg=class{constructor(){this.records=new Map,this.queue=new jS.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:Bg.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let i={msgId:e,expire:Date.now()+VS.TimeCacheDuration};return this.queue.push(i),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};vr.MessageDeliveries=Rg});var Pg=m(Qr=>{"use strict";var Mo=Qr&&Qr.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(i.next(a))}catch(h){o(h)}}function f(a){try{u(i.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):n(a.value).then(c,f)}u((i=i.apply(t,e||[])).next())})},HS=Qr&&Qr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.PeerScore=void 0;var zS=vu(),ln=_g(),WS=Sg(),Lt=Cg(),$S=$r(),YS=HS(an()),QS=mn(),XS=As(),{ERR_INVALID_SIGNATURE:JS,ERR_MISSING_SIGNATURE:ZS}=XS.codes,pn=QS("libp2p:gossipsub:score"),Tg=class{constructor(e,r){zS.validatePeerScoreParams(e),this.params=e,this._connectionManager=r,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new Lt.MessageDeliveries}start(){if(this._backgroundInterval){pn("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),pn("started")}stop(){if(!this._backgroundInterval){pn("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),pn("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let c=this.params.topics[s];!c||(o.firstMessageDeliveries*=c.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=c.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=c.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=c.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>c.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<r&&(i.behaviourPenalty=0),this.scoreCache.set(n,{score:null,cacheUntil:0})})}score(e){let r=this.peerStats.get(e);if(!r)return 0;let i=Date.now(),n=this.scoreCache.get(e);n===void 0&&(n={score:null,cacheUntil:0},this.scoreCache.set(e,n));let{score:s,cacheUntil:o}=n;return o>i&&s!==null?s:(n.score=WS.computeScore(e,r,this.params,this.peerIPs),n.cacheUntil=i+this.params.decayInterval,n.score)}addPenalty(e,r){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=r,this.scoreCache.set(e,{score:null,cacheUntil:0}))}addPeer(e){let r=ln.createPeerStats({connected:!0});this.peerStats.set(e,r);let i=this._getIPs(e);this._setIPs(e,i,r.ips),r.ips=i}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this._removeIPs(e,r.ips),this.peerStats.delete(e);return}this.scoreCache.delete(e),Object.entries(r.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let i=this.peerStats.get(e);if(!i)return;let n=ln.ensureTopicStats(r,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1,this.scoreCache.set(e,{score:null,cacheUntil:0}))}prune(e,r){let i=this.peerStats.get(e);if(!i)return;let n=ln.ensureTopicStats(r,i,this.params);if(!n)return;let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1,this.scoreCache.set(e,{score:null,cacheUntil:0})}validateMessage(e){return Mo(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(e)})}deliverMessage(e,r){return Mo(this,void 0,void 0,function*(){let i=e.receivedFrom;this._markFirstMessageDelivery(i,e);let n=this.deliveryRecords.ensureRecord(r),s=Date.now();if(n.status!==Lt.DeliveryRecordStatus.unknown){pn("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",i,s-n.firstSeen,Lt.DeliveryRecordStatus[n.status]);return}n.status=Lt.DeliveryRecordStatus.valid,n.validated=s,n.peers.forEach(o=>{o!==i&&this._markDuplicateMessageDelivery(o,e)})})}rejectMessage(e,r,i){return Mo(this,void 0,void 0,function*(){let n=e.receivedFrom;switch(i){case ZS:case JS:this._markInvalidMessageDelivery(n,e);return}let s=this.deliveryRecords.ensureRecord(r);if(s.status!==Lt.DeliveryRecordStatus.unknown){pn("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",n,Date.now()-s.firstSeen,Lt.DeliveryRecordStatus[s.status]);return}switch(i){case $S.ERR_TOPIC_VALIDATOR_IGNORE:s.status=Lt.DeliveryRecordStatus.ignored;return}s.status=Lt.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(n,e),s.peers.forEach(o=>{this._markInvalidMessageDelivery(o,e)})})}duplicateMessage(e,r){return Mo(this,void 0,void 0,function*(){let i=e.receivedFrom,n=this.deliveryRecords.ensureRecord(r);if(!n.peers.has(i))switch(n.status){case Lt.DeliveryRecordStatus.unknown:n.peers.add(i);break;case Lt.DeliveryRecordStatus.valid:n.peers.add(i),this._markDuplicateMessageDelivery(i,e,n.validated);break;case Lt.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(i,e);break}})}_markInvalidMessageDelivery(e,r){let i=this.peerStats.get(e);!i||(r.topicIDs.forEach(n=>{let s=ln.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markFirstMessageDelivery(e,r){let i=this.peerStats.get(e);!i||(r.topicIDs.forEach(n=>{let s=ln.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markDuplicateMessageDelivery(e,r,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;r.topicIDs.forEach(o=>{let c=ln.ensureTopicStats(o,n,this.params);if(!c||!c.inMesh)return;let f=this.params.topics[o];if(i&&s>i+f.meshMessageDeliveriesWindow)return;let u=f.meshMessageDeliveriesCap;c.meshMessageDeliveries+=1,c.meshMessageDeliveries>u&&(c.meshMessageDeliveries=u)}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_getIPs(e){return this._connectionManager.getAll(YS.default.createFromB58String(e)).map(r=>r.remoteAddr.toOptions().host)}_setIPs(e,r,i){e:for(let n of r){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of r)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}this.scoreCache.set(e,{score:null,cacheUntil:0})}_removeIPs(e,r){r.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_updateIPs(){this.peerStats.forEach((e,r)=>{let i=this._getIPs(r);this._setIPs(r,i,e.ips),e.ips=i,this.scoreCache.set(r,{score:null,cacheUntil:0})})}};Qr.PeerScore=Tg});var Dg=m(mr=>{"use strict";var eI=mr&&mr.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),wu=mr&&mr.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&eI(e,t,r)};Object.defineProperty(mr,"__esModule",{value:!0});wu(vu(),mr);wu(Eg(),mr);wu(Pg(),mr)});var Ng=m(dn=>{"use strict";var Og=dn&&dn.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(i.next(a))}catch(h){o(h)}}function f(a){try{u(i.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):n(a.value).then(c,f)}u((i=i.apply(t,e||[])).next())})};Object.defineProperty(dn,"__esModule",{value:!0});dn.IWantTracer=void 0;var tI=$r(),rI=un(),iI=As(),{ERR_INVALID_SIGNATURE:nI,ERR_MISSING_SIGNATURE:sI}=iI.codes,kg=class{constructor(){this.promises=new Map}addPromise(e,r){let i=Math.floor(Math.random()*r.length),n=r[i],s=rI.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+tI.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),r=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(r.set(o,(r.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),r}deliverMessage(e){return Og(this,void 0,void 0,function*(){this.promises.delete(e)})}rejectMessage(e,r){return Og(this,void 0,void 0,function*(){switch(r){case nI:case sI:return}this.promises.delete(e)})}clear(){this.promises.clear()}};dn.IWantTracer=kg});var Mg=m(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.SimpleTimeCache=void 0;var Lg=class{constructor(e){this.lastPruneTime=0,this.entries=new Map,this.validityMs=e.validityMs}put(e,r){this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs}),this.prune()}prune(){let e=Date.now();if(!(e-this.lastPruneTime<200)){this.lastPruneTime=e;for(let[r,i]of this.entries.entries())if(i.validUntilMs<e)this.entries.delete(r);else break}}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries=new Map,this.lastPruneTime=0}};Ko.SimpleTimeCache=Lg});var Uo=m((VR,Fg)=>{"use strict";var Si=ni(),Fo=Si.Reader,Kg=Si.Writer,We=Si.util,xt=Si.roots["libp2p-crypto-keys"]||(Si.roots["libp2p-crypto-keys"]={});xt.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();xt.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=We.newBuffer([]),t.encode=function(r,i){return i||(i=Kg.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Fo||(r=Fo.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new xt.PublicKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw We.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw We.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof xt.PublicKey)return r;var i=new xt.PublicKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?We.base64.decode(r.Data,i.Data=We.newBuffer(We.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=We.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?xt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?We.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Si.util.toJSONOptions)},t}();xt.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=We.newBuffer([]),t.encode=function(r,i){return i||(i=Kg.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Fo||(r=Fo.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new xt.PrivateKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw We.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw We.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof xt.PrivateKey)return r;var i=new xt.PrivateKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?We.base64.decode(r.Data,i.Data=We.newBuffer(We.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=We.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?xt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?We.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Si.util.toJSONOptions)},t}();Fg.exports=xt});var cs=m(Ug=>{"use strict";Ug.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var xu=m((HR,Gg)=>{"use strict";var{concat:oI}=(Dt(),Pt),{fromString:qg}=(ke(),Oe),aI=cs();function cI({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=aI.get();r*=8;async function c(u,a){let h=o.getRandomValues(new Uint8Array(n)),l=o.getRandomValues(new Uint8Array(e)),d={name:t,iv:l},p={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},y=await o.subtle.importKey("raw",qg(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(p,y,{name:t,length:r},!0,["encrypt"]),b=await o.subtle.encrypt(d,v,u);return oI([h,d.iv,new Uint8Array(b)])}async function f(u,a){let h=u.slice(0,n),l=u.slice(n,n+e),d=u.slice(n+e),p={name:t,iv:l},y={name:"PBKDF2",salt:h,iterations:s,hash:{name:i}},v=await o.subtle.importKey("raw",qg(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(y,v,{name:t,length:r},!0,["decrypt"]),x=await o.subtle.decrypt(p,b,d);return new Uint8Array(x)}return{encrypt:c,decrypt:f}}Gg.exports={create:cI}});var jg=m((zR,Vg)=>{"use strict";var{base64:uI}=(li(),Dr),fI=xu();Vg.exports={import:async function(t,e){let r=uI.decode(t);return await fI.create().decrypt(r,e)}}});var Eu=m((WR,Hg)=>{"use strict";var hI=Us(),lI=le();Hg.exports=function(t){if(isNaN(t)||t<=0)throw lI(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return hI(t)}});var qo=m(us=>{"use strict";xe();Un();var pI=Q(),{fromString:dI}=(ke(),Oe),{toString:zg}=(qe(),Ue),{concat:Wg}=(Dt(),Pt);us.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Wg([new Uint8Array(e-r.length),r])}return zg(r,"base64url")};us.base64urlToBigInteger=t=>{let e=us.base64urlToBuffer(t);return new pI.jsbn.BigInteger(zg(e,"base16"),16)};us.base64urlToBuffer=(t,e)=>{let r=dI(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Wg([new Uint8Array(e-r.length),r])}return r}});var Qg=m(fs=>{"use strict";di();Ji();var Xr=Q(),{bigIntegerToUintBase64url:sr,base64urlToBigInteger:or}=qo(),{fromString:$g}=(ke(),Oe),{toString:Yg}=(qe(),Ue);fs.pkcs1ToJwk=function(t){let e=Xr.asn1.fromDer(Yg(t,"ascii")),r=Xr.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:sr(r.n),e:sr(r.e),d:sr(r.d),p:sr(r.p),q:sr(r.q),dp:sr(r.dP),dq:sr(r.dQ),qi:sr(r.qInv),alg:"RS256",kid:"2011-04-29"}};fs.jwkToPkcs1=function(t){let e=Xr.pki.privateKeyToAsn1({n:or(t.n),e:or(t.e),d:or(t.d),p:or(t.p),q:or(t.q),dP:or(t.dp),dQ:or(t.dq),qInv:or(t.qi)});return $g(Xr.asn1.toDer(e).getBytes(),"ascii")};fs.pkixToJwk=function(t){let e=Xr.asn1.fromDer(Yg(t,"ascii")),r=Xr.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:sr(r.n),e:sr(r.e),alg:"RS256",kid:"2011-04-29"}};fs.jwkToPkix=function(t){let e=Xr.pki.publicKeyToAsn1({n:or(t.n),e:or(t.e)});return $g(Xr.asn1.toDer(e).getBytes(),"ascii")}});var e1=m((QR,Zg)=>{"use strict";Ji();var Xg=Q(),{base64urlToBigInteger:yI}=qo();function Jg(t,e){return e.map(r=>yI(t[r]))}function gI(t){return Xg.pki.setRsaPrivateKey(...Jg(t,["n","e","d","p","q","dp","dq","qi"]))}function bI(t){return Xg.pki.setRsaPublicKey(...Jg(t,["n","e"]))}Zg.exports={jwk2pub:bI,jwk2priv:gI}});var i1=m(xr=>{"use strict";var wr=cs(),vI=Eu(),{toString:mI}=(qe(),Ue),{fromString:wI}=(ke(),Oe);xr.utils=Qg();xr.generateKey=async function(t){let e=await wr.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await t1(e);return{privateKey:r[0],publicKey:r[1]}};xr.unmarshalPrivateKey=async function(t){let r=[await wr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await xI(t)],i=await t1({privateKey:r[0],publicKey:r[1]});return{privateKey:i[0],publicKey:i[1]}};xr.getRandomValues=vI;xr.hashAndSign=async function(t,e){let r=await wr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await wr.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};xr.hashAndVerify=async function(t,e,r){let i=await wr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return wr.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,r)};function t1(t){return Promise.all([wr.get().subtle.exportKey("jwk",t.privateKey),wr.get().subtle.exportKey("jwk",t.publicKey)])}function xI(t){return wr.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:EI,jwk2priv:_I}=e1();function r1(t,e,r,i){let n=e?EI(t):_I(t),s=mI(Uint8Array.from(r),"ascii"),o=i(s,n);return wI(o,"ascii")}xr.encrypt=function(t,e){return r1(t,!0,e,(r,i)=>i.encrypt(r))};xr.decrypt=function(t,e){return r1(t,!1,e,(r,i)=>i.decrypt(r))}});var Go=m((JR,n1)=>{"use strict";var{base64:SI}=(li(),Dr),II=xu();n1.exports={export:async function(t,e){let i=await II.create().encrypt(t,e);return SI.encode(i)}}});var u1=m((ZR,c1)=>{"use strict";var{sha256:s1}=(Rt(),dt),o1=le(),{equals:a1}=(kt(),Ot),{toString:AI}=(qe(),Ue);Gc();var Vo=Q(),Et=i1(),jo=Uo(),BI=Go(),Ho=class{constructor(e){this._key=e}async verify(e,r){return Et.hashAndVerify(this._key,r,e)}marshal(){return Et.utils.jwkToPkix(this._key)}get bytes(){return jo.PublicKey.encode({Type:jo.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Et.encrypt(this._key,e)}equals(e){return a1(this.bytes,e.bytes)}async hash(){let{bytes:e}=await s1.digest(this.bytes);return e}},hs=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Et.getRandomValues(16)}async sign(e){return Et.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw o1(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Ho(this._publicKey)}decrypt(e){return Et.decrypt(this._key,e)}marshal(){return Et.utils.jwkToPkcs1(this._key)}get bytes(){return jo.PrivateKey.encode({Type:jo.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return a1(this.bytes,e.bytes)}async hash(){let{bytes:e}=await s1.digest(this.bytes);return e}async id(){let e=await this.public.hash();return AI(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let i=new Vo.util.ByteBuffer(this.marshal()),n=Vo.asn1.fromDer(i),s=Vo.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Vo.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return BI.export(this.bytes,e);throw o1(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function RI(t){let e=Et.utils.pkcs1ToJwk(t),r=await Et.unmarshalPrivateKey(e);return new hs(r.privateKey,r.publicKey)}function CI(t){let e=Et.utils.pkixToJwk(t);return new Ho(e)}async function TI(t){let e=await Et.unmarshalPrivateKey(t);return new hs(e.privateKey,e.publicKey)}async function PI(t){let e=await Et.generateKey(t);return new hs(e.privateKey,e.publicKey)}c1.exports={RsaPublicKey:Ho,RsaPrivateKey:hs,unmarshalRsaPublicKey:CI,unmarshalRsaPrivateKey:RI,generateKeyPair:PI,fromJwk:TI}});var h1=m(Jr=>{"use strict";var ls=Jc(),DI=32,OI=64,zo=32;Jr.publicKeyLength=DI;Jr.privateKeyLength=OI;Jr.generateKey=async function(){let t=ls.utils.randomPrivateKey(),e=await ls.getPublicKey(t);return{privateKey:f1(t,e),publicKey:e}};Jr.generateKeyFromSeed=async function(t){if(t.length!==zo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await ls.getPublicKey(e);return{privateKey:f1(e,r),publicKey:r}};Jr.hashAndSign=function(t,e){let r=t.slice(0,zo);return ls.sign(e,r)};Jr.hashAndVerify=function(t,e,r){return ls.verify(e,r,t)};function f1(t,e){let r=new Uint8Array(Jr.privateKeyLength);for(let i=0;i<zo;i++)r[i]=t[i],r[zo+i]=e[i];return r}});var g1=m((t4,y1)=>{"use strict";var l1=le(),{equals:p1}=(kt(),Ot),{sha256:d1}=(Rt(),dt),{base58btc:kI}=(hi(),fi),{identity:NI}=(On(),zi),$e=h1(),Wo=Uo(),LI=Go(),$o=class{constructor(e){this._key=gn(e,$e.publicKeyLength)}async verify(e,r){return $e.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return Wo.PublicKey.encode({Type:Wo.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return p1(this.bytes,e.bytes)}async hash(){let{bytes:e}=await d1.digest(this.bytes);return e}},yn=class{constructor(e,r){this._key=gn(e,$e.privateKeyLength),this._publicKey=gn(r,$e.publicKeyLength)}async sign(e){return $e.hashAndSign(this._key,e)}get public(){return new $o(this._publicKey)}marshal(){return this._key}get bytes(){return Wo.PrivateKey.encode({Type:Wo.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return p1(this.bytes,e.bytes)}async hash(){let{bytes:e}=await d1.digest(this.bytes);return e}async id(){let e=await NI.digest(this.public.bytes);return kI.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return LI.export(this.bytes,e);throw l1(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function MI(t){if(t.length>$e.privateKeyLength){t=gn(t,$e.privateKeyLength+$e.publicKeyLength);let i=t.slice(0,$e.privateKeyLength),n=t.slice($e.privateKeyLength,t.length);return new yn(i,n)}t=gn(t,$e.privateKeyLength);let e=t.slice(0,$e.privateKeyLength),r=t.slice($e.publicKeyLength);return new yn(e,r)}function KI(t){return t=gn(t,$e.publicKeyLength),new $o(t)}async function FI(){let{privateKey:t,publicKey:e}=await $e.generateKey();return new yn(t,e)}async function UI(t){let{privateKey:e,publicKey:r}=await $e.generateKeyFromSeed(t);return new yn(e,r)}function gn(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw l1(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}y1.exports={Ed25519PublicKey:$o,Ed25519PrivateKey:yn,unmarshalEd25519PrivateKey:MI,unmarshalEd25519PublicKey:KI,generateKeyPair:FI,generateKeyPairFromSeed:UI}});var m1=m((r4,v1)=>{"use strict";var ps=le(),Zr=nu(),{sha256:b1}=(Rt(),dt);v1.exports=()=>{let t=32;function e(){return Zr.utils.randomPrivateKey()}async function r(u,a){let{digest:h}=await b1.digest(a);try{return await Zr.sign(h,u)}catch(l){throw ps(l,"ERR_INVALID_INPUT")}}async function i(u,a,h){try{let{digest:l}=await b1.digest(h);return Zr.verify(a,l,u)}catch(l){throw ps(l,"ERR_INVALID_INPUT")}}function n(u){return Zr.Point.fromHex(u).toRawBytes(!0)}function s(u){return Zr.Point.fromHex(u).toRawBytes(!1)}function o(u){try{Zr.getPublicKey(u,!0)}catch(a){throw ps(a,"ERR_INVALID_PRIVATE_KEY")}}function c(u){try{Zr.Point.fromHex(u)}catch(a){throw ps(a,"ERR_INVALID_PUBLIC_KEY")}}function f(u){try{return Zr.getPublicKey(u,!0)}catch(a){throw ps(a,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:i,compressPublicKey:n,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:c,computePublicKey:f}}});var _1=m((i4,E1)=>{"use strict";var{sha256:w1}=(Rt(),dt),qI=le(),{equals:x1}=(kt(),Ot),{toString:GI}=(qe(),Ue),VI=Go();E1.exports=(t,e,r)=>{r=r||m1()();class i{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,a){return r.hashAndVerify(this._key,a,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return x1(this.bytes,u.bytes)}async hash(){let{bytes:u}=await w1.digest(this.bytes);return u}}class n{constructor(u,a){this._key=u,this._publicKey=a||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return x1(this.bytes,u.bytes)}async hash(){let{bytes:u}=await w1.digest(this.bytes);return u}async id(){let u=await this.public.hash();return GI(u,"base58btc")}async export(u,a="libp2p-key"){if(a==="libp2p-key")return VI.export(this.bytes,u);throw qI(new Error(`export format '${a}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(f){return new n(f)}function o(f){return new i(f)}async function c(){let f=await r.generateKey();return new n(f)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:c}}});var I1=m((n4,S1)=>{"use strict";S1.exports={SHA1:20,SHA256:32,SHA512:64}});var R1=m(B1=>{"use strict";var A1=cs(),jI=I1(),HI={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},zI=async(t,e)=>{let r=await A1.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};B1.create=async function(t,e){let r=HI[t],i=await A1.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(n){return zI(i,n)},length:jI[t]}}});var O1=m((o4,D1)=>{"use strict";var C1=le(),{concat:T1}=(Dt(),Pt),{fromString:WI}=(ke(),Oe),$I=R1(),P1={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};D1.exports=async(t,e,r)=>{let i=P1[t];if(!i){let x=Object.keys(P1).join(" / ");throw C1(new Error(`unknown cipher type '${t}'. Must be ${x}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw C1(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,c=WI("key expansion"),f=2*(s+n+o),u=await $I.create(e,r),a=await u.digest(c),h=[],l=0;for(;l<f;){let x=await u.digest(T1([a,c])),I=x.length;l+I>f&&(I=f-l),h.push(x),l+=I,a=await u.digest(a)}let d=f/2,p=T1(h),y=p.slice(0,d),v=p.slice(d,f),b=x=>({iv:x.slice(0,s),cipherKey:x.slice(s,s+n),macKey:x.slice(s+n)});return{k1:b(y),k2:b(v)}}});var N1=m((a4,k1)=>{"use strict";var YI=le();k1.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw YI(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var q1=m(U1=>{"use strict";var QI=le(),ds=cs(),{base64urlToBuffer:L1}=qo(),XI=N1(),{toString:_u}=(qe(),Ue),{concat:JI}=(Dt(),Pt),{equals:ZI}=(kt(),Ot),M1={"P-256":256,"P-384":384,"P-521":521};U1.generateEphmeralKeyPair=async function(t){XI(Object.keys(M1),t);let e=await ds.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(n,s)=>{let o;s?o=await ds.get().subtle.importKey("jwk",tA(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let c=[await ds.get().subtle.importKey("jwk",F1(t,n),{name:"ECDH",namedCurve:t},!1,[]),o],f=await ds.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:c[0]},c[1],M1[t]);return new Uint8Array(f,f.byteOffset,f.byteLength)},i=await ds.get().subtle.exportKey("jwk",e.publicKey);return{key:eA(i),genSharedKey:r}};var K1={"P-256":32,"P-384":48,"P-521":66};function eA(t){let e=K1[t.crv];return JI([Uint8Array.from([4]),L1(t.x,e),L1(t.y,e)],1+e*2)}function F1(t,e){let r=K1[t];if(ZI(!e.slice(0,1),Uint8Array.from([4])))throw QI(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:_u(e.slice(1,r+1),"base64url"),y:_u(e.slice(1+r),"base64url"),ext:!0}}var tA=(t,e)=>({...F1(t,e.public),d:_u(e.private,"base64url")})});var V1=m((u4,G1)=>{"use strict";var rA=q1();G1.exports=async t=>rA.generateEphmeralKeyPair(t)});var z1=m((f4,H1)=>{"use strict";var ar=Uo();di();Kc();var Su=Q(),ys=le(),{fromString:iA}=(ke(),Oe),nA=jg(),_t={rsa:u1(),ed25519:g1(),secp256k1:_1()(ar,Eu())},Yo={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function bn(t){let e=_t[t.toLowerCase()];if(!e){let r=Object.keys(_t).join(" / ");throw ys(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var sA=async(t,e)=>bn(t).generateKeyPair(e),oA=async(t,e,r)=>{let i=bn(t);if(t.toLowerCase()!=="ed25519")throw ys(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,r)},aA=t=>{let e=ar.PublicKey.decode(t),r=e.Data;switch(e.Type){case ar.KeyType.RSA:return _t.rsa.unmarshalRsaPublicKey(r);case ar.KeyType.Ed25519:return _t.ed25519.unmarshalEd25519PublicKey(r);case ar.KeyType.Secp256k1:if(_t.secp256k1)return _t.secp256k1.unmarshalSecp256k1PublicKey(r);throw ys(new Error(Yo.message),Yo.code);default:bn(e.Type)}},cA=(t,e)=>(e=(e||"rsa").toLowerCase(),bn(e),t.bytes),j1=async t=>{let e=ar.PrivateKey.decode(t),r=e.Data;switch(e.Type){case ar.KeyType.RSA:return _t.rsa.unmarshalRsaPrivateKey(r);case ar.KeyType.Ed25519:return _t.ed25519.unmarshalEd25519PrivateKey(r);case ar.KeyType.Secp256k1:if(_t.secp256k1)return _t.secp256k1.unmarshalSecp256k1PrivateKey(r);throw ys(new Error(Yo.message),Yo.code);default:bn(e.Type)}},uA=(t,e)=>(e=(e||"rsa").toLowerCase(),bn(e),t.bytes),fA=async(t,e)=>{try{let n=await nA.import(t,e);return j1(n)}catch(n){}let r=Su.pki.decryptRsaPrivateKey(t,e);if(r===null)throw ys(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=Su.asn1.toDer(Su.pki.privateKeyToAsn1(r));return i=iA(i.getBytes(),"ascii"),_t.rsa.unmarshalRsaPrivateKey(i)};H1.exports={supportedKeys:_t,keysPBM:ar,keyStretcher:O1(),generateEphemeralKeyPair:V1(),generateKeyPair:sA,generateKeyPairFromSeed:oA,unmarshalPublicKey:aA,marshalPublicKey:cA,unmarshalPrivateKey:j1,marshalPrivateKey:uA,import:fA}});var W1=m(Iu=>{"use strict";Iu.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};Iu.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var Q1=m((l4,Y1)=>{"use strict";var vn=ni(),$1=vn.Reader,hA=vn.Writer,ge=vn.util,gs=vn.roots["libp2p-envelope"]||(vn.roots["libp2p-envelope"]={});gs.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.publicKey=ge.newBuffer([]),t.prototype.payloadType=ge.newBuffer([]),t.prototype.payload=ge.newBuffer([]),t.prototype.signature=ge.newBuffer([]),t.encode=function(r,i){return i||(i=hA.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&i.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&i.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(42).bytes(r.signature),i},t.decode=function(r,i){r instanceof $1||(r=$1.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new gs.Envelope;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof gs.Envelope)return r;var i=new gs.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?ge.base64.decode(r.publicKey,i.publicKey=ge.newBuffer(ge.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?ge.base64.decode(r.payloadType,i.payloadType=ge.newBuffer(ge.base64.length(r.payloadType)),0):r.payloadType.length&&(i.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?ge.base64.decode(r.payload,i.payload=ge.newBuffer(ge.base64.length(r.payload)),0):r.payload.length&&(i.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?ge.base64.decode(r.signature,i.signature=ge.newBuffer(ge.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=ge.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=ge.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=ge.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=ge.newBuffer(n.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?ge.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?ge.base64.encode(r.payloadType,0,r.payloadType.length):i.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(n.payload=i.bytes===String?ge.base64.encode(r.payload,0,r.payload.length):i.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?ge.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,vn.util.toJSONOptions)},t}();Y1.exports=gs});var eb=m((p4,Z1)=>{"use strict";var lA=le(),{concat:pA}=(Dt(),Pt),{fromString:dA}=(ke(),Oe),yA=z1(),gA=an(),Au=Ls(),{equals:Qo}=(kt(),Ot),{codes:bA}=W1(),{Envelope:X1}=Q1(),ei=class{constructor({peerId:e,payloadType:r,payload:i,signature:n}){this.peerId=e,this.payloadType=r,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=yA.marshalPublicKey(this.peerId.pubKey);return this._marshal=X1.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return Qo(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&Qo(this.payloadType,e.payloadType)&&Qo(this.payload,e.payload)&&Qo(this.signature,e.signature)}validate(e){let r=J1(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},J1=(t,e,r)=>{let i=dA(t),n=Au.encode(i.byteLength),s=Au.encode(e.length),o=Au.encode(r.length);return pA([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),r])};ei.createFromProtobuf=async t=>{let e=X1.decode(t),r=await gA.createFromPubKey(e.publicKey);return new ei({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};ei.seal=async(t,e)=>{let r=t.domain,i=t.codec,n=t.marshal(),s=J1(r,i,n),o=await e.privKey.sign(s);return new ei({peerId:e,payloadType:i,payload:n,signature:o})};ei.openAndCertify=async(t,e)=>{let r=await ei.createFromProtobuf(t);if(!await r.validate(e))throw lA(new Error("envelope signature is not valid for the given domain"),bA.ERR_SIGNATURE_NOT_VALID);return r};Z1.exports=ei});var SA=m((Er,ib)=>{"use strict";var vA=Er&&Er.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),mA=Er&&Er.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),tb=Er&&Er.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vA(e,t,r);return mA(e,t),e},ct=Er&&Er.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(i.next(a))}catch(h){o(h)}}function f(a){try{u(i.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):n(a.value).then(c,f)}u((i=i.apply(t,e||[])).next())})},Bu=tb(ag()),wA=dg(),Ru=gg(),j=tb($r()),xA=mg(),Xo=yu(),Ie=un(),Cu=Dg(),EA=Ng(),rb=Mg(),Tu=an(),_A=eb(),Pu=$r(),Du=class extends Bu.default{constructor(e,r={}){var i;let n=[j.GossipsubIDv11,j.GossipsubIDv10],s=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:j.GossipsubD,Dlo:j.GossipsubDlo,Dhi:j.GossipsubDhi,Dscore:j.GossipsubDscore,Dout:j.GossipsubDout,Dlazy:j.GossipsubDlazy,heartbeatInterval:j.GossipsubHeartbeatInterval,fanoutTTL:j.GossipsubFanoutTTL,mcacheLength:j.GossipsubHistoryLength,mcacheGossip:j.GossipsubHistoryGossip,seenTTL:j.GossipsubSeenTTL},r),{scoreParams:Cu.createPeerScoreParams(r.scoreParams),scoreThresholds:Cu.createPeerScoreThresholds(r.scoreThresholds)});s.fallbackToFloodsub&&n.push(j.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:n,libp2p:e},s));this._options=s,this.direct=new Set(s.directPeers.map(o=>o.id.toB58String())),this.acceptFromWhitelist=new Map,s.directPeers.forEach(o=>{e.peerStore.addressBook.add(o.id,o.addrs)}),this.seenCache=new rb.SimpleTimeCache({validityMs:s.seenTTL}),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=r.messageCache||new wA.MessageCache(s.mcacheGossip,s.mcacheLength),this.getFastMsgIdStr=(i=r.fastMsgIdFn)!==null&&i!==void 0?i:void 0,this.fastMsgIdCache=r.fastMsgIdFn?new rb.SimpleTimeCache({validityMs:s.seenTTL}):void 0,this.heartbeat=new xA.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new EA.IWantTracer,this._libp2p=e,this.score=new Cu.PeerScore(this._options.scoreParams,e.connectionManager)}_decodeRpc(e){return Ru.RPC.decode(e)}_encodeRpc(e){return Ru.RPC.encode(e).finish()}_addPeer(e,r){let i=super._addPeer(e,r);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>r===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let r=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),this.acceptFromWhitelist.delete(i),r}_processRpc(e,r,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return ct(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,r,i))?(i.control&&(yield this._processRpcControlMessage(e,i.control)),!0):!1})}_processRpcControlMessage(e,r){return ct(this,void 0,void 0,function*(){if(!r)return;let i=r.ihave?this._handleIHave(e,r.ihave):[],n=r.iwant?this._handleIWant(e,r.iwant):[],s=r.graft?yield this._handleGraft(e,r.graft):[];if(r.prune&&this._handlePrune(e,r.prune),!i.length&&!n.length&&!s.length)return;let o=Ie.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)})}_processRpcMessage(e){let r=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return ct(this,void 0,void 0,function*(){let i;if(this.getFastMsgIdStr&&this.fastMsgIdCache){let n=yield this.getFastMsgIdStr(e);if(i=this.fastMsgIdCache.get(n),i!==void 0){this.score.duplicateMessage(e,i);return}i=Ie.messageIdToString(yield this.getMsgId(e)),this.fastMsgIdCache.put(n,i)}else if(i=Ie.messageIdToString(yield this.getMsgId(e)),this.seenCache.has(i)){this.score.duplicateMessage(e,i);return}this.seenCache.put(i),yield this.score.validateMessage(i),yield r._processRpcMessage.call(this,e)})}_acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),i=this.acceptFromWhitelist.get(e);if(i&&i.messagesAccepted<Pu.ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&i.acceptUntil>=r)return i.messagesAccepted+=1,!0;let n=this.score.score(e);return n>=Pu.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+Pu.ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(e),n>=this._options.scoreThresholds.graylistThreshold}validate(e){let r=Object.create(null,{validate:{get:()=>super.validate}});return ct(this,void 0,void 0,function*(){try{yield r.validate.call(this,e)}catch(i){let n=yield this.getCanonicalMsgIdStr(e);throw this.score.rejectMessage(e,n,i.code),this.gossipTracer.rejectMessage(n,i.code),i}})}_handleIHave(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>j.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=j.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:a})=>{!u||!a||!this.mesh.has(u)||a.forEach(h=>{let l=Ie.messageIdToString(h);this.seenCache.has(l)||o.set(l,h)})}),!o.size)return[];let c=o.size;c+s>j.GossipsubMaxIHaveLength&&(c=j.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",c,o.size,e);let f=Array.from(o.values());return Ie.shuffle(f),f=f.slice(0,c),this.iasked.set(e,s+c),this.gossipTracer.addPromise(e,f),[{messageIDs:f}]}_handleIWant(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return r.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let c=Ie.messageIdToString(o),[f,u]=this.messageCache.getForPeer(c,e);if(!!f){if(u>j.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(c,f)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(Bu.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,r){return ct(this,void 0,void 0,function*(){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return r.forEach(({topicID:c})=>{var f;if(!c)return;let u=this.mesh.get(c);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(c),o=!1;return}let a=(f=this.backoff.get(c))===null||f===void 0?void 0:f.get(e);if(typeof a=="number"&&s<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let h=a+j.GossipsubGraftFloodThreshold-j.GossipsubPruneBackoff;s<h&&this.score.addPenalty(e,1),this._addBackoff(e,c),i.push(c);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,c),i.push(c),o=!1,this._addBackoff(e,c);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(c),this._addBackoff(e,c);return}this.log("GRAFT: Add mesh link from %s in %s",e,c),this.score.graft(e,c),u.add(e)}),i.length?Promise.all(i.map(c=>this._makePrune(e,c,o))):[]})}_handlePrune(e,r){let i=this.score.score(e);r.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let c=this.mesh.get(n);if(!!c&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),c.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,r){this._doAddBackoff(e,r,j.GossipsubPruneBackoff)}_doAddBackoff(e,r,i){let n=this.backoff.get(r);n||(n=new Map,this.backoff.set(r,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e)})}_clearBackoff(){if(this.heartbeatTicks%j.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((r,i)=>{r.forEach((n,s)=>{n<e&&r.delete(s)}),r.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%j.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(r=>{let i=this.peers.get(r);(!i||!i.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this._connect(r)})}_pxConnect(e){return ct(this,void 0,void 0,function*(){e.length>j.GossipsubPrunePeers&&(Ie.shuffle(e),e=e.slice(0,j.GossipsubPrunePeers));let r=[];yield Promise.all(e.map(i=>ct(this,void 0,void 0,function*(){if(!i.peerID)return;let s=Tu.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){r.push(s);return}try{let o=yield _A.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),c=o.peerId.toB58String();if(s!==c){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",c,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!r.length&&r.forEach(i=>this._connect(i))})}start(){let e=Object.create(null,{start:{get:()=>super.start}});return ct(this,void 0,void 0,function*(){yield e.start.call(this),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(r=>{this._connect(r)})},j.GossipsubDirectConnectInitialDelay)})}stop(){let e=Object.create(null,{stop:{get:()=>super.stop}});return ct(this,void 0,void 0,function*(){yield e.stop.call(this),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),clearTimeout(this._directPeerInitial)})}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(Tu.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let r=this.fanout.get(e);if(r)r.forEach(i=>{this.score.score(i)<0&&r.delete(i)}),r.size<this._options.D&&Xo.getGossipPeers(this,e,this._options.D-r.size,i=>!r.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>r.add(i)),this.mesh.set(e,r),this.fanout.delete(e),this.lastpub.delete(e);else{let i=Xo.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let r=this.mesh.get(e);r&&(r.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}getCanonicalMsgIdStr(e){var r,i;return ct(this,void 0,void 0,function*(){return this.fastMsgIdCache&&this.getFastMsgIdStr?(i=(r=this.getCachedMsgIdStr(e))!==null&&r!==void 0?r:this.fastMsgIdCache.get(this.getFastMsgIdStr(e)))!==null&&i!==void 0?i:Ie.messageIdToString(yield this.getMsgId(e)):Ie.messageIdToString(yield this.getMsgId(e))})}getCachedMsgIdStr(e){}_publish(e){return ct(this,void 0,void 0,function*(){let r=yield this.getCanonicalMsgIdStr(e);e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e,r),this.gossipTracer.deliverMessage(r)),this.seenCache.put(r),this.messageCache.put(e,r);let i=new Set;e.topicIDs.forEach(s=>{let o=this.topics.get(s);if(!!o)if(this._options.floodPublish&&e.from===this.peerId.toB58String())o.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&i.add(c)});else{this.direct.forEach(f=>{i.add(f)}),o.forEach(f=>{let u=this.score.score(f),a=this.peers.get(f);!a||a.protocol===j.FloodsubID&&u>=this._options.scoreThresholds.publishThreshold&&i.add(f)});let c=this.mesh.get(s);if(!c||!c.size){if(c=this.fanout.get(s),!c){let f=Xo.getGossipPeers(this,s,this._options.D,u=>this.score.score(u)>=this._options.scoreThresholds.publishThreshold);f.size>0?(c=f,this.fanout.set(s,f)):c=new Set}this.lastpub.set(s,this._now())}c.forEach(f=>{i.add(f)})}});let n=Ie.createGossipRpc([Bu.utils.normalizeOutRpcMessage(e)]);i.forEach(s=>{s!==e.from&&this._sendRpc(s,n)})})}_sendGraft(e,r){let i=[{topicID:r}],n=Ie.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,r){return ct(this,void 0,void 0,function*(){let i=[yield this._makePrune(e,r,this._options.doPX)],n=Ie.createGossipRpc([],{prune:i});this._sendRpc(e,n)})}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,r,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,r,s),this.gossip.delete(e)),i.write(Ru.RPC.encode(r).finish())}_piggybackControl(e,r,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(n),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,r,i){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=i}_sendGraftPrune(e,r,i){return ct(this,void 0,void 0,function*(){let n=this._options.doPX;for(let[s,o]of e){let c=o.map(h=>({topicID:h})),f=[],u=r.get(s);u&&(f=yield Promise.all(u.map(h=>this._makePrune(s,h,n&&!i.get(s)))),r.delete(s));let a=Ie.createGossipRpc([],{graft:c,prune:f});this._sendRpc(s,a)}for(let[s,o]of r){let c=yield Promise.all(o.map(u=>this._makePrune(s,u,n&&!i.get(s)))),f=Ie.createGossipRpc([],{prune:c});this._sendRpc(s,f)}})}_emitGossip(e,r){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Ie.shuffle(i),i.length>j.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(f=>{let u=this.peers.get(f);!u||!r.has(f)&&!this.direct.has(f)&&Ie.hasGossipProtocol(u.protocol)&&this.score.score(f)>=this._options.scoreThresholds.gossipThreshold&&n.push(f)});let o=this._options.Dlazy,c=j.GossipsubGossipFactor*n.length;c>o&&(o=c),o>n.length?o=n.length:Ie.shuffle(n),n.slice(0,o).forEach(f=>{let u=i;i.length>j.GossipsubMaxIHaveLength&&(u=Ie.shuffle(u.slice()).slice(0,j.GossipsubMaxIHaveLength)),this._pushGossip(f,{topicID:e,messageIDs:u})})}_flush(){for(let[e,r]of this.gossip.entries()){this.gossip.delete(e);let i=Ie.createGossipRpc([],{ihave:r});this._sendRpc(e,i)}for(let[e,r]of this.control.entries()){this.control.delete(e);let i=Ie.createGossipRpc([],{graft:r.graft,prune:r.prune});this._sendRpc(e,i)}}_pushGossip(e,r){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(r))}_now(){return Date.now()}_makePrune(e,r,i){return ct(this,void 0,void 0,function*(){if(this.peers.get(e).protocol===j.GossipsubIDv10)return{topicID:r,peers:[]};let n=j.GossipsubPruneBackoff/1e3,s=[];if(i){let o=Xo.getGossipPeers(this,r,j.GossipsubPrunePeers,c=>c!==e&&this.score.score(c)>=0);for(let c of o){let f=Tu.createFromB58String(c);s.push({peerID:f.toBytes(),signedPeerRecord:yield this._libp2p.peerStore.addressBook.getRawEnvelope(f)})}}return{topicID:r,peers:s,backoff:n}})}};Du.multicodec=j.GossipsubIDv11;ib.exports=Du});return SA();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) Paul Miller (paulmillr.com) */
return AchingbrainLibp2pGossipsub}));
