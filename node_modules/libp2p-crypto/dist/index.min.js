(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pCrypto=(()=>{var da=Object.defineProperty;var lf=e=>da(e,"__esModule",{value:!0});var Q=(e,t)=>()=>(e&&(t=e(e=0)),t);var C=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ee=(e,t)=>{lf(e);for(var r in t)da(e,r,{get:t[r],enumerable:!0})};var pr=C(ya=>{"use strict";ya.get=(e=globalThis)=>{let t=e.crypto;if(!t||!t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}});var xa=C((Jd,ga)=>{"use strict";ga.exports={SHA1:20,SHA256:32,SHA512:64}});var Zn=C(ma=>{"use strict";var va=pr(),pf=xa(),df={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},yf=async(e,t)=>{let r=await va.get().subtle.sign({name:"HMAC"},e,t);return new Uint8Array(r,r.byteOffset,r.byteLength)};ma.create=async function(e,t){let r=df[e],n=await va.get().subtle.importKey("raw",t,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return yf(n,i)},length:pf[e]}}});var Z=C((ty,ba)=>{ba.exports={options:{usePureJavaScript:!1}}});var Ea=C((ry,Sa)=>{var Qn={};Sa.exports=Qn;var wa={};Qn.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=gf(e,t);else{var i=0,a=t.length,s=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var f=0,u=e[i];f<o.length;++f)u+=o[f]<<8,o[f]=u%a,u=u/a|0;for(;u>0;)o.push(u%a),u=u/a|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};Qn.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=wa[t];if(!r){r=wa[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,a=t.charAt(0),s=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var f=0,u=o;f<s.length;++f)u+=s[f]*i,s[f]=u&255,u>>=8;for(;u>0;)s.push(u&255),u>>=8}for(var c=0;e[c]===a&&c<e.length-1;++c)s.push(0);return typeof Buffer!="undefined"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function gf(e,t){var r=0,n=t.length,i=t.charAt(0),a=[0];for(r=0;r<e.length();++r){for(var s=0,o=e.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var f="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=t[a[r]];return f}});var ue=C((ny,Ta)=>{var Ba=Z(),Aa=Ea(),d=Ta.exports=Ba.util=Ba.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){d.nextTick=process.nextTick,typeof setImmediate=="function"?d.setImmediate=setImmediate:d.setImmediate=d.nextTick;return}if(typeof setImmediate=="function"){d.setImmediate=function(){return setImmediate.apply(void 0,arguments)},d.nextTick=function(o){return setImmediate(o)};return}if(d.setImmediate=function(o){setTimeout(o,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(c){c()})}};var s=o,e="forge.setImmediate",t=[];d.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(u){u()})}).observe(i,{attributes:!0});var a=d.setImmediate;d.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(t.push(f),t.length===1&&i.setAttribute("a",n=!n))}}d.nextTick=d.setImmediate})();d.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;d.globalScope=function(){return d.isNodejs?globalThis:typeof self=="undefined"?window:self}();d.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};d.isArrayBuffer=function(e){return typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer};d.isArrayBufferView=function(e){return e&&d.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function dr(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}d.ByteBuffer=Xn;function Xn(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(d.isArrayBuffer(e)||d.isArrayBufferView(e))if(typeof Buffer!="undefined"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(n){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Xn||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}d.ByteStringBuffer=Xn;var xf=4096;d.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>xf&&(this.data.substr(0,1),this._constructedStringLength=0)};d.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};d.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};d.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};d.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};d.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};d.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(d.encodeUtf8(e))};d.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};d.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};d.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};d.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};d.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};d.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};d.ByteStringBuffer.prototype.putInt=function(e,t){dr(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};d.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};d.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};d.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};d.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};d.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};d.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};d.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};d.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};d.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};d.ByteStringBuffer.prototype.getInt=function(e){dr(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};d.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};d.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};d.ByteStringBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};d.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};d.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};d.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};d.ByteStringBuffer.prototype.copy=function(){var e=d.createBuffer(this.data);return e.read=this.read,e};d.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};d.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};d.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};d.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};d.ByteStringBuffer.prototype.toString=function(){return d.decodeUtf8(this.bytes())};function vf(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=d.isArrayBuffer(e),n=d.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}d.DataBuffer=vf;d.DataBuffer.prototype.length=function(){return this.write-this.read};d.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};d.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};d.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};d.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};d.DataBuffer.prototype.putBytes=function(e,t){if(d.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(d.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof d.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&d.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof d.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var a;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.hex.decode(e,a,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.base64.decode(e,a,this.write),this;if(t==="utf8"&&(e=d.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.raw.decode(a),this;if(t==="utf16")return this.accommodate(e.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=d.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};d.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};d.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};d.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};d.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};d.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};d.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};d.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};d.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};d.DataBuffer.prototype.putInt=function(e,t){dr(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};d.DataBuffer.prototype.putSignedInt=function(e,t){return dr(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};d.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};d.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};d.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};d.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};d.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};d.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};d.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};d.DataBuffer.prototype.getInt=function(e){dr(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};d.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};d.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};d.DataBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};d.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};d.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};d.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};d.DataBuffer.prototype.copy=function(){return new d.DataBuffer(this)};d.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};d.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};d.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};d.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};d.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return d.binary.raw.encode(t);if(e==="hex")return d.binary.hex.encode(t);if(e==="base64")return d.binary.base64.encode(t);if(e==="utf8")return d.text.utf8.decode(t);if(e==="utf16")return d.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};d.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=d.encodeUtf8(e)),new d.ByteBuffer(e)};d.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};d.xorBytes=function(e,t,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};d.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};d.bytesToHex=function(e){return d.createBuffer(e).toHex()};d.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gt=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Ca="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";d.encode64=function(e,t){for(var r="",n="",i,a,s,o=0;o<e.length;)i=e.charCodeAt(o++),a=e.charCodeAt(o++),s=e.charCodeAt(o++),r+=yt.charAt(i>>2),r+=yt.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=yt.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":yt.charAt(s&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};d.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,a,s=0;s<e.length;)r=gt[e.charCodeAt(s++)-43],n=gt[e.charCodeAt(s++)-43],i=gt[e.charCodeAt(s++)-43],a=gt[e.charCodeAt(s++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(t+=String.fromCharCode((i&3)<<6|a)));return t};d.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};d.decodeUtf8=function(e){return decodeURIComponent(escape(e))};d.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Aa.encode,decode:Aa.decode}};d.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};d.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n};d.binary.hex.encode=d.bytesToHex;d.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,a=r;for(e.length&1&&(i=1,n[a++]=parseInt(e[0],16));i<e.length;i+=2)n[a++]=parseInt(e.substr(i,2),16);return t?a-r:n};d.binary.base64.encode=function(e,t){for(var r="",n="",i,a,s,o=0;o<e.byteLength;)i=e[o++],a=e[o++],s=e[o++],r+=yt.charAt(i>>2),r+=yt.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=yt.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":yt.charAt(s&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};d.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,f=0,u=r;f<e.length;)i=gt[e.charCodeAt(f++)-43],a=gt[e.charCodeAt(f++)-43],s=gt[e.charCodeAt(f++)-43],o=gt[e.charCodeAt(f++)-43],n[u++]=i<<2|a>>4,s!==64&&(n[u++]=(a&15)<<4|s>>2,o!==64&&(n[u++]=(s&3)<<6|o));return t?u-r:n.subarray(0,u)};d.binary.base58.encode=function(e,t){return d.binary.baseN.encode(e,Ca,t)};d.binary.base58.decode=function(e,t){return d.binary.baseN.decode(e,Ca,t)};d.text={utf8:{},utf16:{}};d.text.utf8.encode=function(e,t,r){e=d.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n};d.text.utf8.decode=function(e){return d.decodeUtf8(String.fromCharCode.apply(null,e))};d.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<e.length;++o)i[s++]=e.charCodeAt(o),a+=2;return t?a-r:n};d.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};d.deflate=function(e,t,r){if(t=d.decode64(e.deflate(d.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};d.inflate=function(e,t,r){var n=e.inflate(d.encode64(t)).rval;return n===null?null:d.decode64(n)};var Jn=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=d.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},ei=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(d.decode64(r))),r},mf=function(e,t,r,n){var i=ei(e,t);i===null&&(i={}),i[r]=n,Jn(e,t,i)},bf=function(e,t,r){var n=ei(e,t);return n!==null&&(n=r in n?n[r]:null),n},wf=function(e,t,r){var n=ei(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),Jn(e,t,n)}},Sf=function(e,t){Jn(e,t,null)},Yr=function(e,t,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),a=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),a=!0)}catch(f){s=f}if(a)break}if(!a)throw s;return n};d.setItem=function(e,t,r,n,i){Yr(mf,arguments,i)};d.getItem=function(e,t,r,n){return Yr(bf,arguments,n)};d.removeItem=function(e,t,r,n){Yr(wf,arguments,n)};d.clearItems=function(e,t,r){Yr(Sf,arguments,r)};d.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=r===null?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(n.port!==80&&n.scheme==="http"||n.port!==443&&n.scheme==="https")&&(n.fullHost+=":"+n.port):n.scheme==="http"?n.port=80:n.scheme==="https"&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var $r=null;d.getQueryVariables=function(e){var t=function(n){for(var i={},a=n.split("&"),s=0;s<a.length;s++){var o=a[s].indexOf("="),f,u;o>0?(f=a[s].substring(0,o),u=a[s].substring(o+1)):(f=a[s],u=null),f in i||(i[f]=[]),!(f in Object.prototype)&&u!==null&&i[f].push(unescape(u))}return i},r;return typeof e=="undefined"?($r===null&&(typeof window!="undefined"&&window.location&&window.location.search?$r=t(window.location.search.substring(1)):$r={}),r=$r):r=t(e),r};d.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var i=t.split("/");i.length>0&&i[0]===""&&i.shift();var a=r===""?{}:d.getQueryVariables(r);return{pathString:t,queryString:r,path:i,query:a}};d.makeRequest=function(e){var t=d.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(n){return typeof n=="undefined"?t.path:t.path[n]},getQuery:function(n,i){var a;return typeof n=="undefined"?a=t.query:(a=t.query[n],a&&typeof i!="undefined"&&(a=a[i])),a},getQueryLast:function(n,i){var a,s=r.getQuery(n);return s?a=s[s.length-1]:a=i,a}};return r};d.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")};d.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};d.format=function(e){for(var t=/%./g,r,n,i=0,a=[],s=0;r=t.exec(e);){n=e.substring(s,t.lastIndex-2),n.length>0&&a.push(n),s=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(e.substring(s)),a.join("")};d.formatNumber=function(e,t,r,n){var i=e,a=isNaN(t=Math.abs(t))?2:t,s=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",c=u.length>3?u.length%3:0;return f+(c?u.substr(0,c)+o:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-u).toFixed(a).slice(2):"")};d.formatSize=function(e){return e>=1073741824?e=d.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=d.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=d.formatNumber(e/1024,0)+" KiB":e=d.formatNumber(e,0)+" bytes",e};d.bytesFromIP=function(e){return e.indexOf(".")!==-1?d.bytesFromIPv4(e):e.indexOf(":")!==-1?d.bytesFromIPv6(e):null};d.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=d.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};d.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=d.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=d.hexToBytes(e[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};d.bytesToIP=function(e){return e.length===4?d.bytesToIPv4(e):e.length===16?d.bytesToIPv6(e):null};d.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};d.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var a=d.bytesToHex(e[i]+e[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=t.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};d.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in d&&!e.update)return t(null,d.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return d.cores=navigator.hardwareConcurrency,t(null,d.cores);if(typeof Worker=="undefined")return d.cores=1,t(null,d.cores);if(typeof Blob=="undefined")return d.cores=2,t(null,d.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,f){if(o===0){var u=Math.floor(s.reduce(function(c,h){return c+h},0)/s.length);return d.cores=Math.max(1,u),URL.revokeObjectURL(r),t(null,d.cores)}i(f,function(c,h){s.push(a(f,h)),n(s,o-1,f)})}function i(s,o){for(var f=[],u=[],c=0;c<s;++c){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===s){for(var y=0;y<s;++y)f[y].terminate();o(null,u)}}),f.push(h)}for(var c=0;c<s;++c)f[c].postMessage(c)}function a(s,o){for(var f=[],u=0;u<s;++u)for(var c=o[u],h=f[u]=[],l=0;l<s;++l)if(u!==l){var y=o[l];(c.st>y.st&&c.st<y.et||y.st>c.st&&y.st<c.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var ri=C((iy,Ia)=>{var pe=Z();ue();Ia.exports=pe.cipher=pe.cipher||{};pe.cipher.algorithms=pe.cipher.algorithms||{};pe.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=pe.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new pe.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};pe.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=pe.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new pe.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};pe.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),pe.cipher.algorithms[e]=t};pe.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in pe.cipher.algorithms?pe.cipher.algorithms[e]:null};var ti=pe.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};ti.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=pe.util.createBuffer(),this.output=e.output||pe.util.createBuffer(),this.mode.start(t)};ti.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ti.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var ii=C((ay,_a)=>{var de=Z();ue();de.cipher=de.cipher||{};var q=_a.exports=de.cipher.modes=de.cipher.modes||{};q.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};q.ecb.prototype.start=function(e){};q.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};q.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};q.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};q.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};q.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};q.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=Zr(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};q.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};q.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};q.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};q.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};q.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=de.util.createBuffer(),this._partialBytes=0};q.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Zr(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=de.util.createBuffer(),this._partialBytes=0};q.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Zr(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.ofb.prototype.decrypt=q.ofb.prototype.encrypt;q.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=de.util.createBuffer(),this._partialBytes=0};q.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Zr(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Qr(this._inBlock)};q.ctr.prototype.decrypt=q.ctr.prototype.encrypt;q.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=de.util.createBuffer(),this._partialBytes=0,this._R=3774873600};q.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=de.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=de.util.createBuffer(e.additionalData):r=de.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=de.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ni(n*8)))}this._inBlock=this._j0.slice(0),Qr(this._inBlock),this._partialBytes=0,r=de.util.createBuffer(r),this._aDataLength=ni(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};q.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Qr(this._inBlock)};q.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Qr(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};q.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=de.util.createBuffer();var n=this._aDataLength.concat(ni(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};q.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var a=e[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};q.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};q.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,a=this._m[r][i];t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3]}return t};q.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};q.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],f=s/n|0,u=(n-1-s%n)*t;o[f]=1<<t-1<<u,a[s]=this.generateSubHashTable(this.multiply(o,e),t)}return a};q.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],f=i[s];i[a+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var u=i[a^n];i[a]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i};function Zr(e,t){if(typeof e=="string"&&(e=de.util.createBuffer(e)),de.util.isArray(e)&&e.length>4){var r=e;e=de.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!de.util.isArray(e)){for(var i=[],a=t/4,n=0;n<a;++n)i.push(e.getInt32());e=i}return e}function Qr(e){e[e.length-1]=e[e.length-1]+1&4294967295}function ni(e){return[e/4294967296|0,e&4294967295]}});var Jr=C((sy,Na)=>{var ee=Z();ri();ii();ue();Na.exports=ee.aes=ee.aes||{};ee.aes.startEncrypting=function(e,t,r,n){var i=Xr({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};ee.aes.createEncryptionCipher=function(e,t){return Xr({key:e,output:null,decrypt:!1,mode:t})};ee.aes.startDecrypting=function(e,t,r,n){var i=Xr({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};ee.aes.createDecryptionCipher=function(e,t){return Xr({key:e,output:null,decrypt:!0,mode:t})};ee.aes.Algorithm=function(e,t){ai||Da();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return oi(r._w,n,i,!1)},decrypt:function(n,i){return oi(r._w,n,i,!0)}}}),r._init=!1};ee.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=ee.util.createBuffer(t);else if(ee.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=ee.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!ee.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!ee.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=ka(t,e.decrypt&&!s),this._init=!0}};ee.aes._expandKey=function(e,t){return ai||Da(),ka(e,t)};ee.aes._updateBlock=oi;Qt("AES-ECB",ee.cipher.modes.ecb);Qt("AES-CBC",ee.cipher.modes.cbc);Qt("AES-CFB",ee.cipher.modes.cfb);Qt("AES-OFB",ee.cipher.modes.ofb);Qt("AES-CTR",ee.cipher.modes.ctr);Qt("AES-GCM",ee.cipher.modes.gcm);function Qt(e,t){var r=function(){return new ee.aes.Algorithm(e,t)};ee.cipher.registerAlgorithm(e,r)}var ai=!1,Xt=4,Be,si,Ra,Kt,ze;function Da(){ai=!0,Ra=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Be=new Array(256),si=new Array(256),Kt=new Array(4),ze=new Array(4);for(var t=0;t<4;++t)Kt[t]=new Array(256),ze[t]=new Array(256);for(var r=0,n=0,i,a,s,o,f,u,c,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Be[r]=o,si[o]=r,f=e[o],i=e[r],a=e[i],s=e[a],u=f<<24^o<<16^o<<8^(o^f),c=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Kt[h][r]=u,ze[h][o]=c,u=u<<24|u>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=i^e[e[e[i^s]]],n^=e[e[n]])}}function ka(e,t){for(var r=e.slice(0),n,i=1,a=r.length,s=a+6+1,o=Xt*s,f=a;f<o;++f)n=r[f-1],f%a==0?(n=Be[n>>>16&255]<<24^Be[n>>>8&255]<<16^Be[n&255]<<8^Be[n>>>24]^Ra[i]<<24,i++):a>6&&f%a==4&&(n=Be[n>>>24]<<24^Be[n>>>16&255]<<16^Be[n>>>8&255]<<8^Be[n&255]),r[f]=r[f-a]^n;if(t){var u,c=ze[0],h=ze[1],l=ze[2],y=ze[3],p=r.slice(0);o=r.length;for(var f=0,g=o-Xt;f<o;f+=Xt,g-=Xt)if(f===0||f===o-Xt)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var v=0;v<Xt;++v)u=r[g+v],p[f+(3&-v)]=c[Be[u>>>24]]^h[Be[u>>>16&255]]^l[Be[u>>>8&255]]^y[Be[u&255]];r=p}return r}function oi(e,t,r,n){var i=e.length/4-1,a,s,o,f,u;n?(a=ze[0],s=ze[1],o=ze[2],f=ze[3],u=si):(a=Kt[0],s=Kt[1],o=Kt[2],f=Kt[3],u=Be);var c,h,l,y,p,g,v;c=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],y=t[n?1:3]^e[3];for(var m=3,E=1;E<i;++E)p=a[c>>>24]^s[h>>>16&255]^o[l>>>8&255]^f[y&255]^e[++m],g=a[h>>>24]^s[l>>>16&255]^o[y>>>8&255]^f[c&255]^e[++m],v=a[l>>>24]^s[y>>>16&255]^o[c>>>8&255]^f[h&255]^e[++m],y=a[y>>>24]^s[c>>>16&255]^o[h>>>8&255]^f[l&255]^e[++m],c=p,h=g,l=v;r[0]=u[c>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[y&255]^e[++m],r[n?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[y>>>8&255]<<8^u[c&255]^e[++m],r[2]=u[l>>>24]<<24^u[y>>>16&255]<<16^u[c>>>8&255]<<8^u[h&255]^e[++m],r[n?1:3]=u[y>>>24]<<24^u[c>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^e[++m]}function Xr(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=ee.cipher.createDecipher(r,e.key):n=ee.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof ee.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});function Ef(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,f=e.charAt(0),u=Math.log(o)/Math.log(256),c=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,v=0,m=0,E=p.length;m!==E&&p[m]===0;)m++,g++;for(var A=(E-m)*c+1>>>0,P=new Uint8Array(A);m!==E;){for(var _=p[m],R=0,O=A-1;(_!==0||R<v)&&O!==-1;O--,R++)_+=256*P[O]>>>0,P[O]=_%o>>>0,_=_/o>>>0;if(_!==0)throw new Error("Non-zero carry");v=R,m++}for(var W=A-v;W!==A&&P[W]===0;)W++;for(var ve=f.repeat(g);W<A;++W)ve+=e.charAt(P[W]);return ve}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var v=0,m=0;p[g]===f;)v++,g++;for(var E=(p.length-g)*u+1>>>0,A=new Uint8Array(E);p[g];){var P=r[p.charCodeAt(g)];if(P===255)return;for(var _=0,R=E-1;(P!==0||_<m)&&R!==-1;R--,_++)P+=o*A[R]>>>0,A[R]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");m=_,g++}if(p[g]!==" "){for(var O=E-m;O!==E&&A[O]===0;)O++;for(var W=new Uint8Array(v+(E-O)),ve=v;O!==E;)W[ve++]=A[O++];return W}}}function y(p){var g=l(p);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:y}}var Bf,Af,Pa,La=Q(()=>{Bf=Ef,Af=Bf,Pa=Af});var uy,Ka,ut,Ua,qa,xt=Q(()=>{uy=new Uint8Array(0),Ka=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},ut=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Ua=e=>new TextEncoder().encode(e),qa=e=>new TextDecoder().decode(e)});var Fa,Ma,Va,za,Ha,en,vt,Cf,Tf,se,je=Q(()=>{La();xt();Fa=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Ma=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseDecode=n}decode(t){if(typeof t=="string")switch(t[0]){case this.prefix:return this.baseDecode(t.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(t){return za(this,t)}},Va=class{constructor(t){this.decoders=t}or(t){return za(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},za=(e,t)=>new Va({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Ha=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Fa(t,r,n),this.decoder=new Ma(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},en=({name:e,prefix:t,encode:r,decode:n})=>new Ha(e,t,r,n),vt=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=Pa(r,t);return en({prefix:e,name:t,encode:n,decode:a=>ut(i(a))})},Cf=(e,t,r,n)=>{let i={};for(let c=0;c<t.length;++c)i[t[c]]=c;let a=e.length;for(;e[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,f=0,u=0;for(let c=0;c<a;++c){let h=i[e[c]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,s[u++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return s},Tf=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let f=0;f<e.length;++f)for(o=o<<8|e[f],s+=8;s>r;)s-=r,a+=t[i&o>>s];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},se=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>en({prefix:t,name:e,encode(i){return Tf(i,n,r)},decode(i){return Cf(i,n,r,e)}})});var ui={};Ee(ui,{identity:()=>If});var If,Ga=Q(()=>{je();xt();If=en({prefix:"\0",name:"identity",encode:e=>qa(e),decode:e=>Ua(e)})});var fi={};Ee(fi,{base2:()=>_f});var _f,Wa=Q(()=>{je();_f=se({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var ci={};Ee(ci,{base8:()=>Rf});var Rf,ja=Q(()=>{je();Rf=se({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var hi={};Ee(hi,{base10:()=>Df});var Df,Ya=Q(()=>{je();Df=vt({prefix:"9",name:"base10",alphabet:"0123456789"})});var li={};Ee(li,{base16:()=>kf,base16upper:()=>Nf});var kf,Nf,$a=Q(()=>{je();kf=se({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nf=se({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var pi={};Ee(pi,{base32:()=>Jt,base32hex:()=>Uf,base32hexpad:()=>Of,base32hexpadupper:()=>Ff,base32hexupper:()=>qf,base32pad:()=>Lf,base32padupper:()=>Kf,base32upper:()=>Pf,base32z:()=>Mf});var Jt,Pf,Lf,Kf,Uf,qf,Of,Ff,Mf,di=Q(()=>{je();Jt=se({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pf=se({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Lf=se({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Kf=se({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Uf=se({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qf=se({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Of=se({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ff=se({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mf=se({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var yi={};Ee(yi,{base36:()=>Vf,base36upper:()=>zf});var Vf,zf,Za=Q(()=>{je();Vf=vt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zf=vt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var tn={};Ee(tn,{base58btc:()=>Ye,base58flickr:()=>Hf});var Ye,Hf,rn=Q(()=>{je();Ye=vt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Hf=vt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var yr={};Ee(yr,{base64:()=>Gf,base64pad:()=>Wf,base64url:()=>jf,base64urlpad:()=>Yf});var Gf,Wf,jf,Yf,nn=Q(()=>{je();Gf=se({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wf=se({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jf=se({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yf=se({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function Xa(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Xf;)t[r++]=e&255|Qa,e/=128;for(;e&Qf;)t[r++]=e&255|Qa,e>>>=7;return t[r]=e|0,Xa.bytes=r-n+1,t}function gi(e,t){var r=0,t=t||0,n=0,i=t,a,s=e.length;do{if(i>=s)throw gi.bytes=0,new RangeError("Could not decode varint");a=e[i++],r+=n<28?(a&Ja)<<n:(a&Ja)*Math.pow(2,n),n+=7}while(a>=ec);return gi.bytes=i-t,r}var $f,Qa,Zf,Qf,Xf,Jf,ec,Ja,tc,rc,nc,ic,ac,sc,oc,uc,fc,cc,hc,lc,gr,es=Q(()=>{$f=Xa,Qa=128,Zf=127,Qf=~Zf,Xf=Math.pow(2,31);Jf=gi,ec=128,Ja=127;tc=Math.pow(2,7),rc=Math.pow(2,14),nc=Math.pow(2,21),ic=Math.pow(2,28),ac=Math.pow(2,35),sc=Math.pow(2,42),oc=Math.pow(2,49),uc=Math.pow(2,56),fc=Math.pow(2,63),cc=function(e){return e<tc?1:e<rc?2:e<nc?3:e<ic?4:e<ac?5:e<sc?6:e<oc?7:e<uc?8:e<fc?9:10},hc={encode:$f,decode:Jf,encodingLength:cc},lc=hc,gr=lc});var xr,er,tr,an=Q(()=>{es();xr=e=>[gr.decode(e),gr.decode.bytes],er=(e,t,r=0)=>(gr.encode(e,t,r),t),tr=e=>gr.encodingLength(e)});var sn,rs,ns,vr,on=Q(()=>{xt();an();sn=(e,t)=>{let r=t.byteLength,n=tr(e),i=n+tr(r),a=new Uint8Array(i+r);return er(e,a,0),er(r,a,n),a.set(t,i),new vr(e,r,t,a)},rs=e=>{let t=ut(e),[r,n]=xr(t),[i,a]=xr(t.subarray(n)),s=t.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new vr(r,i,s,t)},ns=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&Ka(e.bytes,t.bytes),vr=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}});var mr,as,un=Q(()=>{on();mr=({name:e,code:t,encode:r})=>new as(e,t,r),as=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}async digest(t){if(t instanceof Uint8Array){let r=await this.encode(t);return sn(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var Ut={};Ee(Ut,{sha256:()=>pc,sha512:()=>dc});var os,pc,dc,rr=Q(()=>{un();os=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),pc=mr({name:"sha2-256",code:18,encode:os("SHA-256")}),dc=mr({name:"sha2-512",code:19,encode:os("SHA-512")})});var fn={};Ee(fn,{identity:()=>yc});var yc,xi=Q(()=>{un();xt();yc=mr({name:"identity",code:0,encode:e=>ut(e)})});var us=Q(()=>{xt()});var Dy,ky,fs=Q(()=>{Dy=new TextEncoder,ky=new TextDecoder});var ye,vc,mc,bc,br,wc,cs,hs,cn,hn,Sc,Ec,Bc,ls=Q(()=>{an();on();rn();di();xt();ye=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hn,byteLength:hn,code:cn,version:cn,multihash:cn,bytes:cn,_baseCache:hn,asCID:hn})}toV0(){switch(this.version){case 0:return this;default:{let{code:t,multihash:r}=this;if(t!==br)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==wc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ye.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=sn(t,r);return ye.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(t){return t&&this.code===t.code&&this.version===t.version&&ns(this.multihash,t.multihash)}toString(t){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return mc(r,i,t||Ye.encoder);default:return bc(r,i,t||Jt.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(t){return Ec(/^0\.0/,Bc),!!(t&&(t[hs]||t.asCID===t))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(t){if(t instanceof ye)return t;if(t!=null&&t.asCID===t){let{version:r,code:n,multihash:i,bytes:a}=t;return new ye(r,n,i,a||cs(r,n,i.bytes))}else if(t!=null&&t[hs]===!0){let{version:r,multihash:n,code:i}=t,a=rs(n);return ye.create(r,i,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(t){case 0:{if(r!==br)throw new Error(`Version 0 CID must use dag-pb (code: ${br}) block encoding`);return new ye(t,r,n,n.bytes)}case 1:{let i=cs(t,r,n.bytes);return new ye(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return ye.create(0,br,t)}static createV1(t,r){return ye.create(1,t,r)}static decode(t){let[r,n]=ye.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=ye.inspectBytes(t),n=r.size-r.multihashSize,i=ut(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new vr(r.multihashCode,r.digestSize,a,i);return[r.version===0?ye.createV0(s):ye.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=xr(t.subarray(r));return r+=l,h},i=n(),a=br;if(i===18?(i=0,r=0):i===1&&(a=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),f=n(),u=r+f,c=u-s;return{version:i,codec:a,multihashCode:o,digestSize:f,multihashSize:c,size:u}}static parse(t,r){let[n,i]=vc(t,r),a=ye.decode(i);return a._baseCache.set(n,t),a}},vc=(e,t)=>{switch(e[0]){case"Q":{let r=t||Ye;return[Ye.prefix,r.decode(`${Ye.prefix}${e}`)]}case Ye.prefix:{let r=t||Ye;return[Ye.prefix,r.decode(e)]}case Jt.prefix:{let r=t||Jt;return[Jt.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},mc=(e,t,r)=>{let{prefix:n}=r;if(n!==Ye.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let a=r.encode(e).slice(1);return t.set(n,a),a}else return i},bc=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let a=r.encode(e);return t.set(n,a),a}else return i},br=112,wc=18,cs=(e,t,r)=>{let n=tr(e),i=n+tr(t),a=new Uint8Array(i+r.byteLength);return er(e,a,0),er(t,a,n),a.set(r,i),a},hs=Symbol.for("@ipld/js-cid/CID"),cn={writable:!1,configurable:!1,enumerable:!0},hn={writable:!1,enumerable:!1,configurable:!1},Sc="0.0.0-dev",Ec=(e,t)=>{if(e.test(Sc))console.warn(t);else throw new Error(t)},Bc=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var ps=Q(()=>{ls();an();xt();un();on()});var vi,Vy,ds=Q(()=>{Ga();Wa();ja();Ya();$a();di();Za();rn();nn();rr();xi();us();fs();ps();vi={...ui,...fi,...ci,...hi,...li,...pi,...yi,...tn,...yr},Vy={...Ut,...fn}});function ys(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var gs,mi,Ac,ln,bi=Q(()=>{ds();gs=ys("utf8","u",e=>{let t=new TextDecoder("utf8");return"u"+t.decode(e)},e=>new TextEncoder().encode(e.substring(1))),mi=ys("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Ac={utf8:gs,"utf-8":gs,hex:vi.base16,latin1:mi,ascii:mi,binary:mi,...vi},ln=Ac});var mt={};Ee(mt,{toString:()=>Cc});function Cc(e,t="utf8"){let r=ln[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var bt=Q(()=>{bi()});var wt={};Ee(wt,{fromString:()=>Tc});function Tc(e,t="utf8"){let r=ln[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}var St=Q(()=>{bi()});var ms=C((Yy,vs)=>{"use strict";Jr();var pn=Z(),{toString:nr}=(bt(),mt),{fromString:xs}=(St(),wt);vs.exports={createCipheriv:(e,t,r)=>{let n=pn.cipher.createCipher("AES-CTR",nr(t,"ascii"));return n.start({iv:nr(r,"ascii")}),{update:i=>(n.update(pn.util.createBuffer(nr(i,"ascii"))),xs(n.output.getBytes(),"ascii"))}},createDecipheriv:(e,t,r)=>{let n=pn.cipher.createDecipher("AES-CTR",nr(t,"ascii"));return n.start({iv:nr(r,"ascii")}),{update:i=>(n.update(pn.util.createBuffer(nr(i,"ascii"))),xs(n.output.getBytes(),"ascii"))}}}});var Pe=C(($y,ws)=>{"use strict";function bs(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function Ic(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return bs(e,r)}catch(n){r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),bs(new i,r)}}ws.exports=Ic});var Bs=C((Zy,Es)=>{"use strict";var _c=Pe(),Ss={16:"aes-128-ctr",32:"aes-256-ctr"};Es.exports=function(e){let t=Ss[e.length];if(!t){let r=Object.entries(Ss).map(([n,i])=>`${n} (${i})`).join(" / ");throw _c(new Error(`Invalid key length ${e.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return t}});var Ts=C(Cs=>{"use strict";var As=ms(),Rc=Bs();Cs.create=async function(e,t){let r=Rc(e),n=As.createCipheriv(r,e,t),i=As.createDecipheriv(r,e,t);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}});var _s=C((Xy,Is)=>{"use strict";Is.exports=Dc;function Dc(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(c){if(a)if(a=!1,c)f(c);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{e.apply(t||null,r)}catch(u){a&&(a=!1,f(u))}})}});var Ns=C(ks=>{"use strict";var dn=ks;dn.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var ir=new Array(64),Rs=new Array(123);for(He=0;He<64;)Rs[ir[He]=He<26?He+65:He<52?He+71:He<62?He-4:He-59|43]=He++;var He;dn.encode=function(t,r,n){for(var i=null,a=[],s=0,o=0,f;r<n;){var u=t[r++];switch(o){case 0:a[s++]=ir[u>>2],f=(u&3)<<4,o=1;break;case 1:a[s++]=ir[f|u>>4],f=(u&15)<<2,o=2;break;case 2:a[s++]=ir[f|u>>6],a[s++]=ir[u&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=ir[f],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var Ds="invalid encoding";dn.decode=function(t,r,n){for(var i=n,a=0,s,o=0;o<t.length;){var f=t.charCodeAt(o++);if(f===61&&a>1)break;if((f=Rs[f])===void 0)throw Error(Ds);switch(a){case 0:s=f,a=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,a=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,a=3;break;case 3:r[n++]=(s&3)<<6|f,a=0;break}}if(a===1)throw Error(Ds);return n-i};dn.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var Ls=C((e1,Ps)=>{"use strict";Ps.exports=yn;function yn(){this._listeners={}}yn.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};yn.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};yn.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Vs=C((t1,Ms)=>{"use strict";Ms.exports=Ks(Ks);function Ks(e){return typeof Float32Array!="undefined"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(f,u,c){t[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3]}function a(f,u,c){t[0]=f,u[c]=r[3],u[c+1]=r[2],u[c+2]=r[1],u[c+3]=r[0]}e.writeFloatLE=n?i:a,e.writeFloatBE=n?a:i;function s(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],t[0]}function o(f,u){return r[3]=f[u],r[2]=f[u+1],r[1]=f[u+2],r[0]=f[u+3],t[0]}e.readFloatLE=n?s:o,e.readFloatBE=n?o:s}():function(){function t(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var f=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|u)>>>0,a,s)}}e.writeFloatLE=t.bind(null,Us),e.writeFloatBE=t.bind(null,qs);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,f=s>>>23&255,u=s&8388607;return f===255?u?NaN:o*(1/0):f===0?o*1401298464324817e-60*u:o*Math.pow(2,f-150)*(u+8388608)}e.readFloatLE=r.bind(null,Os),e.readFloatBE=r.bind(null,Fs)}(),typeof Float64Array!="undefined"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(f,u,c){t[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3],u[c+4]=r[4],u[c+5]=r[5],u[c+6]=r[6],u[c+7]=r[7]}function a(f,u,c){t[0]=f,u[c]=r[7],u[c+1]=r[6],u[c+2]=r[5],u[c+3]=r[4],u[c+4]=r[3],u[c+5]=r[2],u[c+6]=r[1],u[c+7]=r[0]}e.writeDoubleLE=n?i:a,e.writeDoubleBE=n?a:i;function s(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],r[4]=f[u+4],r[5]=f[u+5],r[6]=f[u+6],r[7]=f[u+7],t[0]}function o(f,u){return r[7]=f[u],r[6]=f[u+1],r[5]=f[u+2],r[4]=f[u+3],r[3]=f[u+4],r[2]=f[u+5],r[1]=f[u+6],r[0]=f[u+7],t[0]}e.readDoubleLE=n?s:o,e.readDoubleBE=n?o:s}():function(){function t(n,i,a,s,o,f){var u=s<0?1:0;if(u&&(s=-s),s===0)n(0,o,f+i),n(1/s>0?0:2147483648,o,f+a);else if(isNaN(s))n(0,o,f+i),n(2146959360,o,f+a);else if(s>17976931348623157e292)n(0,o,f+i),n((u<<31|2146435072)>>>0,o,f+a);else{var c;if(s<22250738585072014e-324)c=s/5e-324,n(c>>>0,o,f+i),n((u<<31|c/4294967296)>>>0,o,f+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),c=s*Math.pow(2,-h),n(c*4503599627370496>>>0,o,f+i),n((u<<31|h+1023<<20|c*1048576&1048575)>>>0,o,f+a)}}}e.writeDoubleLE=t.bind(null,Us,0,4),e.writeDoubleBE=t.bind(null,qs,4,0);function r(n,i,a,s,o){var f=n(s,o+i),u=n(s,o+a),c=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+f;return h===2047?l?NaN:c*(1/0):h===0?c*5e-324*l:c*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,Os,0,4),e.readDoubleBE=r.bind(null,Fs,4,0)}(),e}function Us(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function qs(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function Os(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Fs(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var zs=C((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Gs=C(Hs=>{"use strict";var wi=Hs;wi.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(t.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};wi.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,f;r<n;)f=t[r++],f<128?s[o++]=f:f>191&&f<224?s[o++]=(f&31)<<6|t[r++]&63:f>239&&f<365?(f=((f&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,s[o++]=55296+(f>>10),s[o++]=56320+(f&1023)):s[o++]=(f&15)<<12|(t[r++]&63)<<6|t[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};wi.write=function(t,r,n){for(var i=n,a,s,o=0;o<t.length;++o)a=t.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)==55296&&((s=t.charCodeAt(o+1))&64512)==56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var js=C((n1,Ws)=>{"use strict";Ws.exports=kc;function kc(e,t,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(f){if(f<1||f>i)return e(f);s+f>n&&(a=e(n),s=0);var u=t.call(a,s,s+=f);return s&7&&(s=(s|7)+1),u}}});var $s=C((i1,Ys)=>{"use strict";Ys.exports=ge;var wr=Bt();function ge(e,t){this.lo=e>>>0,this.hi=t>>>0}var qt=ge.zero=new ge(0,0);qt.toNumber=function(){return 0};qt.zzEncode=qt.zzDecode=function(){return this};qt.length=function(){return 1};var Nc=ge.zeroHash="\0\0\0\0\0\0\0\0";ge.fromNumber=function(t){if(t===0)return qt;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new ge(n,i)};ge.from=function(t){if(typeof t=="number")return ge.fromNumber(t);if(wr.isString(t))if(wr.Long)t=wr.Long.fromString(t);else return ge.fromNumber(parseInt(t,10));return t.low||t.high?new ge(t.low>>>0,t.high>>>0):qt};ge.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};ge.prototype.toLong=function(t){return wr.Long?new wr.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var Et=String.prototype.charCodeAt;ge.fromHash=function(t){return t===Nc?qt:new ge((Et.call(t,0)|Et.call(t,1)<<8|Et.call(t,2)<<16|Et.call(t,3)<<24)>>>0,(Et.call(t,4)|Et.call(t,5)<<8|Et.call(t,6)<<16|Et.call(t,7)<<24)>>>0)};ge.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ge.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};ge.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};ge.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Bt=C(Si=>{"use strict";var k=Si;k.asPromise=_s();k.base64=Ns();k.EventEmitter=Ls();k.float=Vs();k.inquire=zs();k.utf8=Gs();k.pool=js();k.LongBits=$s();k.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Si;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};k.isString=function(t){return typeof t=="string"||t instanceof String};k.isObject=function(t){return t&&typeof t=="object"};k.isset=k.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var e=k.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(t){return typeof t=="number"?k.Buffer?k._Buffer_allocUnsafe(t):new k.Array(t):k.Buffer?k._Buffer_from(t):typeof Uint8Array=="undefined"?t:new Uint8Array(t)};k.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(t){return t?k.LongBits.from(t).toHash():k.LongBits.zeroHash};k.longFromHash=function(t,r){var n=k.LongBits.fromHash(t);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Zs(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}k.merge=Zs;k.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Qs(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Zs(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}k.newError=Qs;k.ProtocolError=Qs("ProtocolError");k.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};k.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var e=k.Buffer;if(!e){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},k._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var _i=C((s1,t0)=>{"use strict";t0.exports=z;var Le=Bt(),Ei,gn=Le.LongBits,Xs=Le.base64,Js=Le.utf8;function Sr(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Bi(){}function Pc(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function z(){this.len=0,this.head=new Sr(Bi,0,0),this.tail=this.head,this.states=null}var e0=function(){return Le.Buffer?function(){return(z.create=function(){return new Ei})()}:function(){return new z}};z.create=e0();z.alloc=function(t){return new Le.Array(t)};Le.Array!==Array&&(z.alloc=Le.pool(z.alloc,Le.Array.prototype.subarray));z.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Sr(t,r,n),this.len+=r,this};function Ai(e,t,r){t[r]=e&255}function Lc(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Ci(e,t){this.len=e,this.next=void 0,this.val=t}Ci.prototype=Object.create(Sr.prototype);Ci.prototype.fn=Lc;z.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Ci((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};z.prototype.int32=function(t){return t<0?this._push(Ti,10,gn.fromNumber(t)):this.uint32(t)};z.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Ti(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}z.prototype.uint64=function(t){var r=gn.from(t);return this._push(Ti,r.length(),r)};z.prototype.int64=z.prototype.uint64;z.prototype.sint64=function(t){var r=gn.from(t).zzEncode();return this._push(Ti,r.length(),r)};z.prototype.bool=function(t){return this._push(Ai,1,t?1:0)};function Ii(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}z.prototype.fixed32=function(t){return this._push(Ii,4,t>>>0)};z.prototype.sfixed32=z.prototype.fixed32;z.prototype.fixed64=function(t){var r=gn.from(t);return this._push(Ii,4,r.lo)._push(Ii,4,r.hi)};z.prototype.sfixed64=z.prototype.fixed64;z.prototype.float=function(t){return this._push(Le.float.writeFloatLE,4,t)};z.prototype.double=function(t){return this._push(Le.float.writeDoubleLE,8,t)};var Kc=Le.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};z.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Ai,1,0);if(Le.isString(t)){var n=z.alloc(r=Xs.length(t));Xs.decode(t,n,0),t=n}return this.uint32(r)._push(Kc,r,t)};z.prototype.string=function(t){var r=Js.length(t);return r?this.uint32(r)._push(Js.write,r,t):this._push(Ai,1,0)};z.prototype.fork=function(){return this.states=new Pc(this),this.head=this.tail=new Sr(Bi,0,0),this.len=0,this};z.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Sr(Bi,0,0),this.len=0),this};z.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};z.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};z._configure=function(e){Ei=e,z.create=e0(),Ei._configure()}});var i0=C((o1,n0)=>{"use strict";n0.exports=$e;var r0=_i();($e.prototype=Object.create(r0.prototype)).constructor=$e;var At=Bt();function $e(){r0.call(this)}$e._configure=function(){$e.alloc=At._Buffer_allocUnsafe,$e.writeBytesBuffer=At.Buffer&&At.Buffer.prototype instanceof Uint8Array&&At.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};$e.prototype.bytes=function(t){At.isString(t)&&(t=At._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push($e.writeBytesBuffer,r,t),this};function Uc(e,t,r){e.length<40?At.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}$e.prototype.string=function(t){var r=At.Buffer.byteLength(t);return this.uint32(r),r&&this._push(Uc,r,t),this};$e._configure()});var ki=C((u1,f0)=>{"use strict";f0.exports=fe;var Ze=Bt(),Ri,a0=Ze.LongBits,qc=Ze.utf8;function Ge(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function fe(e){this.buf=e,this.pos=0,this.len=e.length}var s0=typeof Uint8Array!="undefined"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new fe(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new fe(t);throw Error("illegal buffer")},o0=function(){return Ze.Buffer?function(r){return(fe.create=function(i){return Ze.Buffer.isBuffer(i)?new Ri(i):s0(i)})(r)}:s0};fe.create=o0();fe.prototype._slice=Ze.Array.prototype.subarray||Ze.Array.prototype.slice;fe.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Ge(this,10);return t}}();fe.prototype.int32=function(){return this.uint32()|0};fe.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Di(){var e=new a0(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Ge(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Ge(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}fe.prototype.bool=function(){return this.uint32()!==0};function xn(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}fe.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ge(this,4);return xn(this.buf,this.pos+=4)};fe.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ge(this,4);return xn(this.buf,this.pos+=4)|0};function u0(){if(this.pos+8>this.len)throw Ge(this,8);return new a0(xn(this.buf,this.pos+=4),xn(this.buf,this.pos+=4))}fe.prototype.float=function(){if(this.pos+4>this.len)throw Ge(this,4);var t=Ze.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};fe.prototype.double=function(){if(this.pos+8>this.len)throw Ge(this,4);var t=Ze.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};fe.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Ge(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};fe.prototype.string=function(){var t=this.bytes();return qc.read(t,0,t.length)};fe.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Ge(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Ge(this);while(this.buf[this.pos++]&128);return this};fe.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!=4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};fe._configure=function(e){Ri=e,fe.create=o0(),Ri._configure();var t=Ze.Long?"toLong":"toNumber";Ze.merge(fe.prototype,{int64:function(){return Di.call(this)[t](!1)},uint64:function(){return Di.call(this)[t](!0)},sint64:function(){return Di.call(this).zzDecode()[t](!1)},fixed64:function(){return u0.call(this)[t](!0)},sfixed64:function(){return u0.call(this)[t](!1)}})}});var p0=C((f1,l0)=>{"use strict";l0.exports=Ot;var c0=ki();(Ot.prototype=Object.create(c0.prototype)).constructor=Ot;var h0=Bt();function Ot(e){c0.call(this,e)}Ot._configure=function(){h0.Buffer&&(Ot.prototype._slice=h0.Buffer.prototype.slice)};Ot.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Ot._configure()});var y0=C((c1,d0)=>{"use strict";d0.exports=Er;var Ni=Bt();(Er.prototype=Object.create(Ni.EventEmitter.prototype)).constructor=Er;function Er(e,t,r){if(typeof e!="function")throw TypeError("rpcImpl must be a function");Ni.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}Er.prototype.rpcCall=function e(t,r,n,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return Ni.asPromise(e,s,t,r,n,i);if(!s.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(f,u){if(f)return s.emit("error",f,t),a(f);if(u===null){s.end(!0);return}if(!(u instanceof n))try{u=n[s.responseDelimited?"decodeDelimited":"decode"](u)}catch(c){return s.emit("error",c,t),a(c)}return s.emit("data",u,t),a(null,u)})}catch(o){s.emit("error",o,t),setTimeout(function(){a(o)},0);return}};Er.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var x0=C(g0=>{"use strict";var Oc=g0;Oc.Service=y0()});var m0=C((l1,v0)=>{"use strict";v0.exports={}});var S0=C(w0=>{"use strict";var Ie=w0;Ie.build="minimal";Ie.Writer=_i();Ie.BufferWriter=i0();Ie.Reader=ki();Ie.BufferReader=p0();Ie.util=Bt();Ie.rpc=x0();Ie.roots=m0();Ie.configure=b0;function b0(){Ie.util._configure(),Ie.Writer._configure(Ie.BufferWriter),Ie.Reader._configure(Ie.BufferReader)}b0()});var B0=C((d1,E0)=>{"use strict";E0.exports=S0()});var mn=C((y1,C0)=>{"use strict";var Ft=B0(),vn=Ft.Reader,A0=Ft.Writer,me=Ft.util,Ke=Ft.roots["libp2p-crypto-keys"]||(Ft.roots["libp2p-crypto-keys"]={});Ke.KeyType=function(){var e={},t=Object.create(e);return t[e[0]="RSA"]=0,t[e[1]="Ed25519"]=1,t[e[2]="Secp256k1"]=2,t}();Ke.PublicKey=function(){function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=me.newBuffer([]),e.encode=function(r,n){return n||(n=A0.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},e.decode=function(r,n){r instanceof vn||(r=vn.create(r));for(var i=n===void 0?r.len:r.pos+n,a=new Ke.PublicKey;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.Type=r.int32();break;case 2:a.Data=r.bytes();break;default:r.skipType(s&7);break}}if(!a.hasOwnProperty("Type"))throw me.ProtocolError("missing required 'Type'",{instance:a});if(!a.hasOwnProperty("Data"))throw me.ProtocolError("missing required 'Data'",{instance:a});return a},e.fromObject=function(r){if(r instanceof Ke.PublicKey)return r;var n=new Ke.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?me.base64.decode(r.Data,n.Data=me.newBuffer(me.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},e.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=me.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Ke.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?me.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ft.util.toJSONOptions)},e}();Ke.PrivateKey=function(){function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=me.newBuffer([]),e.encode=function(r,n){return n||(n=A0.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},e.decode=function(r,n){r instanceof vn||(r=vn.create(r));for(var i=n===void 0?r.len:r.pos+n,a=new Ke.PrivateKey;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.Type=r.int32();break;case 2:a.Data=r.bytes();break;default:r.skipType(s&7);break}}if(!a.hasOwnProperty("Type"))throw me.ProtocolError("missing required 'Type'",{instance:a});if(!a.hasOwnProperty("Data"))throw me.ProtocolError("missing required 'Data'",{instance:a});return a},e.fromObject=function(r){if(r instanceof Ke.PrivateKey)return r;var n=new Ke.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?me.base64.decode(r.Data,n.Data=me.newBuffer(me.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},e.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=me.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Ke.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?me.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ft.util.toJSONOptions)},e}();C0.exports=Ke});var bn=C((g1,T0)=>{var Br=Z();Br.pki=Br.pki||{};var Pi=T0.exports=Br.pki.oids=Br.oids=Br.oids||{};function B(e,t){Pi[e]=t,Pi[t]=e}function Y(e,t){Pi[e]=t}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.5","serialName");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");Y("2.5.29.1","authorityKeyIdentifier");Y("2.5.29.2","keyAttributes");Y("2.5.29.3","certificatePolicies");Y("2.5.29.4","keyUsageRestriction");Y("2.5.29.5","policyMapping");Y("2.5.29.6","subtreesConstraint");Y("2.5.29.7","subjectAltName");Y("2.5.29.8","issuerAltName");Y("2.5.29.9","subjectDirectoryAttributes");Y("2.5.29.10","basicConstraints");Y("2.5.29.11","nameConstraints");Y("2.5.29.12","policyConstraints");Y("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");Y("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");Y("2.5.29.20","cRLNumber");Y("2.5.29.21","cRLReason");Y("2.5.29.22","expirationDate");Y("2.5.29.23","instructionCode");Y("2.5.29.24","invalidityDate");Y("2.5.29.25","cRLDistributionPoints");Y("2.5.29.26","issuingDistributionPoint");Y("2.5.29.27","deltaCRLIndicator");Y("2.5.29.28","issuingDistributionPoint");Y("2.5.29.29","certificateIssuer");Y("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");Y("2.5.29.33","policyMappings");Y("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");Y("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");Y("2.5.29.46","freshestCRL");Y("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Cr=C((x1,_0)=>{var ne=Z();ue();bn();var T=_0.exports=ne.asn1=ne.asn1||{};T.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};T.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};T.create=function(e,t,r,n,i){if(ne.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:e,type:t,constructed:r,composed:r||ne.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=T.copy(o)),o};T.copy=function(e,t){var r;if(ne.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(T.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:T.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};T.equals=function(e,t,r){if(ne.util.isArray(e)){if(!ne.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!T.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&T.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};T.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Ar(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var Fc=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Ar(e,t,a),n=e.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};T.fromDer=function(e,t){return t===void 0&&(t={strict:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=ne.util.createBuffer(e)),wn(e,e.length(),0,t)};function wn(e,t,r,n){var i;Ar(e,t,2);var a=e.getByte();t--;var s=a&192,o=a&31;i=e.length();var f=Fc(e,t);if(t-=i-e.length(),f!==void 0&&f>t){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=e.length(),u.remaining=t,u.requested=f,u}f=t}var c,h,l=(a&32)==32;if(l)if(c=[],f===void 0)for(;;){if(Ar(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),c.push(wn(e,t,r+1,n)),t-=i-e.length()}else for(;f>0;)i=e.length(),c.push(wn(e,f,r+1,n)),t-=i-e.length(),f-=i-e.length();if(c===void 0&&s===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&(h=e.bytes(f)),c===void 0&&n.decodeBitStrings&&s===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&f>1){var y=e.read,p=t,g=0;if(o===T.Type.BITSTRING&&(Ar(e,t,1),g=e.getByte(),t--),g===0)try{i=e.length();var v={verbose:n.verbose,strict:!0,decodeBitStrings:!0},m=wn(e,t,r+1,v),E=i-e.length();t-=E,o==T.Type.BITSTRING&&E++;var A=m.tagClass;E===f&&(A===T.Class.UNIVERSAL||A===T.Class.CONTEXT_SPECIFIC)&&(c=[m])}catch(_){}c===void 0&&(e.read=y,t=p)}if(c===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(o===T.Type.BMPSTRING)for(c="";f>0;f-=2)Ar(e,t,2),c+=String.fromCharCode(e.getInt16()),t-=2;else c=e.getBytes(f)}var P=h===void 0?null:{bitStringContents:h};return T.create(s,o,l,c,P)}T.toDer=function(e){var t=ne.util.createBuffer(),r=e.tagClass|e.type,n=ne.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=T.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var a=0;a<e.value.length;++a)e.value[a]!==void 0&&n.putBuffer(T.toDer(e.value[a]))}else if(e.type===T.Type.BMPSTRING)for(var a=0;a<e.value.length;++a)n.putInt16(e.value.charCodeAt(a));else e.type===T.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)==0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)==128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)t.putByte(o.charCodeAt(a))}return t.putBuffer(n),t};T.oidToDer=function(e){var t=e.split("."),r=ne.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,a,s,o=2;o<t.length;++o){n=!0,i=[],a=parseInt(t[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};T.derToOid=function(e){var t;typeof e=="string"&&(e=ne.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};T.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),a=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var f=e.charAt(10),u=10;f!=="+"&&f!=="-"&&(o=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,0),u&&(f=e.charAt(u),f==="+"||f==="-")){var c=parseInt(e.substr(u+1,2),10),h=parseInt(e.substr(u+4,2),10),l=c*60+h;l*=6e4,f==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};T.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),f=0,u=0,c=!1;e.charAt(e.length-1)==="Z"&&(c=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var y=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);u=y*60+p,u*=6e4,l==="+"&&(u*=-1),c=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),c?(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,f),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(a,s,o,f)),t};T.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};T.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};T.integerToDer=function(e){var t=ne.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};T.derToInteger=function(e){typeof e=="string"&&(e=ne.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};T.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass=="undefined")&&(e.type===t.type||typeof t.type=="undefined"))if(e.constructed===t.constructed||typeof t.constructed=="undefined"){if(i=!0,t.value&&ne.util.isArray(t.value))for(var a=0,s=0;i&&s<t.value.length;++s)i=t.value[s].optional||!1,e.value[a]&&(i=T.validate(e.value[a],t.value[s],r,n),i?++a:t.value[s].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var o;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var I0=/[^\\u0000-\\u00ff]/;T.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",a=0;a<t*r;++a)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case T.Class.UNIVERSAL:n+="Universal:";break;case T.Class.APPLICATION:n+="Application:";break;case T.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case T.Class.PRIVATE:n+="Private:";break}if(e.tagClass===T.Class.UNIVERSAL)switch(n+=e.type,e.type){case T.Type.NONE:n+=" (None)";break;case T.Type.BOOLEAN:n+=" (Boolean)";break;case T.Type.INTEGER:n+=" (Integer)";break;case T.Type.BITSTRING:n+=" (Bit string)";break;case T.Type.OCTETSTRING:n+=" (Octet string)";break;case T.Type.NULL:n+=" (Null)";break;case T.Type.OID:n+=" (Object Identifier)";break;case T.Type.ODESC:n+=" (Object Descriptor)";break;case T.Type.EXTERNAL:n+=" (External or Instance of)";break;case T.Type.REAL:n+=" (Real)";break;case T.Type.ENUMERATED:n+=" (Enumerated)";break;case T.Type.EMBEDDED:n+=" (Embedded PDV)";break;case T.Type.UTF8:n+=" (UTF8)";break;case T.Type.ROID:n+=" (Relative Object Identifier)";break;case T.Type.SEQUENCE:n+=" (Sequence)";break;case T.Type.SET:n+=" (Set)";break;case T.Type.PRINTABLESTRING:n+=" (Printable String)";break;case T.Type.IA5String:n+=" (IA5String (ASCII))";break;case T.Type.UTCTIME:n+=" (UTC time)";break;case T.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case T.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,o="",a=0;a<e.value.length;++a)e.value[a]!==void 0&&(s+=1,o+=T.prettyPrint(e.value[a],t+1,r),a+1<e.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",e.type===T.Type.OID){var f=T.derToOid(e.value);n+=f,ne.pki&&ne.pki.oids&&f in ne.pki.oids&&(n+=" ("+ne.pki.oids[f]+") ")}if(e.type===T.Type.INTEGER)try{n+=T.derToInteger(e.value)}catch(c){n+="0x"+ne.util.bytesToHex(e.value)}else if(e.type===T.Type.BITSTRING){if(e.value.length>1?n+="0x"+ne.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var u=e.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else e.type===T.Type.OCTETSTRING?(I0.test(e.value)||(n+="("+e.value+") "),n+="0x"+ne.util.bytesToHex(e.value)):e.type===T.Type.UTF8?n+=ne.util.decodeUtf8(e.value):e.type===T.Type.PRINTABLESTRING||e.type===T.Type.IA5String?n+=e.value:I0.test(e.value)?n+="0x"+ne.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var k0=C((v1,D0)=>{var ie=Z();ri();ii();ue();D0.exports=ie.des=ie.des||{};ie.des.startEncrypting=function(e,t,r,n){var i=Sn({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};ie.des.createEncryptionCipher=function(e,t){return Sn({key:e,output:null,decrypt:!1,mode:t})};ie.des.startDecrypting=function(e,t,r,n){var i=Sn({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};ie.des.createDecryptionCipher=function(e,t){return Sn({key:e,output:null,decrypt:!0,mode:t})};ie.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return R0(r._keys,n,i,!1)},decrypt:function(n,i){return R0(r._keys,n,i,!0)}}}),r._init=!1};ie.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=ie.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=$c(t),this._init=!0}};Qe("DES-ECB",ie.cipher.modes.ecb);Qe("DES-CBC",ie.cipher.modes.cbc);Qe("DES-CFB",ie.cipher.modes.cfb);Qe("DES-OFB",ie.cipher.modes.ofb);Qe("DES-CTR",ie.cipher.modes.ctr);Qe("3DES-ECB",ie.cipher.modes.ecb);Qe("3DES-CBC",ie.cipher.modes.cbc);Qe("3DES-CFB",ie.cipher.modes.cfb);Qe("3DES-OFB",ie.cipher.modes.ofb);Qe("3DES-CTR",ie.cipher.modes.ctr);function Qe(e,t){var r=function(){return new ie.des.Algorithm(e,t)};ie.cipher.registerAlgorithm(e,r)}var Mc=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Vc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],zc=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Hc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Gc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Wc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],jc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Yc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function $c(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,A,P=0;P<g;P++){var _=e.getInt32(),R=e.getInt32();A=(_>>>4^R)&252645135,R^=A,_^=A<<4,A=(R>>>-16^_)&65535,_^=A,R^=A<<-16,A=(_>>>2^R)&858993459,R^=A,_^=A<<2,A=(R>>>-16^_)&65535,_^=A,R^=A<<-16,A=(_>>>1^R)&1431655765,R^=A,_^=A<<1,A=(R>>>8^_)&16711935,_^=A,R^=A<<8,A=(_>>>1^R)&1431655765,R^=A,_^=A<<1,A=_<<8|R>>>20&240,_=R<<24|R<<8&16711680|R>>>8&65280|R>>>24&240,R=A;for(var O=0;O<m.length;++O){m[O]?(_=_<<2|_>>>26,R=R<<2|R>>>26):(_=_<<1|_>>>27,R=R<<1|R>>>27),_&=-15,R&=-15;var W=t[_>>>28]|r[_>>>24&15]|n[_>>>20&15]|i[_>>>16&15]|a[_>>>12&15]|s[_>>>8&15]|o[_>>>4&15],ve=f[R>>>28]|u[R>>>24&15]|c[R>>>20&15]|h[R>>>16&15]|l[R>>>12&15]|y[R>>>8&15]|p[R>>>4&15];A=(ve>>>16^W)&65535,v[E++]=W^A,v[E++]=ve^A<<16}}return v}function R0(e,t,r,n){var i=e.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=t[0],f=t[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var u=0;u<i;u+=3){for(var c=a[u+1],h=a[u+2],l=a[u];l!=c;l+=h){var y=f^e[l],p=(f>>>4|f<<28)^e[l+1];s=o,o=f,f=s^(Vc[y>>>24&63]|Hc[y>>>16&63]|Wc[y>>>8&63]|Yc[y&63]|Mc[p>>>24&63]|zc[p>>>16&63]|Gc[p>>>8&63]|jc[p&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,r[0]=o,r[1]=f}function Sn(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=ie.cipher.createDecipher(r,e.key):n=ie.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof ie.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Mt=C((m1,N0)=>{var En=Z();N0.exports=En.md=En.md||{};En.md.algorithms=En.md.algorithms||{}});var L0=C((b1,P0)=>{var ft=Z();Mt();ue();var Zc=P0.exports=ft.hmac=ft.hmac||{};Zc.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in ft.md.algorithms)t=ft.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else t=a;if(s===null)s=e;else{if(typeof s=="string")s=ft.util.createBuffer(s);else if(ft.util.isArray(s)){var o=s;s=ft.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var u=s.length();u>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=ft.util.createBuffer(),n=ft.util.createBuffer(),u=s.length();for(var f=0;f<u;++f){var o=s.at(f);r.putByte(54^o),n.putByte(92^o)}if(u<t.blockLength)for(var o=t.blockLength-u,f=0;f<o;++f)r.putByte(54),n.putByte(92);e=s,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(a){t.update(a)},i.getMac=function(){var a=t.digest().bytes();return t.start(),t.update(n),t.update(a),t.digest()},i.digest=i.getMac,i}});var ar=C(()=>{});var Li=C((E1,K0)=>{var Ae=Z();L0();Mt();ue();var Qc=Ae.pkcs5=Ae.pkcs5||{},ct;Ae.util.isNodejs&&!Ae.options.usePureJavaScript&&(ct=ar());K0.exports=Ae.pbkdf2=Qc.pbkdf2=function(e,t,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Ae.util.isNodejs&&!Ae.options.usePureJavaScript&&ct.pbkdf2&&(i===null||typeof i!="object")&&(ct.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),a?ct.pbkdf2Sync.length===4?ct.pbkdf2(e,t,r,n,function(A,P){if(A)return a(A);a(null,P.toString("binary"))}):ct.pbkdf2(e,t,r,n,i,function(A,P){if(A)return a(A);a(null,P.toString("binary"))}):ct.pbkdf2Sync.length===4?ct.pbkdf2Sync(e,t,r,n).toString("binary"):ct.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ae.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ae.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var f=Math.ceil(n/s),u=n-(f-1)*s,c=Ae.hmac.create();c.start(i,e);var h="",l,y,p;if(!a){for(var g=1;g<=f;++g){c.start(null,null),c.update(t),c.update(Ae.util.int32ToBytes(g)),l=p=c.digest().getBytes();for(var v=2;v<=r;++v)c.start(null,null),c.update(p),y=c.digest().getBytes(),l=Ae.util.xorBytes(l,y,s),p=y;h+=g<f?l:l.substr(0,u)}return h}var g=1,v;function m(){if(g>f)return a(null,h);c.start(null,null),c.update(t),c.update(Ae.util.int32ToBytes(g)),l=p=c.digest().getBytes(),v=2,E()}function E(){if(v<=r)return c.start(null,null),c.update(p),y=c.digest().getBytes(),l=Ae.util.xorBytes(l,y,s),p=y,++v,Ae.util.setImmediate(E);h+=g<f?l:l.substr(0,u),++g,m()}m()}});var O0=C((B1,q0)=>{var Bn=Z();ue();var U0=q0.exports=Bn.pem=Bn.pem||{};U0.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=An(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=An(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=An(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=An(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Bn.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};U0.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(e),!!a;){var s={type:a[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:Bn.util.decode64(a[3])};if(t.push(s),!!a[2]){for(var o=a[2].split(i),f=0;a&&f<o.length;){for(var u=o[f].replace(/\s+$/,""),c=f+1;c<o.length;++c){var h=o[c];if(!/\s/.test(h[0]))break;u+=h,f=c}if(a=u.match(n),a){for(var l={name:a[1],values:[]},y=a[2].split(","),p=0;p<y.length;++p)l.values.push(Xc(y[p]));if(s.procType)if(!s.contentDomain&&l.name==="Content-Domain")s.contentDomain=y[0]||"";else if(!s.dekInfo&&l.name==="DEK-Info"){if(l.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');s.dekInfo={algorithm:y[0],parameters:y[1]||null}}else s.headers.push(l);else{if(l.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(l.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');s.procType={version:y[0],type:y[1]}}}++f}if(s.procType==="ENCRYPTED"&&!s.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function An(e){for(var t=e.name+": ",r=[],n=function(f,u){return" "+u},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<t.length;++i,++a)if(a>65&&s!==-1){var o=t[s];o===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+o+t.substr(s+1),a=i-s-1,s=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(s=i);return t}function Xc(e){return e.replace(/^\s+/,"")}});var G0=C((A1,H0)=>{var Xe=Z();Mt();ue();var F0=H0.exports=Xe.sha256=Xe.sha256||{};Xe.md.sha256=Xe.md.algorithms.sha256=F0;F0.create=function(){M0||Jc();var e=null,t=Xe.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return t=Xe.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Xe.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),z0(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Xe.util.createBuffer();i.putBytes(t.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Ki.substr(0,n.blockLength-s));for(var o,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)o=n.fullMessageLength[c+1]*8,f=o/4294967296>>>0,u+=f,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};z0(h,r,i);var l=Xe.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Ki=null,M0=!1,V0=null;function Jc(){Ki=String.fromCharCode(128),Ki+=Xe.util.fillString(String.fromCharCode(0),64),V0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],M0=!0}function z0(e,t,r){for(var n,i,a,s,o,f,u,c,h,l,y,p,g,v,m,E=r.length();E>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=t[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(c=e.h0,h=e.h1,l=e.h2,y=e.h3,p=e.h4,g=e.h5,v=e.h6,m=e.h7,u=0;u<64;++u)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=v^p&(g^v),a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&h|l&(c^h),n=m+s+o+V0[u]+t[u],i=a+f,m=v,v=g,g=p,p=y+n>>>0,y=l,l=h,h=c,c=n+i>>>0;e.h0=e.h0+c|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+y|0,e.h4=e.h4+p|0,e.h5=e.h5+g|0,e.h6=e.h6+v|0,e.h7=e.h7+m|0,E-=64}}});var j0=C((C1,W0)=>{var Je=Z();ue();var Cn=null;Je.util.isNodejs&&!Je.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Cn=ar());var eh=W0.exports=Je.prng=Je.prng||{};eh.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(u,c){if(!c)return t.generateSync(u);var h=t.plugin.cipher,l=t.plugin.increment,y=t.plugin.formatKey,p=t.plugin.formatSeed,g=Je.util.createBuffer();t.key=null,v();function v(m){if(m)return c(m);if(g.length()>=u)return c(null,g.getBytes(u));if(t.generated>1048575&&(t.key=null),t.key===null)return Je.util.nextTick(function(){a(v)});var E=h(t.key,t.seed);t.generated+=E.length,g.putBytes(E),t.key=y(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),Je.util.setImmediate(v)}},t.generateSync=function(u){var c=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,y=t.plugin.formatSeed;t.key=null;for(var p=Je.util.createBuffer();p.length()<u;){t.generated>1048575&&(t.key=null),t.key===null&&s();var g=c(t.key,t.seed);t.generated+=g.length,p.putBytes(g),t.key=l(c(t.key,h(t.seed))),t.seed=y(c(t.key,t.seed))}return p.getBytes(u)};function a(u){if(t.pools[0].messageLength>=32)return o(),u();var c=32-t.pools[0].messageLength<<5;t.seedFile(c,function(h,l){if(h)return u(h);t.collect(l),o(),u()})}function s(){if(t.pools[0].messageLength>=32)return o();var u=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(u)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var u=t.plugin.md.create();u.update(t.keyBytes);for(var c=1,h=0;h<32;++h)t.reseeds%c==0&&(u.update(t.pools[h].digest().getBytes()),t.pools[h].start()),c=c<<1;t.keyBytes=u.digest().getBytes(),u.start(),u.update(t.keyBytes);var l=u.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function f(u){var c=null,h=Je.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(c=function(_){return l.getRandomValues(_)});var y=Je.util.createBuffer();if(c)for(;y.length()<u;){var p=Math.max(1,Math.min(u-y.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{c(g);for(var v=0;v<g.length;++v)y.putInt32(g[v])}catch(_){if(!(typeof QuotaExceededError!="undefined"&&_ instanceof QuotaExceededError))throw _}}if(y.length()<u)for(var m,E,A,P=Math.floor(Math.random()*65536);y.length()<u;){E=16807*(P&65535),m=16807*(P>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),P=E&4294967295;for(var v=0;v<3;++v)A=P>>>(v<<3),A^=Math.floor(Math.random()*256),y.putByte(String.fromCharCode(A&255))}return y.getBytes(u)}return Cn?(t.seedFile=function(u,c){Cn.randomBytes(u,function(h,l){if(h)return c(h);c(null,l.toString())})},t.seedFileSync=function(u){return Cn.randomBytes(u).toString()}):(t.seedFile=function(u,c){try{c(null,f(u))}catch(h){c(h)}},t.seedFileSync=f),t.collect=function(u){for(var c=u.length,h=0;h<c;++h)t.pools[t.pool].update(u.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(u,c){for(var h="",l=0;l<c;l+=8)h+=String.fromCharCode(u>>l&255);t.collect(h)},t.registerWorker=function(u){if(u===self)t.seedFile=function(h,l){function y(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",y),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:h}}})};else{var c=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(y,p){u.postMessage({forge:{prng:{err:y,bytes:p}}})})};u.addEventListener("message",c)}},t}});var Tr=C((T1,Ui)=>{var xe=Z();Jr();G0();j0();ue();(function(){if(xe.random&&xe.random.getBytes){Ui.exports=xe.random;return}(function(e){var t={},r=new Array(4),n=xe.util.createBuffer();t.formatKey=function(h){var l=xe.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),xe.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=xe.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return xe.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=xe.md.sha256;function i(){var h=xe.prng.create(t);return h.getBytes=function(l,y){return h.generate(l,y)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=xe.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),xe.options.usePureJavaScript||!xe.util.isNodejs&&!s){if(typeof window=="undefined"||window.document===void 0,a.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var c in navigator)try{typeof navigator[c]=="string"&&(u+=navigator[c])}catch(h){}a.collect(u),u=null}e&&(e().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),e().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!xe.random)xe.random=a;else for(var c in a)xe.random[c]=a[c];xe.random.createInstance=i,Ui.exports=xe.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Q0=C((I1,Z0)=>{var _e=Z();ue();var qi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Y0=[1,2,3,5],th=function(e,t){return e<<t&65535|(e&65535)>>16-t},rh=function(e,t){return(e&65535)>>t|e<<16-t&65535};Z0.exports=_e.rc2=_e.rc2||{};_e.rc2.expandKey=function(e,t){typeof e=="string"&&(e=_e.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(qi[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,qi[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,qi[r.at(o+1)^r.at(o+a)]);return r};var $0=function(e,t,r){var n=!1,i=null,a=null,s=null,o,f,u,c,h=[];for(e=_e.rc2.expandKey(e,t),u=0;u<64;u++)h.push(e.getInt16Le());r?(o=function(p){for(u=0;u<4;u++)p[u]+=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=th(p[u],Y0[u]),c++},f=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(o=function(p){for(u=3;u>=0;u--)p[u]=rh(p[u],Y0[u]),p[u]-=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),c--},f=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var g=[];for(u=0;u<4;u++){var v=i.getInt16Le();s!==null&&(r?v^=s.getInt16Le():s.putInt16Le(v)),g.push(v&65535)}c=r?0:63;for(var m=0;m<p.length;m++)for(var E=0;E<p[m][0];E++)p[m][1](g);for(u=0;u<4;u++)s!==null&&(r?s.putInt16Le(g[u]):g[u]^=s.getInt16Le()),a.putInt16Le(g[u])},y=null;return y={start:function(p,g){p&&typeof p=="string"&&(p=_e.util.createBuffer(p)),n=!1,i=_e.util.createBuffer(),a=g||new _e.util.createBuffer,s=p,y.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,y.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var m=a.length(),E=a.at(m-1);E>m?g=!1:a.truncate(E)}return g}},y};_e.rc2.startEncrypting=function(e,t,r){var n=_e.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};_e.rc2.createEncryptionCipher=function(e,t){return $0(e,t,!0)};_e.rc2.startDecrypting=function(e,t,r){var n=_e.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};_e.rc2.createDecryptionCipher=function(e,t){return $0(e,t,!1)}});var _n=C((_1,ao)=>{var Oi=Z();ao.exports=Oi.jsbn=Oi.jsbn||{};var ht,nh=244837814094590,X0=(nh&16777215)==15715070;function w(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Oi.jsbn.BigInteger=w;function H(){return new w(null)}function ih(e,t,r,n,i,a){for(;--a>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function ah(e,t,r,n,i,a){for(var s=t&32767,o=t>>15;--a>=0;){var f=this.data[e]&32767,u=this.data[e++]>>15,c=o*f+u*s;f=s*f+((c&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(c>>>15)+o*u+(i>>>30),r.data[n++]=f&1073741823}return i}function J0(e,t,r,n,i,a){for(var s=t&16383,o=t>>14;--a>=0;){var f=this.data[e]&16383,u=this.data[e++]>>14,c=o*f+u*s;f=s*f+((c&16383)<<14)+r.data[n]+i,i=(f>>28)+(c>>14)+o*u,r.data[n++]=f&268435455}return i}typeof navigator=="undefined"?(w.prototype.am=J0,ht=28):X0&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=ah,ht=30):X0&&navigator.appName!="Netscape"?(w.prototype.am=ih,ht=26):(w.prototype.am=J0,ht=28);w.prototype.DB=ht;w.prototype.DM=(1<<ht)-1;w.prototype.DV=1<<ht;var Fi=52;w.prototype.FV=Math.pow(2,Fi);w.prototype.F1=Fi-ht;w.prototype.F2=2*ht-Fi;var sh="0123456789abcdefghijklmnopqrstuvwxyz",Tn=new Array,sr,Ue;sr="0".charCodeAt(0);for(Ue=0;Ue<=9;++Ue)Tn[sr++]=Ue;sr="a".charCodeAt(0);for(Ue=10;Ue<36;++Ue)Tn[sr++]=Ue;sr="A".charCodeAt(0);for(Ue=10;Ue<36;++Ue)Tn[sr++]=Ue;function eo(e){return sh.charAt(e)}function to(e,t){var r=Tn[e.charCodeAt(t)];return r??-1}function oh(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function uh(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function Ct(e){var t=H();return t.fromInt(e),t}function fh(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,a=0;--n>=0;){var s=r==8?e[n]&255:to(e,n);if(s<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&w.ZERO.subTo(this,this)}function ch(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function hh(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=eo(n));s>=0;)o<t?(n=(this.data[s]&(1<<o)-1)<<t-o,n|=this.data[--s]>>(o+=this.DB-t)):(n=this.data[s]>>(o-=t)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=eo(n));return i?a:"0"}function lh(){var e=H();return w.ZERO.subTo(this,e),e}function ph(){return this.s<0?this.negate():this}function dh(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function In(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function yh(){return this.t<=0?0:this.DB*(this.t-1)+In(this.data[this.t-1]^this.s&this.DM)}function gh(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function xh(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function vh(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(e/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)t.data[o]=0;t.data[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()}function mh(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,a=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&a)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&a)<<i),t.t=this.t-r,t.clamp()}function bh(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function wh(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&w.ZERO.subTo(t,t)}function Sh(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function Eh(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=H());var a=H(),s=this.s,o=e.s,f=this.DB-In(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var u=a.t,c=a.data[u-1];if(c!=0){var h=c*(1<<this.F1)+(u>1?a.data[u-2]>>this.F2:0),l=this.FV/h,y=(1<<this.F1)/h,p=1<<this.F2,g=r.t,v=g-u,m=t??H();for(a.dlShiftTo(v,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),w.ONE.dlShiftTo(u,m),m.subTo(a,a);a.t<u;)a.data[a.t++]=0;for(;--v>=0;){var E=r.data[--g]==c?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*y);if((r.data[g]+=a.am(0,E,r,v,0,u))<E)for(a.dlShiftTo(v,m),r.subTo(m,r);r.data[g]<--E;)r.subTo(m,r)}t!=null&&(r.drShiftTo(u,t),s!=o&&w.ZERO.subTo(t,t)),r.t=u,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&w.ZERO.subTo(r,r)}}}function Bh(e){var t=H();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(w.ZERO)>0&&e.subTo(t,t),t}function Vt(e){this.m=e}function Ah(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function Ch(e){return e}function Th(e){e.divRemTo(this.m,null,e)}function Ih(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function _h(e,t){e.squareTo(t),this.reduce(t)}Vt.prototype.convert=Ah;Vt.prototype.revert=Ch;Vt.prototype.reduce=Th;Vt.prototype.mulTo=Ih;Vt.prototype.sqrTo=_h;function Rh(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function zt(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Dh(e){var t=H();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(w.ZERO)>0&&this.m.subTo(t,t),t}function kh(e){var t=H();return e.copyTo(t),this.reduce(t),t}function Nh(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Ph(e,t){e.squareTo(t),this.reduce(t)}function Lh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}zt.prototype.convert=Dh;zt.prototype.revert=kh;zt.prototype.reduce=Nh;zt.prototype.mulTo=Lh;zt.prototype.sqrTo=Ph;function Kh(){return(this.t>0?this.data[0]&1:this.s)==0}function Uh(e,t){if(e>4294967295||e<1)return w.ONE;var r=H(),n=H(),i=t.convert(this),a=In(e)-1;for(i.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,i,r);else{var s=r;r=n,n=s}return t.revert(r)}function qh(e,t){var r;return e<256||t.isEven()?r=new Vt(t):r=new zt(t),this.exp(e,r)}w.prototype.copyTo=oh;w.prototype.fromInt=uh;w.prototype.fromString=fh;w.prototype.clamp=ch;w.prototype.dlShiftTo=gh;w.prototype.drShiftTo=xh;w.prototype.lShiftTo=vh;w.prototype.rShiftTo=mh;w.prototype.subTo=bh;w.prototype.multiplyTo=wh;w.prototype.squareTo=Sh;w.prototype.divRemTo=Eh;w.prototype.invDigit=Rh;w.prototype.isEven=Kh;w.prototype.exp=Uh;w.prototype.toString=hh;w.prototype.negate=lh;w.prototype.abs=ph;w.prototype.compareTo=dh;w.prototype.bitLength=yh;w.prototype.mod=Bh;w.prototype.modPowInt=qh;w.ZERO=Ct(0);w.ONE=Ct(1);function Oh(){var e=H();return this.copyTo(e),e}function Fh(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Mh(){return this.t==0?this.s:this.data[0]<<24>>24}function Vh(){return this.t==0?this.s:this.data[0]<<16>>16}function zh(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Hh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Gh(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=Ct(r),i=H(),a=H(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(e)+s}function Wh(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,a=0,s=0,o=0;o<e.length;++o){var f=to(e,o);if(f<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=t*s+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(s,0)),i&&w.ZERO.subTo(this,this)}function jh(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(w.ONE.shiftLeft(e-1),Mi,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(w.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Yh(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function $h(e){return this.compareTo(e)==0}function Zh(e){return this.compareTo(e)<0?this:e}function Qh(e){return this.compareTo(e)>0?this:e}function Xh(e,t,r){var n,i,a=Math.min(e.t,this.t);for(n=0;n<a;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=a;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Jh(e,t){return e&t}function el(e){var t=H();return this.bitwiseTo(e,Jh,t),t}function Mi(e,t){return e|t}function tl(e){var t=H();return this.bitwiseTo(e,Mi,t),t}function ro(e,t){return e^t}function rl(e){var t=H();return this.bitwiseTo(e,ro,t),t}function no(e,t){return e&~t}function nl(e){var t=H();return this.bitwiseTo(e,no,t),t}function il(){for(var e=H(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function al(e){var t=H();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function sl(e){var t=H();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ol(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function ul(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+ol(this.data[e]);return this.s<0?this.t*this.DB:-1}function fl(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function cl(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=fl(this.data[r]^t);return e}function hl(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function ll(e,t){var r=w.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function pl(e){return this.changeBit(e,Mi)}function dl(e){return this.changeBit(e,no)}function yl(e){return this.changeBit(e,ro)}function gl(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function xl(e){var t=H();return this.addTo(e,t),t}function vl(e){var t=H();return this.subTo(e,t),t}function ml(e){var t=H();return this.multiplyTo(e,t),t}function bl(e){var t=H();return this.divRemTo(e,t,null),t}function wl(e){var t=H();return this.divRemTo(e,null,t),t}function Sl(e){var t=H(),r=H();return this.divRemTo(e,t,r),new Array(t,r)}function El(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Bl(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Ir(){}function io(e){return e}function Al(e,t,r){e.multiplyTo(t,r)}function Cl(e,t){e.squareTo(t)}Ir.prototype.convert=io;Ir.prototype.revert=io;Ir.prototype.mulTo=Al;Ir.prototype.sqrTo=Cl;function Tl(e){return this.exp(e,new Ir)}function Il(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function _l(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function or(e){this.r2=H(),this.q3=H(),w.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Rl(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=H();return e.copyTo(t),this.reduce(t),t}function Dl(e){return e}function kl(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Nl(e,t){e.squareTo(t),this.reduce(t)}function Pl(e,t,r){e.multiplyTo(t,r),this.reduce(r)}or.prototype.convert=Rl;or.prototype.revert=Dl;or.prototype.reduce=kl;or.prototype.mulTo=Pl;or.prototype.sqrTo=Nl;function Ll(e,t){var r=e.bitLength(),n,i=Ct(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Vt(t):t.isEven()?a=new or(t):a=new zt(t);var s=new Array,o=3,f=n-1,u=(1<<n)-1;if(s[1]=a.convert(this),n>1){var c=H();for(a.sqrTo(s[1],c);o<=u;)s[o]=H(),a.mulTo(c,s[o-2],s[o]),o+=2}var h=e.t-1,l,y=!0,p=H(),g;for(r=In(e.data[h])-1;h>=0;){for(r>=f?l=e.data[h]>>r-f&u:(l=(e.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=e.data[h-1]>>this.DB+r-f)),o=n;(l&1)==0;)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),y)s[l].copyTo(i),y=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&(e.data[h]&1<<r)==0;)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function Kl(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;for(i<a&&(a=i),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Ul(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function ql(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return w.ZERO;for(var r=e.clone(),n=this.clone(),i=Ct(1),a=Ct(0),s=Ct(0),o=Ct(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),t?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),t&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var We=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ol=(1<<26)/We[We.length-1];function Fl(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=We[We.length-1]){for(t=0;t<We.length;++t)if(r.data[0]==We[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<We.length;){for(var n=We[t],i=t+1;i<We.length&&n<Ol;)n*=We[i++];for(n=r.modInt(n);t<i;)if(n%We[t++]==0)return!1}return r.millerRabin(e)}function Ml(e){var t=this.subtract(w.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=Vl(),a,s=0;s<e;++s){do a=new w(this.bitLength(),i);while(a.compareTo(w.ONE)<=0||a.compareTo(t)>=0);var o=a.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(t)!=0){for(var f=1;f++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function Vl(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=zh;w.prototype.toRadix=Gh;w.prototype.fromRadix=Wh;w.prototype.fromNumber=jh;w.prototype.bitwiseTo=Xh;w.prototype.changeBit=ll;w.prototype.addTo=gl;w.prototype.dMultiply=El;w.prototype.dAddOffset=Bl;w.prototype.multiplyLowerTo=Il;w.prototype.multiplyUpperTo=_l;w.prototype.modInt=Ul;w.prototype.millerRabin=Ml;w.prototype.clone=Oh;w.prototype.intValue=Fh;w.prototype.byteValue=Mh;w.prototype.shortValue=Vh;w.prototype.signum=Hh;w.prototype.toByteArray=Yh;w.prototype.equals=$h;w.prototype.min=Zh;w.prototype.max=Qh;w.prototype.and=el;w.prototype.or=tl;w.prototype.xor=rl;w.prototype.andNot=nl;w.prototype.not=il;w.prototype.shiftLeft=al;w.prototype.shiftRight=sl;w.prototype.getLowestSetBit=ul;w.prototype.bitCount=cl;w.prototype.testBit=hl;w.prototype.setBit=pl;w.prototype.clearBit=dl;w.prototype.flipBit=yl;w.prototype.add=xl;w.prototype.subtract=vl;w.prototype.multiply=ml;w.prototype.divide=bl;w.prototype.remainder=wl;w.prototype.divideAndRemainder=Sl;w.prototype.modPow=Ll;w.prototype.modInverse=ql;w.prototype.pow=Tl;w.prototype.gcd=Kl;w.prototype.isProbablePrime=Fl});var co=C((R1,fo)=>{var et=Z();Mt();ue();var so=fo.exports=et.sha1=et.sha1||{};et.md.sha1=et.md.algorithms.sha1=so;so.create=function(){oo||zl();var e=null,t=et.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return t=et.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=et.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),uo(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=et.util.createBuffer();i.putBytes(t.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Vi.substr(0,n.blockLength-s));for(var o,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)o=n.fullMessageLength[c+1]*8,f=o/4294967296>>>0,u+=f,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};uo(h,r,i);var l=et.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Vi=null,oo=!1;function zl(){Vi=String.fromCharCode(128),Vi+=et.util.fillString(String.fromCharCode(0),64),oo=!0}function uo(e,t,r){for(var n,i,a,s,o,f,u,c,h=r.length();h>=64;){for(i=e.h0,a=e.h1,s=e.h2,o=e.h3,f=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,u=o^a&(s^o),n=(i<<5|i>>>27)+u+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<20;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,u=o^a&(s^o),n=(i<<5|i>>>27)+u+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<32;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,u=a^s^o,n=(i<<5|i>>>27)+u+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<40;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=a^s^o,n=(i<<5|i>>>27)+u+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<60;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=a&s|o&(a^s),n=(i<<5|i>>>27)+u+f+2400959708+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<80;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=a^s^o,n=(i<<5|i>>>27)+u+f+3395469782+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+f|0,h-=64}}});var po=C((D1,lo)=>{var tt=Z();ue();Tr();co();var ho=lo.exports=tt.pkcs1=tt.pkcs1||{};ho.encode_rsa_oaep=function(e,t,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=tt.md.sha1.create(),s||(s=a);var o=Math.ceil(e.n.bitLength()/8),f=o-2*a.digestLength-2;if(t.length>f){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=t.length,u.maxLength=f,u}n||(n=""),a.update(n,"raw");for(var c=a.digest(),h="",l=f-t.length,y=0;y<l;y++)h+="\0";var p=c.getBytes()+h+""+t;if(!i)i=tt.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=a.digestLength,u}var g=Rn(i,o-a.digestLength-1,s),v=tt.util.xorBytes(p,g,p.length),m=Rn(v,a.digestLength,s),E=tt.util.xorBytes(i,m,i.length);return"\0"+E+v};ho.decode_rsa_oaep=function(e,t,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=t.length,v.expectedLength=s,v}if(i===void 0?i=tt.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=t.charAt(0),u=t.substring(1,i.digestLength+1),c=t.substring(1+i.digestLength),h=Rn(c,i.digestLength,a),l=tt.util.xorBytes(u,h,u.length),y=Rn(l,s-i.digestLength-1,a),p=tt.util.xorBytes(c,y,c.length),g=p.substring(0,i.digestLength),v=f!=="\0",m=0;m<i.digestLength;++m)v|=o.charAt(m)!==g.charAt(m);for(var E=1,A=i.digestLength,P=i.digestLength;P<p.length;P++){var _=p.charCodeAt(P),R=_&1^1,O=E?65534:0;v|=_&O,E=E&R,A+=E}if(v||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function Rn(e,t,r){r||(r=tt.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(e+s),n+=r.digest().getBytes()}return n.substring(0,t)}});var yo=C((k1,zi)=>{var Tt=Z();ue();_n();Tr();(function(){if(Tt.prime){zi.exports=Tt.prime;return}var e=zi.exports=Tt.prime=Tt.prime||{},t=Tt.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,y){typeof l=="function"&&(y=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Tt.random,v={nextBytes:function(m){for(var E=g.getBytesSync(m.length),A=0;A<m.length;++A)m[A]=E.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,v,p.options,y);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,y,p){return"workers"in y?f(h,l,y,p):s(h,l,y,p)}function s(h,l,y,p){var g=u(h,l),v=0,m=c(g.bitLength());"millerRabinTests"in y&&(m=y.millerRabinTests);var E=10;"maxBlockTime"in y&&(E=y.maxBlockTime),o(g,h,l,v,m,E,p)}function o(h,l,y,p,g,v,m){var E=+new Date;do{if(h.bitLength()>l&&(h=u(l,y)),h.isProbablePrime(g))return m(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-E<v);Tt.util.setImmediate(function(){o(h,l,y,p,g,v,m)})}function f(h,l,y,p){if(typeof Worker=="undefined")return s(h,l,y,p);var g=u(h,l),v=y.workers,m=y.workLoad||100,E=m*30/8,A=y.workerScript||"forge/prime.worker.js";if(v===-1)return Tt.util.estimateCores(function(_,R){_&&(R=2),v=R-1,P()});P();function P(){v=Math.max(1,v);for(var _=[],R=0;R<v;++R)_[R]=new Worker(A);for(var O=v,R=0;R<v;++R)_[R].addEventListener("message",ve);var W=!1;function ve(Ve){if(!W){--O;var De=Ve.data;if(De.found){for(var Se=0;Se<_.length;++Se)_[Se].terminate();return W=!0,p(null,new t(De.prime,16))}g.bitLength()>h&&(g=u(h,l));var Zt=g.toString(16);Ve.target.postMessage({hex:Zt,workLoad:m}),g.dAddOffset(E,0)}}}}function u(h,l){var y=new t(h,l),p=h-1;return y.testBit(p)||y.bitwiseTo(t.ONE.shiftLeft(p),i,y),y.dAddOffset(31-y.mod(n).byteValue(),0),y}function c(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var kn=C((N1,So)=>{var L=Z();Cr();_n();bn();po();yo();Tr();ue();typeof F=="undefined"&&(F=L.jsbn.BigInteger);var F,Hi=L.util.isNodejs?ar():null,x=L.asn1,qe=L.util;L.pki=L.pki||{};So.exports=L.pki.rsa=L.rsa=L.rsa||{};var K=L.pki,Hl=[6,4,2,4,2,4,6,2],Gl={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Wl={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},jl={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Yl=L.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},$l=function(e){var t;if(e.algorithm in K.oids)t=K.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=x.oidToDer(t).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},go=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(F.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(F.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new F(L.util.bytesToHex(L.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(F.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(a)<0;)i=i.add(t.p);var s=i.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return s=s.multiply(n.modInverse(t.n)).mod(t.n),s};K.rsa.encrypt=function(e,t,r){var n=r,i,a=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=xo(e,t,r)):(i=L.util.createBuffer(),i.putBytes(e));for(var s=new F(i.toHex(),16),o=go(s,t,n),f=o.toString(16),u=L.util.createBuffer(),c=a-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(L.util.hexToBytes(f)),u.getBytes()};K.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=i,a}var s=new F(L.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=go(s,t,r),f=o.toString(16),u=L.util.createBuffer(),c=i-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(L.util.hexToBytes(f)),n!==!1?Dn(u.getBytes(),t,r):u.getBytes()};K.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||L.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),u=0;u<o.length;++u)o[u]=f.charCodeAt(u)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:e,rng:i,eInt:t||65537,e:new F(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};K.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new F(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,u=f-1;e.pqState===0?(e.num=new F(f,e.rng),e.num.testBit(u)||e.num.bitwiseTo(F.ONE.shiftLeft(u),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(Ql(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Hl[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(F.ONE).gcd(e.e).compareTo(F.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(F.ONE),e.q1=e.q.subtract(F.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(F.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var c=e.e.modInverse(e.phi);e.keys={privateKey:K.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:K.rsa.setPublicKey(e.n,e.e)}}s=+new Date,o+=s-a,a=s}return e.keys!==null};K.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!L.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(vo("generateKeyPair"))return Hi.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,u){if(o)return n(o);n(null,{privateKey:K.privateKeyFromPem(u),publicKey:K.publicKeyFromPem(f)})});if(mo("generateKey")&&mo("exportKey"))return qe.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:wo(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return qe.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=K.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(o)));n(null,{privateKey:f,publicKey:K.setRsaPublicKey(f.n,f.e)})}});if(bo("generateKey")&&bo("exportKey")){var i=qe.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:wo(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,u=qe.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);u.oncomplete=function(c){var h=c.target.result,l=K.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(h)));n(null,{privateKey:l,publicKey:K.setRsaPublicKey(l.n,l.e)})},u.onerror=function(c){n(c)}},i.onerror=function(o){n(o)};return}}else if(vo("generateKeyPairSync")){var a=Hi.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:K.privateKeyFromPem(a.privateKey),publicKey:K.publicKeyFromPem(a.publicKey)}}}var s=K.rsa.createKeyPairGenerationState(e,t,r);if(!n)return K.rsa.stepKeyPairGenerationState(s,0),s.keys;Zl(s,r,n)};K.setRsaPublicKey=K.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,u){return xo(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return L.pkcs1.encode_rsa_oaep(f,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return K.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),a==="RSASSA-PKCS1-V1_5"?a={verify:function(o,f){f=Dn(f,r,!0);var u=x.fromDer(f);return o===u.value[1].value}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(o,f){return f=Dn(f,r,!0),o===f}});var s=K.rsa.decrypt(i,r,!0,!1);return a.verify(n,s,r.n.bitLength())},r};K.setRsaPrivateKey=K.rsa.setPrivateKey=function(e,t,r,n,i,a,s,o){var f={n:e,e:t,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return f.decrypt=function(u,c,h){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var l=K.rsa.decrypt(u,f,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:Dn};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(y,p){return L.pkcs1.decode_rsa_oaep(p,y,h)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(l,f,!1)},f.sign=function(u,c){var h=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:$l},h=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return u}},h=1);var l=c.encode(u,f.n.bitLength());return K.rsa.encrypt(l,f,h)},f};K.wrapRsaPrivateKey=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(K.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(e).getBytes())])};K.privateKeyFromAsn1=function(e){var t={},r=[];if(x.validate(e,Gl,t,r)&&(e=x.fromDer(L.util.createBuffer(t.privateKey))),t={},r=[],!x.validate(e,Wl,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,f,u,c,h;return i=L.util.createBuffer(t.privateKeyModulus).toHex(),a=L.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=L.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=L.util.createBuffer(t.privateKeyPrime1).toHex(),f=L.util.createBuffer(t.privateKeyPrime2).toHex(),u=L.util.createBuffer(t.privateKeyExponent1).toHex(),c=L.util.createBuffer(t.privateKeyExponent2).toHex(),h=L.util.createBuffer(t.privateKeyCoefficient).toHex(),K.setRsaPrivateKey(new F(i,16),new F(a,16),new F(s,16),new F(o,16),new F(f,16),new F(u,16),new F(c,16),new F(h,16))};K.privateKeyToAsn1=K.privateKeyToRSAPrivateKey=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.qInv))])};K.publicKeyFromAsn1=function(e){var t={},r=[];if(x.validate(e,Yl,t,r)){var n=x.derToOid(t.publicKeyOid);if(n!==K.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!x.validate(e,jl,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=L.util.createBuffer(t.publicKeyModulus).toHex(),s=L.util.createBuffer(t.publicKeyExponent).toHex();return K.setRsaPublicKey(new F(a,16),new F(s,16))};K.publicKeyToAsn1=K.publicKeyToSubjectPublicKeyInfo=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(K.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[K.publicKeyToRSAPublicKey(e)])])};K.publicKeyToRSAPublicKey=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,rt(e.e))])};function xo(e,t,r){var n=L.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=e.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<s;++f)n.putByte(o)}else for(;s>0;){for(var u=0,c=L.random.getBytes(s),f=0;f<s;++f)o=c.charCodeAt(f),o===0?++u:n.putByte(o);s=u}return n.putByte(0),n.putBytes(e),n}function Dn(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),a=L.util.createBuffer(e),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var u=0;u<f;++u)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(o===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var c=a.getByte();if(c!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Zl(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){a(e.pBits,function(o,f){if(o)return r(o);if(e.p=f,e.q!==null)return s(o,e.q);a(e.qBits,s)})}function a(o,f){L.prime.generateProbablePrime(o,n,f)}function s(o,f){if(o)return r(o);if(e.q=f,e.p.compareTo(e.q)<0){var u=e.p;e.p=e.q,e.q=u}if(e.p.subtract(F.ONE).gcd(e.e).compareTo(F.ONE)!==0){e.p=null,i();return}if(e.q.subtract(F.ONE).gcd(e.e).compareTo(F.ONE)!==0){e.q=null,a(e.qBits,s);return}if(e.p1=e.p.subtract(F.ONE),e.q1=e.q.subtract(F.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(F.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,a(e.qBits,s);return}var c=e.e.modInverse(e.phi);e.keys={privateKey:K.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:K.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function rt(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=L.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function Ql(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function vo(e){return L.util.isNodejs&&typeof Hi[e]=="function"}function mo(e){return typeof qe.globalScope!="undefined"&&typeof qe.globalScope.crypto=="object"&&typeof qe.globalScope.crypto.subtle=="object"&&typeof qe.globalScope.crypto.subtle[e]=="function"}function bo(e){return typeof qe.globalScope!="undefined"&&typeof qe.globalScope.msCrypto=="object"&&typeof qe.globalScope.msCrypto.subtle=="object"&&typeof qe.globalScope.msCrypto.subtle[e]=="function"}function wo(e){for(var t=L.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Io=C((P1,To)=>{var I=Z();Jr();Cr();k0();Mt();bn();Li();O0();Tr();Q0();kn();ue();typeof Eo=="undefined"&&(Eo=I.jsbn.BigInteger);var Eo,b=I.asn1,U=I.pki=I.pki||{};To.exports=U.pbe=I.pbe=I.pbe||{};var Ht=U.oids,Xl={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Jl={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},ep={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};U.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,a=b.integerToDer(i),s,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,c,h;switch(r.algorithm){case"aes128":s=16,u=16,c=Ht["aes128-CBC"],h=I.aes.createEncryptionCipher;break;case"aes192":s=24,u=16,c=Ht["aes192-CBC"],h=I.aes.createEncryptionCipher;break;case"aes256":s=32,u=16,c=Ht["aes256-CBC"],h=I.aes.createEncryptionCipher;break;case"des":s=8,u=8,c=Ht.desCBC,h=I.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Co(y),g=I.pkcs5.pbkdf2(t,n,i,s,p),v=I.random.getBytesSync(u),m=h(g);m.start(v),m.update(b.toDer(e)),m.finish(),f=m.output.getBytes();var E=tp(n,a,s,y);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ht.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ht.pkcs5PBKDF2).getBytes()),E]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){s=24;var A=new I.util.ByteBuffer(n),g=U.pbe.generatePkcs12Key(t,A,1,i,s),v=U.pbe.generatePkcs12Key(t,A,2,i,s),m=I.des.createEncryptionCipher(g);m.start(v),m.update(b.toDer(e)),m.finish(),f=m.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ht["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var P=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return P};U.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!b.validate(e,Xl,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=b.derToOid(n.encryptionOid),o=U.pbe.getCipher(s,n.encryptionParams,t),f=I.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=b.fromDer(o.output)),r};U.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(e).getBytes()};return I.pem.encode(r,{maxline:t})};U.encryptedPrivateKeyFromPem=function(e){var t=I.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(t.body)};U.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=U.wrapRsaPrivateKey(U.privateKeyToAsn1(e));return n=U.encryptPrivateKeyInfo(n,t,r),U.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var u=I.pbe.opensslDeriveBytes(t,a.substr(0,8),s),c=o(u);c.start(a),c.update(b.toDer(U.privateKeyToAsn1(e))),c.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(a).toUpperCase()},body:c.output.getBytes()};return I.pem.encode(h)};U.decryptRsaPrivateKey=function(e,t){var r=null,n=I.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=I.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=I.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=I.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return I.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return I.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return I.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),f=I.pbe.opensslDeriveBytes(t,o.substr(0,8),a),u=s(f);if(u.start(o),u.update(I.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=U.decryptPrivateKeyInfo(b.fromDer(r),t):r=b.fromDer(r),r!==null&&(r=U.privateKeyFromAsn1(r)),r};U.pbe.generatePkcs12Key=function(e,t,r,n,i,a){var s,o;if(typeof a=="undefined"||a===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');a=I.md.sha1.create()}var f=a.digestLength,u=a.blockLength,c=new I.util.ByteBuffer,h=new I.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)h.putInt16(e.charCodeAt(o));h.putInt16(0)}var l=h.length(),y=t.length(),p=new I.util.ByteBuffer;p.fillWithByte(r,u);var g=u*Math.ceil(y/u),v=new I.util.ByteBuffer;for(o=0;o<g;o++)v.putByte(t.at(o%y));var m=u*Math.ceil(l/u),E=new I.util.ByteBuffer;for(o=0;o<m;o++)E.putByte(h.at(o%l));var A=v;A.putBuffer(E);for(var P=Math.ceil(i/f),_=1;_<=P;_++){var R=new I.util.ByteBuffer;R.putBytes(p.bytes()),R.putBytes(A.bytes());for(var O=0;O<n;O++)a.start(),a.update(R.getBytes()),R=a.digest();var W=new I.util.ByteBuffer;for(o=0;o<u;o++)W.putByte(R.at(o%f));var ve=Math.ceil(y/u)+Math.ceil(l/u),Ve=new I.util.ByteBuffer;for(s=0;s<ve;s++){var De=new I.util.ByteBuffer(A.getBytes(u)),Se=511;for(o=W.length()-1;o>=0;o--)Se=Se>>8,Se+=W.at(o)+De.at(o),De.setAt(o,Se&255);Ve.putBuffer(De)}A=Ve,c.putBuffer(R)}return c.truncate(c.length()-i),c};U.pbe.getCipher=function(e,t,r){switch(e){case U.oids.pkcs5PBES2:return U.pbe.getCipherForPBES2(e,t,r);case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case U.oids["pbewithSHAAnd40BitRC2-CBC"]:return U.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};U.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!b.validate(t,Jl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(e=b.derToOid(n.kdfOid),e!==U.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=e,a.supportedOids=["pkcs5PBKDF2"],a}if(e=b.derToOid(n.encOid),e!==U.oids["aes128-CBC"]&&e!==U.oids["aes192-CBC"]&&e!==U.oids["aes256-CBC"]&&e!==U.oids["des-EDE3-CBC"]&&e!==U.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=e,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,u;switch(U.oids[e]){case"aes128-CBC":f=16,u=I.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,u=I.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,u=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,u=I.des.createDecryptionCipher;break;case"desCBC":f=8,u=I.des.createDecryptionCipher;break}var c=Ao(n.prfOid),h=I.pkcs5.pbkdf2(r,s,o,f,c),l=n.encIv,y=u(h);return y.start(l),y};U.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!b.validate(t,ep,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,u,c;switch(e){case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,u=8,c=I.des.startDecrypting;break;case U.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,u=8,c=function(g,v){var m=I.rc2.createDecryptionCipher(g,40);return m.start(v,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=e,a}var h=Ao(n.prfOid),l=U.pbe.generatePkcs12Key(r,s,1,o,f,h);h.start();var y=U.pbe.generatePkcs12Key(r,s,2,o,u,h);return c(l,y)};U.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}t===null&&(t="");for(var i=[Bo(n,e+t)],a=16,s=1;a<r;++s,a+=16)i.push(Bo(n,i[s-1]+e+t));return i.join("").substr(0,r)};function Bo(e,t){return e.start().update(t).digest().getBytes()}function Ao(e){var t;if(!e)t="hmacWithSHA1";else if(t=U.oids[b.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Co(t)}function Co(e){var t=I.md;switch(e){case"hmacWithSHA224":t=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function tp(e,t,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,e),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(U.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var _r={};Ee(_r,{concat:()=>rp});function rp(e,t){t||(t=e.reduce((i,a)=>i+a.length,0));let r=new Uint8Array(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return r}var Rr=Q(()=>{});var Gi=C((L1,Ro)=>{"use strict";var{concat:np}=(Rr(),_r),{fromString:_o}=(St(),wt),ip=pr();function ap({algorithm:e="AES-GCM",nonceLength:t=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:a=32767}={}){let s=ip.get();r*=8;async function o(u,c){let h=s.getRandomValues(new Uint8Array(i)),l=s.getRandomValues(new Uint8Array(t)),y={name:e,iv:l},p={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},g=await s.subtle.importKey("raw",_o(c),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await s.subtle.deriveKey(p,g,{name:e,length:r},!0,["encrypt"]),m=await s.subtle.encrypt(y,v,u);return np([h,y.iv,new Uint8Array(m)])}async function f(u,c){let h=u.slice(0,i),l=u.slice(i,i+t),y=u.slice(i+t),p={name:e,iv:l},g={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},v=await s.subtle.importKey("raw",_o(c),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),m=await s.subtle.deriveKey(g,v,{name:e,length:r},!0,["decrypt"]),E=await s.subtle.decrypt(p,m,y);return new Uint8Array(E)}return{encrypt:o,decrypt:f}}Ro.exports={create:ap}});var ko=C((K1,Do)=>{"use strict";var{base64:sp}=(nn(),yr),op=Gi();Do.exports={import:async function(e,t){let r=sp.decode(e);return await op.create().decrypt(r,t)}}});var Dr={};Ee(Dr,{equals:()=>up});function up(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var kr=Q(()=>{});var Uo=C((U1,Ko)=>{var te=Z();Mt();ue();var Nr=Ko.exports=te.sha512=te.sha512||{};te.md.sha512=te.md.algorithms.sha512=Nr;var No=te.sha384=te.sha512.sha384=te.sha512.sha384||{};No.create=function(){return Nr.create("SHA-384")};te.md.sha384=te.md.algorithms.sha384=No;te.sha512.sha256=te.sha512.sha256||{create:function(){return Nr.create("SHA-512/256")}};te.md["sha512/256"]=te.md.algorithms["sha512/256"]=te.sha512.sha256;te.sha512.sha224=te.sha512.sha224||{create:function(){return Nr.create("SHA-512/224")}};te.md["sha512/224"]=te.md.algorithms["sha512/224"]=te.sha512.sha224;Nr.create=function(e){if(Po||fp(),typeof e=="undefined"&&(e="SHA-512"),!(e in Gt))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Gt[e],r=null,n=te.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,u=0;u<f;++u)o.fullMessageLength.push(0);n=te.util.createBuffer(),r=new Array(t.length);for(var u=0;u<t.length;++u)r[u]=t[u].slice(0);return o},o.start(),o.update=function(f,u){u==="utf8"&&(f=te.util.encodeUtf8(f));var c=f.length;o.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=c[1],c[1]=c[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(f),Lo(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=te.util.createBuffer();f.putBytes(n.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,c=u&o.blockLength-1;f.putBytes(Wi.substr(0,o.blockLength-c));for(var h,l,y=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,y+=l,f.putInt32(y>>>0),y=h>>>0;f.putInt32(y);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);Lo(g,i,f);var v=te.util.createBuffer(),m;e==="SHA-512"?m=g.length:e==="SHA-384"?m=g.length-2:m=g.length-4;for(var p=0;p<m;++p)v.putInt32(g[p][0]),(p!==m-1||e!=="SHA-512/224")&&v.putInt32(g[p][1]);return v},o};var Wi=null,Po=!1,ji=null,Gt=null;function fp(){Wi=String.fromCharCode(128),Wi+=te.util.fillString(String.fromCharCode(0),128),ji=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Gt={},Gt["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Gt["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Gt["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Gt["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Po=!0}function Lo(e,t,r){for(var n,i,a,s,o,f,u,c,h,l,y,p,g,v,m,E,A,P,_,R,O,W,ve,Ve,De,Se,Zt,jr,le,Te,N,Wn,jn,Yn,$n,pa=r.length();pa>=128;){for(le=0;le<16;++le)t[le][0]=r.getInt32()>>>0,t[le][1]=r.getInt32()>>>0;for(;le<80;++le)Wn=t[le-2],Te=Wn[0],N=Wn[1],n=((Te>>>19|N<<13)^(N>>>29|Te<<3)^Te>>>6)>>>0,i=((Te<<13|N>>>19)^(N<<3|Te>>>29)^(Te<<26|N>>>6))>>>0,Yn=t[le-15],Te=Yn[0],N=Yn[1],a=((Te>>>1|N<<31)^(Te>>>8|N<<24)^Te>>>7)>>>0,s=((Te<<31|N>>>1)^(Te<<24|N>>>8)^(Te<<25|N>>>7))>>>0,jn=t[le-7],$n=t[le-16],N=i+jn[1]+s+$n[1],t[le][0]=n+jn[0]+a+$n[0]+(N/4294967296>>>0)>>>0,t[le][1]=N>>>0;for(g=e[0][0],v=e[0][1],m=e[1][0],E=e[1][1],A=e[2][0],P=e[2][1],_=e[3][0],R=e[3][1],O=e[4][0],W=e[4][1],ve=e[5][0],Ve=e[5][1],De=e[6][0],Se=e[6][1],Zt=e[7][0],jr=e[7][1],le=0;le<80;++le)u=((O>>>14|W<<18)^(O>>>18|W<<14)^(W>>>9|O<<23))>>>0,c=((O<<18|W>>>14)^(O<<14|W>>>18)^(W<<23|O>>>9))>>>0,h=(De^O&(ve^De))>>>0,l=(Se^W&(Ve^Se))>>>0,o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,f=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,y=(g&m|A&(g^m))>>>0,p=(v&E|P&(v^E))>>>0,N=jr+c+l+ji[le][1]+t[le][1],n=Zt+u+h+ji[le][0]+t[le][0]+(N/4294967296>>>0)>>>0,i=N>>>0,N=f+p,a=o+y+(N/4294967296>>>0)>>>0,s=N>>>0,Zt=De,jr=Se,De=ve,Se=Ve,ve=O,Ve=W,N=R+i,O=_+n+(N/4294967296>>>0)>>>0,W=N>>>0,_=A,R=P,A=m,P=E,m=g,E=v,N=i+s,g=n+a+(N/4294967296>>>0)>>>0,v=N>>>0;N=e[0][1]+v,e[0][0]=e[0][0]+g+(N/4294967296>>>0)>>>0,e[0][1]=N>>>0,N=e[1][1]+E,e[1][0]=e[1][0]+m+(N/4294967296>>>0)>>>0,e[1][1]=N>>>0,N=e[2][1]+P,e[2][0]=e[2][0]+A+(N/4294967296>>>0)>>>0,e[2][1]=N>>>0,N=e[3][1]+R,e[3][0]=e[3][0]+_+(N/4294967296>>>0)>>>0,e[3][1]=N>>>0,N=e[4][1]+W,e[4][0]=e[4][0]+O+(N/4294967296>>>0)>>>0,e[4][1]=N>>>0,N=e[5][1]+Ve,e[5][0]=e[5][0]+ve+(N/4294967296>>>0)>>>0,e[5][1]=N>>>0,N=e[6][1]+Se,e[6][0]=e[6][0]+De+(N/4294967296>>>0)>>>0,e[6][1]=N>>>0,N=e[7][1]+jr,e[7][0]=e[7][0]+Zt+(N/4294967296>>>0)>>>0,e[7][1]=N>>>0,pa-=128}}});var Oo=C((q1,qo)=>{"use strict";var Nn=65536;function cp(e){let t=new Uint8Array(e),r=0;if(e>0)if(e>Nn)for(;r<e;)r+Nn>e?(crypto.getRandomValues(t.subarray(r,r+(e-r))),r+=e-r):(crypto.getRandomValues(t.subarray(r,r+Nn)),r+=Nn);else crypto.getRandomValues(t);return t}qo.exports=cp});var Pn=C((O1,Fo)=>{"use strict";var hp=Oo(),lp=Pe();Fo.exports=function(e){if(isNaN(e)||e<=0)throw lp(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return hp(e)}});var Ln=C(Pr=>{"use strict";ue();_n();var pp=Z(),{fromString:dp}=(St(),wt),{toString:Mo}=(bt(),mt),{concat:Vo}=(Rr(),_r);Pr.bigIntegerToUintBase64url=(e,t)=>{let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Vo([new Uint8Array(t-r.length),r])}return Mo(r,"base64url")};Pr.base64urlToBigInteger=e=>{let t=Pr.base64urlToBuffer(e);return new pp.jsbn.BigInteger(Mo(t,"base16"),16)};Pr.base64urlToBuffer=(e,t)=>{let r=dp(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Vo([new Uint8Array(t-r.length),r])}return r}});var Go=C(Lr=>{"use strict";Cr();kn();var It=Z(),{bigIntegerToUintBase64url:nt,base64urlToBigInteger:it}=Ln(),{fromString:zo}=(St(),wt),{toString:Ho}=(bt(),mt);Lr.pkcs1ToJwk=function(e){let t=It.asn1.fromDer(Ho(e,"ascii")),r=It.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:nt(r.n),e:nt(r.e),d:nt(r.d),p:nt(r.p),q:nt(r.q),dp:nt(r.dP),dq:nt(r.dQ),qi:nt(r.qInv),alg:"RS256",kid:"2011-04-29"}};Lr.jwkToPkcs1=function(e){let t=It.pki.privateKeyToAsn1({n:it(e.n),e:it(e.e),d:it(e.d),p:it(e.p),q:it(e.q),dP:it(e.dp),dQ:it(e.dq),qInv:it(e.qi)});return zo(It.asn1.toDer(t).getBytes(),"ascii")};Lr.pkixToJwk=function(e){let t=It.asn1.fromDer(Ho(e,"ascii")),r=It.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:nt(r.n),e:nt(r.e),alg:"RS256",kid:"2011-04-29"}};Lr.jwkToPkix=function(e){let t=It.pki.publicKeyToAsn1({n:it(e.n),e:it(e.e)});return zo(It.asn1.toDer(t).getBytes(),"ascii")}});var $o=C((V1,Yo)=>{"use strict";kn();var Wo=Z(),{base64urlToBigInteger:yp}=Ln();function jo(e,t){return t.map(r=>yp(e[r]))}function gp(e){return Wo.pki.setRsaPrivateKey(...jo(e,["n","e","d","p","q","dp","dq","qi"]))}function xp(e){return Wo.pki.setRsaPublicKey(...jo(e,["n","e"]))}Yo.exports={jwk2pub:xp,jwk2priv:gp}});var Xo=C(pt=>{"use strict";var lt=pr(),vp=Pn(),{toString:mp}=(bt(),mt),{fromString:bp}=(St(),wt);pt.utils=Go();pt.generateKey=async function(e){let t=await lt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Zo(t);return{privateKey:r[0],publicKey:r[1]}};pt.unmarshalPrivateKey=async function(e){let r=[await lt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await wp(e)],n=await Zo({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};pt.getRandomValues=vp;pt.hashAndSign=async function(e,t){let r=await lt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await lt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,n.byteOffset,n.byteLength)};pt.hashAndVerify=async function(e,t,r){let n=await lt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return lt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)};function Zo(e){return Promise.all([lt.get().subtle.exportKey("jwk",e.privateKey),lt.get().subtle.exportKey("jwk",e.publicKey)])}function wp(e){return lt.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:Sp,jwk2priv:Ep}=$o();function Qo(e,t,r,n){let i=t?Sp(e):Ep(e),a=mp(Uint8Array.from(r),"ascii"),s=n(a,i);return bp(s,"ascii")}pt.encrypt=function(e,t){return Qo(e,!0,t,(r,n)=>n.encrypt(r))};pt.decrypt=function(e,t){return Qo(e,!1,t,(r,n)=>n.decrypt(r))}});var Kn=C((H1,Jo)=>{"use strict";var{base64:Bp}=(nn(),yr),Ap=Gi();Jo.exports={export:async function(e,t){let n=await Ap.create().encrypt(e,t);return Bp.encode(n)}}});var iu=C((G1,nu)=>{"use strict";var{sha256:eu}=(rr(),Ut),tu=Pe(),{equals:ru}=(kr(),Dr),{toString:Cp}=(bt(),mt);Uo();var Un=Z(),Oe=Xo(),qn=mn(),Tp=Kn(),On=class{constructor(t){this._key=t}async verify(t,r){return Oe.hashAndVerify(this._key,r,t)}marshal(){return Oe.utils.jwkToPkix(this._key)}get bytes(){return qn.PublicKey.encode({Type:qn.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(t){return Oe.encrypt(this._key,t)}equals(t){return ru(this.bytes,t.bytes)}async hash(){let{bytes:t}=await eu.digest(this.bytes);return t}},Kr=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return Oe.getRandomValues(16)}async sign(t){return Oe.hashAndSign(this._key,t)}get public(){if(!this._publicKey)throw tu(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new On(this._publicKey)}decrypt(t){return Oe.decrypt(this._key,t)}marshal(){return Oe.utils.jwkToPkcs1(this._key)}get bytes(){return qn.PrivateKey.encode({Type:qn.KeyType.RSA,Data:this.marshal()}).finish()}equals(t){return ru(this.bytes,t.bytes)}async hash(){let{bytes:t}=await eu.digest(this.bytes);return t}async id(){let t=await this.public.hash();return Cp(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Un.util.ByteBuffer(this.marshal()),i=Un.asn1.fromDer(n),a=Un.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Un.pki.encryptRsaPrivateKey(a,t,s)}else{if(r==="libp2p-key")return Tp.export(this.bytes,t);throw tu(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function Ip(e){let t=Oe.utils.pkcs1ToJwk(e),r=await Oe.unmarshalPrivateKey(t);return new Kr(r.privateKey,r.publicKey)}function _p(e){let t=Oe.utils.pkixToJwk(e);return new On(t)}async function Rp(e){let t=await Oe.unmarshalPrivateKey(e);return new Kr(t.privateKey,t.publicKey)}async function Dp(e){let t=await Oe.generateKey(e);return new Kr(t.privateKey,t.publicKey)}nu.exports={RsaPublicKey:On,RsaPrivateKey:Kr,unmarshalRsaPublicKey:_p,unmarshalRsaPrivateKey:Ip,generateKeyPair:Dp,fromJwk:Rp}});var pu=C(re=>{"use strict";var kp=re&&re.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(re,"__esModule",{value:!0});re.utils=re.verify=re.sign=re.getPublicKey=re.SignResult=re.Signature=re.Point=re.ExtendedPoint=re.CURVE=void 0;var Np=kp(ar()),be=BigInt(0),M=BigInt(1),Re=BigInt(2),au=BigInt(255),ce={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:Re**au-BigInt(19),n:Re**BigInt(252)+BigInt("27742317777372353535851937790883648493"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};re.CURVE=ce;var Ce=32,Ur=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Pp=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Lp=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Kp=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Up=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),X=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof ae))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(ae.ZERO)?X.ZERO:new X(t.x,t.y,M,S(t.x*t.y))}static toAffineBatch(t){let r=Fp(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}static fromRistrettoHash(t){if(typeof t=="string"&&(t=Rt(t)),t.length!==64)throw new Error("Invalid ristretto hash, need 64 bytes");let r=Qi(t.slice(0,Ce)),n=this.calcElligatorRistrettoMap(r),i=Qi(t.slice(Ce,Ce*2)),a=this.calcElligatorRistrettoMap(i);return n.add(a)}static calcElligatorRistrettoMap(t){let{d:r}=ce,n=S(Ur*t*t),i=S((n+M)*Kp),a=BigInt(-1),s=S((a-r*n)*S(n+r)),{isValid:o,value:f}=Ji(i,s),u=S(f*t);Dt(u)||(u=S(-u)),o||(f=u),o||(a=n);let c=S(a*(n-M)*Up-s),h=f*f,l=S((f+f)*s),y=S(c*Pp),p=S(M-h),g=S(M+h);return new X(S(l*g),S(p*y),S(y*g),S(l*p))}static fromRistrettoBytes(t){if(typeof t=="string"&&(t=Rt(t)),t.length!==32)throw new Error("Invalid ristretto hash, need 64 bytes");let{a:r,d:n}=ce,i="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",a=Qi(t);if(!zp(ou(a,Ce),t)||Dt(a))throw new Error(i);let s=S(a*a),o=S(M+r*s),f=S(M-r*s),u=S(o*o),c=S(f*f),h=S(r*n*u-c),{isValid:l,value:y}=uu(S(h*c)),p=S(y*f),g=S(y*p*h),v=S((a+a)*p);Dt(v)&&(v=S(-v));let m=S(o*g),E=S(v*m);if(!l||Dt(E)||m===be)throw new Error(i);return new X(v,m,M,E)}toRistrettoBytes(){let{x:t,y:r,z:n,t:i}=this,a=S(S(n+r)*S(n-r)),s=S(t*r),{value:o}=uu(S(a*s**Re)),f=S(o*a),u=S(o*s),c=S(f*u*i),h;if(Dt(i*c)){let y=S(r*Ur),p=S(t*Ur);t=y,r=p,h=S(f*Lp)}else h=u;Dt(t*c)&&(r=S(-r));let l=S((n-r)*h);return Dt(l)&&(l=S(-l)),ou(l,Ce)}equals(t){let r=this,n=t;return S(r.t*n.z)===S(n.t*r.z)}negate(){return new X(S(-this.x),this.y,this.z,S(-this.t))}double(){let t=this.x,r=this.y,n=this.z,{a:i}=ce,a=S(t**Re),s=S(r**Re),o=S(Re*n**Re),f=S(i*a),u=S((t+r)**Re-a-s),c=S(f+s),h=S(c-o),l=S(f-s),y=S(u*h),p=S(c*l),g=S(u*l),v=S(h*c);return new X(y,p,v,g)}add(t){let r=this.x,n=this.y,i=this.z,a=this.t,s=t.x,o=t.y,f=t.z,u=t.t,c=S((n-r)*(o+s)),h=S((n+r)*(o-s)),l=S(h-c);if(l===be)return this.double();let y=S(i*Re*u),p=S(a*Re*f),g=S(p+y),v=S(h+c),m=S(p-y),E=S(g*l),A=S(v*m),P=S(g*m),_=S(l*v);return new X(E,A,_,P)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=lu(t);if(r===M)return this;let n=X.ZERO,i=this;for(;r>be;)r&M&&(n=n.add(i)),i=i.double(),r>>=M;return n}precomputeWindow(t){let r=256/t+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(t-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(t,r){!r&&this.equals(X.BASE)&&(r=ae.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Yi.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=X.normalizeZ(i),Yi.set(r,i)));let a=X.ZERO,s=X.ZERO,o=256/n+1,f=2**(n-1),u=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<o;l++){let y=l*f,p=Number(t&u);if(t>>=h,p>f&&(p-=c,t+=M),p===0){let g=i[y];l%2&&(g=g.negate()),s=s.add(g)}else{let g=i[y+Math.abs(p)-1];p<0&&(g=g.negate()),a=a.add(g)}}return[a,s]}multiply(t,r){let n=lu(t);return X.normalizeZ(this.wNAF(n,r))[0]}toAffine(t=Xi(this.z)){let r=S(this.x*t),n=S(this.y*t);return new ae(r,n)}};re.ExtendedPoint=X;X.BASE=new X(ce.Gx,ce.Gy,M,S(ce.Gx*ce.Gy));X.ZERO=new X(be,M,M,be);var Yi=new WeakMap,ae=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Yi.delete(this)}static fromHex(t){let{d:r,P:n}=ce,i=t instanceof Uint8Array?t:Rt(t);if(i.length!==32)throw new Error("Point.fromHex: expected 32 bytes");let a=i[31],s=a&~128,o=(a&128)!=0,f=Uint8Array.from(Array.from(i.slice(0,31)).concat(s)),u=qr(f);if(u>=n)throw new Error("Point.fromHex expects hex <= Fp");let c=S(u*u),h=S(c-M),l=S(r*c+M),{isValid:y,value:p}=Ji(h,l);if(!y)throw new Error("Point.fromHex: invalid y coordinate");let g=(p&M)===M;return o!==g&&(p=S(-p)),new ae(p,u)}static async fromPrivateKey(t){let r=await hu(t);return ae.BASE.multiply(fu(r))}toRawBytes(){let t=Zi(this.y),r=new Uint8Array(Ce);for(let i=t.length-2,a=0;a<Ce&&i>=0;i-=2,a++)r[a]=su(t[i]+t[i+1]);let n=this.x&M?128:0;return r[Ce-1]|=n,r}toHex(){return $i(this.toRawBytes())}toX25519(){return S((M+this.y)*Xi(M-this.y))}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ae(S(-this.x),this.y)}add(t){return X.fromAffine(this).add(X.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return X.fromAffine(this).multiply(t,this).toAffine()}};re.Point=ae;ae.BASE=new ae(ce.Gx,ce.Gy);ae.ZERO=new ae(be,M);var _t=class{constructor(t,r){this.r=t,this.s=r}static fromHex(t){t=ta(t);let r=ae.fromHex(t.slice(0,32)),n=qr(t.slice(32));if(!cu(n))throw new Error("Signature.fromHex expects s <= CURVE.n");return new _t(r,n)}toRawBytes(){let t=Rt(Zi(this.s)).reverse(),r=new Uint8Array(Ce);r.set(t);let n=new Uint8Array(Ce*2);return n.set(this.r.toRawBytes()),n.set(r,32),n}toHex(){return $i(this.toRawBytes())}};re.Signature=_t;re.SignResult=_t;function qp(...e){if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let a=e[n];r.set(a,i),i+=a.length}return r}var Op=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function $i(e){let t="";for(let r=0;r<e.length;r++)t+=Op[e[r]];return t}function su(e){let t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function Rt(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2;t[r]=su(e.slice(n,n+2))}return t}function Zi(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function ou(e,t=Ce){let r=Zi(e).padStart(t*2,"0");return Rt(r).reverse()}function Dt(e){return(S(e)&M)===M}function qr(e){let t=be;for(let r=0;r<e.length;r++)t+=BigInt(e[r])<<BigInt(8)*BigInt(r);return t}function Qi(e){return S(qr(e)&Re**au-M)}function S(e,t=ce.P){let r=e%t;return r>=be?r:t+r}function Xi(e,t=ce.P){if(e===be||t<=be)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=S(e,t),n=t,i=be,a=M,s=M,o=be;for(;r!==be;){let u=n/r,c=n%r,h=i-s*u,l=a-o*u;n=r,r=c,i=s,a=o,s=h,o=l}if(n!==M)throw new Error("invert: does not exist");return S(i,t)}function Fp(e,t=ce.P){let r=e.length,n=new Array(r),i=M;for(let a=0;a<r;a++)e[a]!==be&&(n[a]=i,i=S(i*e[a],t));i=Xi(i,t);for(let a=r-1;a>=0;a--){if(e[a]===be)continue;let s=S(i*e[a],t);e[a]=S(i*n[a],t),i=s}return e}function at(e,t){let{P:r}=ce,n=e;for(;t-- >be;)n*=n,n%=r;return n}function Mp(e){let{P:t}=ce,[r,n,i,a,s]=[5,10,20,40,80].map(A=>BigInt(A)),f=e*e%t*e%t,u=at(f,Re)*f%t,c=at(u,M)*e%t,h=at(c,r)*c%t,l=at(h,n)*h%t,y=at(l,i)*l%t,p=at(y,a)*y%t,g=at(p,s)*p%t,v=at(g,s)*p%t,m=at(v,n)*h%t;return at(m,Re)*e%t}function Ji(e,t){let r=S(t*t*t),n=S(r*r*t),i=S(e*r*Mp(e*n)),a=S(t*i*i),s=i,o=S(i*Ur),f=a===e,u=a===S(-e),c=a===S(-e*Ur);return f&&(i=s),(u||c)&&(i=o),Dt(i)&&(i=S(-i)),{isValid:f||u,value:i}}function uu(e){return Ji(M,e)}async function ea(...e){let t=qp(...e),r=await re.utils.sha512(t),n=qr(r);return S(n,ce.n)}function Vp(e){return e.slice(Ce)}function fu(e){let t=Ce-1,r=e.slice(0,Ce);return r[0]&=248,r[t]&=127,r[t]|=64,S(qr(r),ce.n)}function zp(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ta(e){return e instanceof Uint8Array?e:Rt(e)}function cu(e){return 0<e&&e<ce.n}var Hp=Re**BigInt(256)-M;function Gp(e){let t,r="Expected 32 bytes of private key";if(typeof e=="bigint"||typeof e=="number"&&Number.isSafeInteger(e)){let n=BigInt(e);if(n<0||n>Hp)throw new Error(r);t=Rt(n.toString(16).padStart(Ce*2,"0"))}else if(typeof e=="string"){if(e.length!==64)throw new Error(r);t=Rt(e)}else if(e instanceof Uint8Array){if(e.length!==32)throw new Error(r);t=e}else throw new TypeError("Expected valid private key");return t}async function hu(e){return await re.utils.sha512(Gp(e))}function lu(e){if(typeof e=="number"&&e>0&&Number.isSafeInteger(e))return BigInt(e);if(typeof e=="bigint"&&cu(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}async function Wp(e){return(await ae.fromPrivateKey(e)).toRawBytes()}re.getPublicKey=Wp;async function jp(e,t){let r=await hu(t),n=fu(r),i=ae.BASE.multiply(n),a=ta(e),s=await ea(Vp(r),a),o=ae.BASE.multiply(s),f=await ea(o.toRawBytes(),i.toRawBytes(),a),u=S(s+f*n,ce.n);return new _t(o,u).toRawBytes()}re.sign=jp;async function Yp(e,t,r){t=ta(t),r instanceof ae||(r=ae.fromHex(r)),e instanceof _t||(e=_t.fromHex(e));let n=await ea(e.r.toRawBytes(),r.toRawBytes(),t),i=X.fromAffine(r).multiplyUnsafe(n),a=X.BASE.multiply(e.s);return X.fromAffine(e.r).add(i).subtract(a).multiplyUnsafe(ce.h).equals(X.ZERO)}re.verify=Yp;ae.BASE._setWindowSize(8);var kt={node:Np.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};re.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:$i,randomBytes:(e=32)=>{if(kt.web)return kt.web.getRandomValues(new Uint8Array(e));if(kt.node){let{randomBytes:t}=kt.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>re.utils.randomBytes(32),sha512:async e=>{if(kt.web){let t=await kt.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}else{if(kt.node)return Uint8Array.from(kt.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=ae.BASE){let r=t.equals(ae.BASE)?t:new ae(t.x,t.y);return r._setWindowSize(e),r.multiply(M),r}}});var yu=C(Nt=>{"use strict";var Or=pu(),$p=32,Zp=64,Fn=32;Nt.publicKeyLength=$p;Nt.privateKeyLength=Zp;Nt.generateKey=async function(){let e=Or.utils.randomPrivateKey(),t=await Or.getPublicKey(e);return{privateKey:du(e,t),publicKey:t}};Nt.generateKeyFromSeed=async function(e){if(e.length!==Fn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await Or.getPublicKey(t);return{privateKey:du(t,r),publicKey:r}};Nt.hashAndSign=function(e,t){let r=e.slice(0,Fn);return Or.sign(t,r)};Nt.hashAndVerify=function(e,t,r){return Or.verify(t,r,e)};function du(e,t){let r=new Uint8Array(Nt.privateKeyLength);for(let n=0;n<Fn;n++)r[n]=e[n],r[Fn+n]=t[n];return r}});var bu=C((Y1,mu)=>{"use strict";var gu=Pe(),{equals:xu}=(kr(),Dr),{sha256:vu}=(rr(),Ut),{base58btc:Qp}=(rn(),tn),{identity:Xp}=(xi(),fn),we=yu(),Mn=mn(),Jp=Kn(),Vn=class{constructor(t){this._key=fr(t,we.publicKeyLength)}async verify(t,r){return we.hashAndVerify(this._key,r,t)}marshal(){return this._key}get bytes(){return Mn.PublicKey.encode({Type:Mn.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(t){return xu(this.bytes,t.bytes)}async hash(){let{bytes:t}=await vu.digest(this.bytes);return t}},ur=class{constructor(t,r){this._key=fr(t,we.privateKeyLength),this._publicKey=fr(r,we.publicKeyLength)}async sign(t){return we.hashAndSign(this._key,t)}get public(){return new Vn(this._publicKey)}marshal(){return this._key}get bytes(){return Mn.PrivateKey.encode({Type:Mn.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(t){return xu(this.bytes,t.bytes)}async hash(){let{bytes:t}=await vu.digest(this.bytes);return t}async id(){let t=await Xp.digest(this.public.bytes);return Qp.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return Jp.export(this.bytes,t);throw gu(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function ed(e){if(e.length>we.privateKeyLength){e=fr(e,we.privateKeyLength+we.publicKeyLength);let n=e.slice(0,we.privateKeyLength),i=e.slice(we.privateKeyLength,e.length);return new ur(n,i)}e=fr(e,we.privateKeyLength);let t=e.slice(0,we.privateKeyLength),r=e.slice(we.publicKeyLength);return new ur(t,r)}function td(e){return e=fr(e,we.publicKeyLength),new Vn(e)}async function rd(){let{privateKey:e,publicKey:t}=await we.generateKey();return new ur(e,t)}async function nd(e){let{privateKey:t,publicKey:r}=await we.generateKeyFromSeed(e);return new ur(t,r)}function fr(e,t){if(e=Uint8Array.from(e||[]),e.length!==t)throw gu(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}mu.exports={Ed25519PublicKey:Vn,Ed25519PrivateKey:ur,unmarshalEd25519PrivateKey:ed,unmarshalEd25519PublicKey:td,generateKeyPair:rd,generateKeyPairFromSeed:nd}});var Ku=C(V=>{"use strict";var id=V&&V.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(V,"__esModule",{value:!0});V.utils=V.schnorr=V.verify=V.signSync=V.sign=V.getSharedSecret=V.recoverPublicKey=V.getPublicKey=V.Signature=V.Point=V.CURVE=void 0;var ad=id(ar()),j=BigInt(0),oe=BigInt(1),he=BigInt(2),Fr=BigInt(3),sd=BigInt(8),ra=he**BigInt(256),J={a:j,b:BigInt(7),P:ra-he**BigInt(32)-BigInt(977),n:ra-BigInt("432420386565659656852420866394968145599"),h:oe,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};V.CURVE=J;function wu(e){let{a:t,b:r}=J,n=D(e*e),i=D(n*e);return D(i+t*e+r)}var zn=J.a===j,G=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof $))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new G(t.x,t.y,oe)}static toAffineBatch(t){let r=cd(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return G.toAffineBatch(t).map(G.fromAffine)}equals(t){let r=this,n=t,i=D(r.z*r.z),a=D(r.z*i),s=D(n.z*n.z),o=D(n.z*s);return D(r.x*s)===D(i*n.x)&&D(r.y*o)===D(a*n.y)}negate(){return new G(this.x,D(-this.y),this.z)}double(){let t=this.x,r=this.y,n=this.z,i=D(t**he),a=D(r**he),s=D(a**he),o=D(he*(D(D((t+a)**he))-i-s)),f=D(Fr*i),u=D(f**he),c=D(u-he*o),h=D(f*(o-c)-sd*s),l=D(he*r*n);return new G(c,h,l)}add(t){if(!(t instanceof G))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,n=this.y,i=this.z,a=t.x,s=t.y,o=t.z;if(a===j||s===j)return this;if(r===j||n===j)return t;let f=D(i**he),u=D(o**he),c=D(r*u),h=D(a*f),l=D(n*o*u),y=D(D(s*i)*f),p=D(h-c),g=D(y-l);if(p===j)return g===j?this.double():G.ZERO;let v=D(p**he),m=D(p*v),E=D(c*v),A=D(g**he-m-he*E),P=D(g*(E-A)-l*m),_=D(i*o*p);return new G(A,P,_)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=Bu(t);if(!zn){let c=G.ZERO,h=this;for(;r>j;)r&oe&&(c=c.add(h)),h=h.double(),r>>=oe;return c}let{k1neg:n,k1:i,k2neg:a,k2:s}=Cu(r),o=G.ZERO,f=G.ZERO,u=this;for(;i>j||s>j;)i&oe&&(o=o.add(u)),s&oe&&(f=f.add(u)),u=u.double(),i>>=oe,s>>=oe;return n&&(o=o.negate()),a&&(f=f.negate()),f=new G(D(f.x*J.beta),f.y,f.z),o.add(f)}precomputeWindow(t){let r=zn?128/t+1:256/t+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(t-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(t,r){!r&&this.equals(G.BASE)&&(r=$.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&na.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=G.normalizeZ(i),na.set(r,i)));let a=G.ZERO,s=G.ZERO,o=zn?128/n+1:256/n+1,f=2**(n-1),u=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<o;l++){let y=l*f,p=Number(t&u);if(t>>=h,p>f&&(p-=c,t+=oe),p===0){let g=i[y];l%2&&(g=g.negate()),s=s.add(g)}else{let g=i[y+Math.abs(p)-1];p<0&&(g=g.negate()),a=a.add(g)}}return{p:a,f:s}}multiply(t,r){let n=Bu(t),i,a;if(zn){let{k1neg:s,k1:o,k2neg:f,k2:u}=Cu(n),{p:c,f:h}=this.wNAF(o,r),{p:l,f:y}=this.wNAF(u,r);s&&(c=c.negate()),f&&(l=l.negate()),l=new G(D(l.x*J.beta),l.y,l.z),i=c.add(l),a=h.add(y)}else{let{p:s,f:o}=this.wNAF(n,r);i=s,a=o}return G.normalizeZ([i,a])[0]}toAffine(t=Vr(this.z)){let r=t**he,n=D(this.x*r),i=D(this.y*r*t);return new $(n,i)}};G.BASE=new G(J.Gx,J.Gy,oe);G.ZERO=new G(j,oe,j);var na=new WeakMap,$=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,na.delete(this)}static fromCompressedHex(t){let r=t.length===32,n=ke(r?t:t.slice(1)),i=wu(n),a=fd(i),s=(a&oe)===oe;r?s&&(a=D(-a)):(t[0]&1)==1!==s&&(a=D(-a));let o=new $(n,a);return o.assertValidity(),o}static fromUncompressedHex(t){let r=ke(t.slice(1,33)),n=ke(t.slice(33)),i=new $(r,n);return i.assertValidity(),i}static fromHex(t){let r=jt(t),n=r[0];if(r.length===32||r.length===33&&(n===2||n===3))return this.fromCompressedHex(r);if(r.length===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(t){return $.BASE.multiply(zr(t))}static fromSignature(t,r,n){let i=t instanceof Uint8Array?ke(t):cr(t),a=Iu(r),{r:s,s:o}=a;if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let f=2+(n&1),u=$.fromHex(`0${f}${dt(s)}`),c=G.fromAffine(u).multiplyUnsafe(o),h=G.BASE.multiply(i),l=Vr(s,J.n),p=c.subtract(h).multiplyUnsafe(l).toAffine();return p.assertValidity(),p}toRawBytes(t=!1){return Pt(this.toHex(t))}toHex(t=!1){let r=dt(this.x);return t?`${this.y&oe?"03":"02"}${r}`:`04${r}${dt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!oa(r)||!oa(n))throw new Error(t);let i=D(n*n),a=wu(r);if(D(i-a)!==j)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new $(this.x,D(-this.y))}double(){return G.fromAffine(this).double().toAffine()}add(t){return G.fromAffine(this).add(G.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return G.fromAffine(this).multiply(t,this).toAffine()}};V.Point=$;$.BASE=new $(J.Gx,J.Gy);$.ZERO=new $(j,j);function Su(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Eu(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${Wt(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ke(r),left:e.subarray(t+2)}}function od(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${Wt(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=Eu(e.subarray(2)),{data:n,left:i}=Eu(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Wt(i)}`);return{r:t,s:n}}var st=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Wt(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new st(cr(i.slice(0,64)),cr(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=od(r?t:Pt(t));return new st(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Yt(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Yt(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=J.n>>oe;return this.s>t}normalizeS(){return this.hasHighS()?new st(this.r,J.n-this.s):this}toDERRawBytes(t=!1){return Pt(this.toDERHex(t))}toDERHex(t=!1){let r=Su(Mr(this.s));if(t)return r;let n=Su(Mr(this.r)),i=Mr(n.length/2),a=Mr(r.length/2);return`30${Mr(n.length/2+r.length/2+4)}02${i}${n}02${a}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Pt(this.toCompactHex())}toCompactHex(){return dt(this.r)+dt(this.s)}};V.Signature=st;function ia(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let a=e[n];r.set(a,i),i+=a.length}return r}var ud=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Wt(e){let t="";for(let r=0;r<e.length;r++)t+=ud[e[r]];return t}function dt(e){if(e>ra)throw new Error("pad64: invalid number");return e.toString(16).padStart(64,"0")}function aa(e){return Pt(dt(e))}function Mr(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function cr(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function Pt(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a))throw new Error("Invalid byte sequence");t[r]=a}return t}function jt(e){return e instanceof Uint8Array?e:Pt(e)}function ke(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return cr(Wt(e))}function Bu(e){if(typeof e=="number"&&e>0&&Number.isSafeInteger(e))return BigInt(e);if(typeof e=="bigint"&&Yt(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function D(e,t=J.P){let r=e%t;return r>=0?r:t+r}function Fe(e,t){let{P:r}=J,n=e;for(;t-- >j;)n*=n,n%=r;return n}function fd(e){let{P:t}=J,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),f=e*e*e%t,u=f*f*e%t,c=Fe(u,Fr)*u%t,h=Fe(c,Fr)*u%t,l=Fe(h,he)*f%t,y=Fe(l,n)*l%t,p=Fe(y,i)*y%t,g=Fe(p,s)*p%t,v=Fe(g,o)*g%t,m=Fe(v,s)*p%t,E=Fe(m,Fr)*u%t,A=Fe(E,a)*y%t,P=Fe(A,r)*f%t;return Fe(P,he)}function Vr(e,t=J.P){if(e===j||t<=j)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=D(e,t),n=t,i=j,a=oe,s=oe,o=j;for(;r!==j;){let u=n/r,c=n%r,h=i-s*u,l=a-o*u;n=r,r=c,i=s,a=o,s=h,o=l}if(n!==oe)throw new Error("invert: does not exist");return D(i,t)}function cd(e,t=J.P){let r=e.length,n=new Array(r),i=oe;for(let a=0;a<r;a++)e[a]!==j&&(n[a]=i,i=D(i*e[a],t));i=Vr(i,t);for(let a=r-1;a>=0;a--){if(e[a]===j)continue;let s=D(i*e[a],t);e[a]=D(i*n[a],t),i=s}return e}var Au=(e,t)=>(e+t/he)/t,Hn=he**BigInt(128);function Cu(e){let{n:t}=J,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-oe*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=Au(a*e,t),o=Au(-n*e,t),f=D(e-s*r-o*i,t),u=D(-s*n-o*a,t),c=f>Hn,h=u>Hn;if(c&&(f=t-f),h&&(u=t-u),f>Hn||u>Hn)throw new Error("splitScalarEndo: Endomorphism failed");return{k1neg:c,k1:f,k2neg:h,k2:u}}function hd(e){typeof e!="string"&&(e=Wt(e));let t=cr(e||"0"),n=e.length/2*8-256;return n>0&&(t=t>>BigInt(n)),t>=J.n&&(t-=J.n),t}var sa=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...t){return V.utils.hmacSha256(this.k,...t)}hmacSync(...t){if(typeof V.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=V.utils.hmacSha256Sync(this.k,...t);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function Yt(e){return j<e&&e<J.n}function oa(e){return 0n<e&&e<J.P}function Tu(e,t,r){let n=ke(e);if(!Yt(n))return;let{n:i}=J,a=$.BASE.multiply(n),s=D(a.x,i);if(s===j)return;let o=D(Vr(n,i)*D(t+r*s,i),i);if(o===j)return;let f=new st(s,o),u=(a.x===f.r?0:2)|Number(a.y&oe);return{sig:f,recovery:u}}function zr(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==64)throw new Error("Expected 32 bytes of private key");t=cr(e)}else if(e instanceof Uint8Array){if(e.length!==32)throw new Error("Expected 32 bytes of private key");t=ke(e)}else throw new TypeError("Expected valid private key");if(!Yt(t))throw new Error("Expected private key: 0 < key < n");return t}function ua(e){return e instanceof $?(e.assertValidity(),e):$.fromHex(e)}function Iu(e){if(e instanceof st)return e.assertValidity(),e;try{return st.fromDER(e)}catch(t){return st.fromCompact(e)}}function ld(e,t=!1){return $.fromPrivateKey(e).toRawBytes(t)}V.getPublicKey=ld;function pd(e,t,r){return $.fromSignature(e,t,r).toRawBytes()}V.recoverPublicKey=pd;function _u(e){let t=e instanceof Uint8Array,r=typeof e=="string",n=(t||r)&&e.length;return t?n===33||n===65:r?n===66||n===130:e instanceof $}function dd(e,t,r=!1){if(_u(e))throw new TypeError("getSharedSecret: first arg must be private key");if(!_u(t))throw new TypeError("getSharedSecret: second arg must be public key");let n=ua(t);return n.assertValidity(),n.multiply(zr(e)).toRawBytes(r)}V.getSharedSecret=dd;function Ru(e){let t=e.length>32?e.slice(0,32):e;return ke(t)}function yd(e){let t=Ru(e),r=D(t,J.n);return Du(r<j?t:r)}function Du(e){if(typeof e!="bigint")throw new Error("Expected bigint");let t=dt(e);return Pt(t)}function ku(e,t,r){if(e==null)throw new Error(`sign: expected valid msgHash, not "${e}"`);let n=jt(e),i=zr(t),a=[Du(i),yd(n)];if(r!=null){r===!0&&(r=V.utils.randomBytes(32));let f=aa(ke(jt(r)));if(f.length!==32)throw new Error("secp256k1: Expected 32 bytes of extra data");a.push(f)}let s=ia(...a),o=Ru(n);return{seed:s,m:o,d:i}}function Nu(e,t){let{sig:r,recovery:n}=e,{canonical:i,der:a,recovered:s}=Object.assign({canonical:!0,der:!0},t);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let o=a?r.toDERRawBytes():r.toCompactRawBytes();return s?[o,n]:o}async function gd(e,t,r={}){let{seed:n,m:i,d:a}=ku(e,t,r.extraEntropy),s,o=new sa;for(await o.reseed(n);!(s=Tu(await o.generate(),i,a));)await o.reseed();return Nu(s,r)}V.sign=gd;function xd(e,t,r={}){let{seed:n,m:i,d:a}=ku(e,t,r.extraEntropy),s,o=new sa;for(o.reseedSync(n);!(s=Tu(o.generateSync(),i,a));)o.reseedSync();return Nu(s,r)}V.signSync=xd;var vd={strict:!0};function md(e,t,r,n=vd){let i;try{i=Iu(e)}catch(m){return!1}let{r:a,s}=i;if(n.strict&&i.hasHighS())return!1;let o=hd(t);if(o===j)return!1;let f;try{f=G.fromAffine(ua(r))}catch(m){return!1}let{n:u}=J,c=Vr(s,u),h=D(o*c,u),l=D(a*c,u),y=G.BASE.multiply(h),p=f.multiplyUnsafe(l),g=y.add(p).toAffine();return D(g.x,u)===a}V.verify=md;async function fa(e,...t){let r=new Uint8Array(e.split("").map(a=>a.charCodeAt(0))),n=await V.utils.sha256(r),i=await V.utils.sha256(ia(n,n,...t));return ke(i)}async function Pu(e,t,r){let n=aa(e),i=await fa("BIP0340/challenge",n,t.toRawX(),r);return D(i,J.n)}function ca(e){return D(e.y,he)===j}var $t=class{constructor(t,r){if(this.r=t,this.s=r,!oa(t)||!Yt(r))throw new Error("Invalid signature")}static fromHex(t){let r=jt(t);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=ke(r.slice(0,32)),i=ke(r.slice(32,64));return new $t(n,i)}toHex(){return dt(this.r)+dt(this.s)}toRawBytes(){return Pt(this.toHex())}};function bd(e){return $.fromPrivateKey(e).toRawX()}async function wd(e,t,r=V.utils.randomBytes()){if(e==null)throw new TypeError(`sign: Expected valid message, not "${e}"`);let{n}=J,i=jt(e),a=zr(t),s=jt(r);if(s.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let o=$.fromPrivateKey(a),f=ca(o)?a:n-a,u=await fa("BIP0340/aux",s),c=f^u,h=await fa("BIP0340/nonce",aa(c),o.toRawX(),i),l=D(h,n);if(l===j)throw new Error("sign: Creation of signature failed. k is zero");let y=$.fromPrivateKey(l),p=ca(y)?l:n-l,g=await Pu(y.x,o,i),v=new $t(y.x,D(p+g*f,n));if(!await Lu(v.toRawBytes(),i,o.toRawX()))throw new Error("sign: Invalid signature produced");return v.toRawBytes()}async function Lu(e,t,r){let n=e instanceof $t?e:$t.fromHex(e),i=jt(t),a=ua(r),s=await Pu(n.r,a,i),o=$.fromPrivateKey(n.s),f=a.multiply(s),u=o.subtract(f);return!(u.equals($.BASE)||!ca(u)||u.x!==n.r)}V.schnorr={Signature:$t,getPublicKey:bd,sign:wd,verify:Lu};$.BASE._setWindowSize(8);var Ne={node:ad.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};V.utils={isValidPrivateKey(e){try{return zr(e),!0}catch(t){return!1}},randomBytes:(e=32)=>{if(Ne.web)return Ne.web.getRandomValues(new Uint8Array(e));if(Ne.node){let{randomBytes:t}=Ne.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let e=8;for(;e--;){let t=V.utils.randomBytes(32),r=ke(t);if(Yt(r)&&r!==oe)return t}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},bytesToHex:Wt,sha256:async e=>{if(Ne.web){let t=await Ne.web.subtle.digest("SHA-256",e.buffer);return new Uint8Array(t)}else if(Ne.node){let{createHash:t}=Ne.node;return Uint8Array.from(t("sha256").update(e).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(Ne.web){let r=await Ne.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=ia(...t),i=await Ne.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Ne.node){let{createHmac:r}=Ne.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(e=8,t=$.BASE){let r=t===$.BASE?t:new $(t.x,t.y);return r._setWindowSize(e),r.multiply(Fr),r}}});var Ou=C((Z1,qu)=>{"use strict";var Hr=Pe(),Lt=Ku(),{sha256:Uu}=(rr(),Ut);qu.exports=()=>{let e=32;function t(){return Lt.utils.randomPrivateKey()}async function r(u,c){let{digest:h}=await Uu.digest(c);try{return await Lt.sign(h,u)}catch(l){throw Hr(l,"ERR_INVALID_INPUT")}}async function n(u,c,h){try{let{digest:l}=await Uu.digest(h);return Lt.verify(c,l,u)}catch(l){throw Hr(l,"ERR_INVALID_INPUT")}}function i(u){return Lt.Point.fromHex(u).toRawBytes(!0)}function a(u){return Lt.Point.fromHex(u).toRawBytes(!1)}function s(u){try{Lt.getPublicKey(u,!0)}catch(c){throw Hr(c,"ERR_INVALID_PRIVATE_KEY")}}function o(u){try{Lt.Point.fromHex(u)}catch(c){throw Hr(c,"ERR_INVALID_PUBLIC_KEY")}}function f(u){try{return Lt.getPublicKey(u,!0)}catch(c){throw Hr(c,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:t,privateKeyLength:e,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:a,validatePrivateKey:s,validatePublicKey:o,computePublicKey:f}}});var zu=C((Q1,Vu)=>{"use strict";var{sha256:Fu}=(rr(),Ut),Sd=Pe(),{equals:Mu}=(kr(),Dr),{toString:Ed}=(bt(),mt),Bd=Kn();Vu.exports=(e,t,r)=>{r=r||Ou()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,c){return r.hashAndVerify(this._key,c,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return e.PublicKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Mu(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Fu.digest(this.bytes);return u}}class i{constructor(u,c){this._key=u,this._publicKey=c||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return e.PrivateKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Mu(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Fu.digest(this.bytes);return u}async id(){let u=await this.public.hash();return Ed(u,"base58btc")}async export(u,c="libp2p-key"){if(c==="libp2p-key")return Bd.export(this.bytes,u);throw Sd(new Error(`export format '${c}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function a(f){return new i(f)}function s(f){return new n(f)}async function o(){let f=await r.generateKey();return new i(f)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:a,unmarshalSecp256k1PublicKey:s,generateKeyPair:o}}});var Yu=C((X1,ju)=>{"use strict";var Hu=Pe(),{concat:Gu}=(Rr(),_r),{fromString:Ad}=(St(),wt),Cd=Zn(),Wu={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};ju.exports=async(e,t,r)=>{let n=Wu[e];if(!n){let E=Object.keys(Wu).join(" / ");throw Hu(new Error(`unknown cipher type '${e}'. Must be ${E}`),"ERR_INVALID_CIPHER_TYPE")}if(!t)throw Hu(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=Ad("key expansion"),f=2*(a+i+s),u=await Cd.create(t,r),c=await u.digest(o),h=[],l=0;for(;l<f;){let E=await u.digest(Gu([c,o])),A=E.length;l+A>f&&(A=f-l),h.push(E),l+=A,c=await u.digest(c)}let y=f/2,p=Gu(h),g=p.slice(0,y),v=p.slice(y,f),m=E=>({iv:E.slice(0,a),cipherKey:E.slice(a,a+i),macKey:E.slice(a+i)});return{k1:m(g),k2:m(v)}}});var Zu=C((J1,$u)=>{"use strict";var Td=Pe();$u.exports=function(e,t){if(!e.includes(t)){let r=e.join(" / ");throw Td(new Error(`Unknown curve: ${t}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var rf=C(tf=>{"use strict";var Id=Pe(),Gr=pr(),{base64urlToBuffer:Qu}=Ln(),_d=Zu(),{toString:ha}=(bt(),mt),{concat:Rd}=(Rr(),_r),{equals:Dd}=(kr(),Dr),Xu={"P-256":256,"P-384":384,"P-521":521};tf.generateEphmeralKeyPair=async function(e){_d(Object.keys(Xu),e);let t=await Gr.get().subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]),r=async(i,a)=>{let s;a?s=await Gr.get().subtle.importKey("jwk",Nd(e,a),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):s=t.privateKey;let o=[await Gr.get().subtle.importKey("jwk",ef(e,i),{name:"ECDH",namedCurve:e},!1,[]),s],f=await Gr.get().subtle.deriveBits({name:"ECDH",namedCurve:e,public:o[0]},o[1],Xu[e]);return new Uint8Array(f,f.byteOffset,f.byteLength)},n=await Gr.get().subtle.exportKey("jwk",t.publicKey);return{key:kd(n),genSharedKey:r}};var Ju={"P-256":32,"P-384":48,"P-521":66};function kd(e){let t=Ju[e.crv];return Rd([Uint8Array.from([4]),Qu(e.x,t),Qu(e.y,t)],1+t*2)}function ef(e,t){let r=Ju[e];if(Dd(!t.slice(0,1),Uint8Array.from([4])))throw Id(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:e,x:ha(t.slice(1,r+1),"base64url"),y:ha(t.slice(1+r),"base64url"),ext:!0}}var Nd=(e,t)=>({...ef(e,t.public),d:ha(t.private,"base64url")})});var af=C((t2,nf)=>{"use strict";var Pd=rf();nf.exports=async e=>Pd.generateEphmeralKeyPair(e)});var uf=C((r2,of)=>{"use strict";var ot=mn();Cr();Io();var la=Z(),Wr=Pe(),{fromString:Ld}=(St(),wt),Kd=ko(),Me={rsa:iu(),ed25519:bu(),secp256k1:zu()(ot,Pn())},Gn={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function hr(e){let t=Me[e.toLowerCase()];if(!t){let r=Object.keys(Me).join(" / ");throw Wr(new Error(`invalid or unsupported key type ${e}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return t}var Ud=async(e,t)=>hr(e).generateKeyPair(t),qd=async(e,t,r)=>{let n=hr(e);if(e.toLowerCase()!=="ed25519")throw Wr(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(t,r)},Od=e=>{let t=ot.PublicKey.decode(e),r=t.Data;switch(t.Type){case ot.KeyType.RSA:return Me.rsa.unmarshalRsaPublicKey(r);case ot.KeyType.Ed25519:return Me.ed25519.unmarshalEd25519PublicKey(r);case ot.KeyType.Secp256k1:if(Me.secp256k1)return Me.secp256k1.unmarshalSecp256k1PublicKey(r);throw Wr(new Error(Gn.message),Gn.code);default:hr(t.Type)}},Fd=(e,t)=>(t=(t||"rsa").toLowerCase(),hr(t),e.bytes),sf=async e=>{let t=ot.PrivateKey.decode(e),r=t.Data;switch(t.Type){case ot.KeyType.RSA:return Me.rsa.unmarshalRsaPrivateKey(r);case ot.KeyType.Ed25519:return Me.ed25519.unmarshalEd25519PrivateKey(r);case ot.KeyType.Secp256k1:if(Me.secp256k1)return Me.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Wr(new Error(Gn.message),Gn.code);default:hr(t.Type)}},Md=(e,t)=>(t=(t||"rsa").toLowerCase(),hr(t),e.bytes),Vd=async(e,t)=>{try{let i=await Kd.import(e,t);return sf(i)}catch(i){}let r=la.pki.decryptRsaPrivateKey(e,t);if(r===null)throw Wr(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=la.asn1.toDer(la.pki.privateKeyToAsn1(r));return n=Ld(n.getBytes(),"ascii"),Me.rsa.unmarshalRsaPrivateKey(n)};of.exports={supportedKeys:Me,keysPBM:ot,keyStretcher:Yu(),generateEphemeralKeyPair:af(),generateKeyPair:Ud,generateKeyPairFromSeed:qd,unmarshalPublicKey:Od,marshalPublicKey:Fd,unmarshalPrivateKey:sf,marshalPrivateKey:Md,import:Vd}});var hf=C((n2,cf)=>{"use strict";var zd=Li(),Hd=ue(),Gd=Pe(),ff={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Wd(e,t,r,n,i){let a=ff[i];if(!a){let o=Object.keys(ff).join(" / ");throw Gd(new Error(`Hash '${i}' is unknown or not supported. Must be ${o}`),"ERR_UNSUPPORTED_HASH_TYPE")}let s=zd(e,t,r,n,a);return Hd.encode64(s)}cf.exports=Wd});var Zd=C(lr=>{"use strict";var jd=Zn(),Yd=Ts(),$d=uf();lr.aes=Yd;lr.hmac=jd;lr.keys=$d;lr.randomBytes=Pn();lr.pbkdf2=hf()});return Zd();})();
/*! noble-ed25519 - MIT License (c) Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return Libp2pCrypto}));
